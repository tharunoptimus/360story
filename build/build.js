(function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var i=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(i,'a',i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=156)})([function(e,t,i){if('undefined'==typeof AFRAME)throw new Error('aframe-event-decorators was loaded before AFRAME was available');const a=i(59),n=i(11).decorate;e.exports.bindEvent=a.bindEvent,e.exports.bindEventPlayPause=a.bindEventPlayPause,e.exports.decorate=n},function(e){var t={MAIN:{BUILD_OPTIONS:'buildoptions',LOAD:'load',TUTORIAL:'tutorial'},BUILD:{PUBLISH:'publish',ENVIRONMENT:'environment',THING:'thing'},CRAFT:{SHAPE:'shape',MATERIAL:'material'},SCRIPT:{SCRIPT:'script',STATE:'state'}};e.exports.MENUS=t;var i={MAIN:'main',BUILD:'build',CRAFT:'craft',SCRIPT:'script'};e.exports.MENU_SECTIONS=i;var a={};for(var n in t)for(var o in t[n])a[t[n][o]]=i[n];e.exports.MENU_TO_SECTION=a;var r={[i.BUILD]:[t.BUILD.PUBLISH,t.BUILD.ENVIRONMENT,t.BUILD.THING],[i.CRAFT]:[t.CRAFT.SHAPE,t.CRAFT.MATERIAL]};e.exports.MENU_ORDER=r},function(e){var t=`https://${window.location.host}/api/v1/craft`;e.exports={API_ROOT:t,SITE:`${t}/site`}},function(e){window.SUPERCRAFT={utils:{}},window.SUPERCRAFT.utils.drawLine=function(){var e={};return function(t,i,a,n){e[t]||(e[t]=document.createElement('a-entity'),e[t].setAttribute('line','color',n||'#FFF'),e[t].setAttribute('id',t),AFRAME.scenes[0].appendChild(e[t])),e[t].setAttribute('line','start',i.clone()),e[t].setAttribute('line','end',a.clone())}}(),window.SUPERCRAFT.utils.drawVec3=function(){var e={};return function(t,i,a){e[t]||(e[t]=document.createElement('a-sphere'),e[t].setAttribute('color',a||'#FFF'),e[t].setAttribute('radius',0.02),e[t].setAttribute('id',t),e[t].setAttribute('text',{align:'center',value:t,side:'double'}),AFRAME.scenes[0].appendChild(e[t])),e[t].setAttribute('position',i.clone())}}(),window.SUPERCRAFT.utils.getFaceCenter=function(){return function(e,t,i){return i=i||new THREE.Vector3,i.copy(e.geometry.vertices[t.a]).add(e.geometry.vertices[t.b]).add(e.geometry.vertices[t.c]).divideScalar(3)}}(),window.SUPERCRAFT.utils.isEditable=function(){var e='shape',t='data-staged',i='true';return function(a){var n;return!!a&&(a.classList.contains(e)||a.classList.contains('thing'))&&(n=AFRAME.scenes[0],n.getAttribute('data-build-mode')===i||n.getAttribute('data-craft-mode')===i&&(a.classList.contains(e)?a.parentNode.hasAttribute(t):a.hasAttribute(t)))}}(),window.SUPERCRAFT.utils.isSelectable=function(){return function(e){var t;return!!e&&(e.classList.contains('shape')||e.classList.contains('thing'))&&(t=AFRAME.scenes[0],t.getAttribute('data-play-mode')==='true'&&t.systems.state.state.isVRMode||window.SUPERCRAFT.utils.isEditable(e))}}(),e.exports.scaleToBox=function(){var e=new THREE.Box3;return function(t,i){var a;return t.scale.set(1,1,1),e.setFromObject(t),a=Math.max(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),t.scale.set(i/a,i/a,i/a),e}}()},function(e,t,i){'use strict';var a=i(37)();e.exports=function(e){return e!==a&&null!==e}},function(e){'use strict';var t=Array.prototype.forEach,i=Object.create;e.exports=function(){var e=i(null);return t.call(arguments,function(t){e[t]=!0}),e}},function(e,t,i){'use strict';var a=i(4);e.exports=function(e){if(!a(e))throw new TypeError('Cannot use null or undefined');return e}},function(e){function t(e){var t;return t=document.createElement('a-entity'),i(t,e),t}function i(e,t){for(var i in t)i===a||i===o?e.object3D[i].copy(t[i]):i===n?e.object3D.rotation.set(t[i].x,t[i].y,t[i].z):e.setAttribute(i,t[i])}var a='position',n='rotation',o='scale';e.exports.createEntity=t,e.exports.setAttributes=i,e.exports.createThing=function(e,i){var a,n,o;for(n in o=t(e.attributes),e.shapes)shapeData=e.shapes[n].attributes,a=t(shapeData),o.appendChild(a),i?o.setAttribute('geometry-merger',{deleteOriginalEntities:!0}):o.setAttribute('geometry-merger',''),o.setAttribute('super-material','');return o}},function(e){function t(e){return Math.max(Math.pow(2,i(Math.log(e)/0.6931471805599453)),0.25)}var i=Math.round,a=Math.PI/4,n;e.exports.snapPosition=function(e,a){n=0.03125*t(a),e.x=i(e.x/n)*n,e.y=i(e.y/n)*n,e.z=i(e.z/n)*n},e.exports.snapRotation=function(e){e.x=i(e.x/a)*a,e.y=i(e.y/a)*a,e.z=i(e.z/a)*a},e.exports.snapScale=function(e,a){n=0.25*t(a),e.set(i(e.x/n)*n,i(e.y/n)*n,i(e.z/n)*n)}},function(e){var t=AFRAME.utils.objectPool.createPool(),i='create',a='delete',n='set',o='transform',r=window.superHistory=[];e.exports.superHistory=r,e.exports.pushCreateAction=function(e){var a;a=t.use(),a.action=i,a.entityId=e,r.push(a)},e.exports.pushDeleteAction=function(e){var i;i=t.use(),i.action=a,i.entityData=e,i.entityId=e.attributes.id,r.push(i)},e.exports.pushSetAction=function(e,i,a){var o;o=t.use(),o.action=n,o.entityId=e.attributes.id,o.component=i,o.property=a,o.value=a?e.attributes[i][a]:e.attributes[i],r.push(o)},e.exports.pushTransformAction=function(e){var i;i=t.use(),i.action=o,i.entityId=e.attributes.id,i.position=Object.assign(t.use(),e.attributes.position),i.rotation=Object.assign(t.use(),e.attributes.rotation),i.scale=Object.assign(t.use(),e.attributes.scale),r.push(i)},e.exports.undo=function(e){var s,l,d;if(0!==r.length)return s=r.pop(),d=s.entityId,s.action===i&&(l=e.entityIndex[d],'parentId'in l&&delete e.entityIndex[l.parentId].shapes[d],delete e.entityIndex[d],e.dirtyEntityIds=[d],e.focusedEntityId=''),s.action===a&&(e.entityIndex[d]=l=s.entityData,'parentId'in l&&(e.entityIndex[l.parentId].shapes[d]=l),e.dirtyEntityIds=[d],e.focusedEntityId=d),s.action===n&&(s.property?e.entityIndex[d].attributes[s.component][s.property]=s.value:e.entityIndex[d].attributes[s.component]=s.value,e.dirtyEntityIds=[d]),s.action===o&&(e.dirtyEntityIds=[d],AFRAME.utils.extend(e.entityIndex[d].attributes.position,s.position),AFRAME.utils.extend(e.entityIndex[d].attributes.rotation,s.rotation),AFRAME.utils.extend(e.entityIndex[d].attributes.scale,s.scale),t.recycle(s.position),t.recycle(s.rotation),t.recycle(s.scale)),t.recycle(s),s},e.exports.clear=function(){var e,a;for(a=0;a<r.length;a++)e=r[a],e.action===o&&(t.recycle(e.position),t.recycle(e.rotation),t.recycle(e.scale)),t.recycle(e);r.length=0}},function(e,t,i){'use strict';e.exports=i(164)()?Array.from:i(165)},function(e){const t=function(){const e=new WeakMap;return{add:function(t,i){const a=e.has(t)?t:void 0,n=function(){t.apply(this,arguments)};return e.set(n,{parent:a,decorator:i}),n},getAll:function(t){for(var i=e.get(t),a=[];i!==void 0;)a.push(i.decorator),i=i.parent;return a},isFunctionDecorated:function(t){return e.has(t)}}}();(function(){function e(e){const i=Object.getPrototypeOf(e);Object.getOwnPropertyNames(i).forEach(function(a){const n=i[a];'function'==typeof n&&t.isFunctionDecorated(n)&&t.getAll(n).forEach(function(t){e[a]=t.call(e,a,n)})})}function i(t){const i=AFRAME.components[t].Component;AFRAME.components[t].Component=function(){this.init=function(){delete this.init,e(this),this.init.apply(this,arguments)},i.apply(this,arguments)},AFRAME.components[t].Component.prototype=i.prototype}Object.keys(AFRAME.components).forEach(function(e){i(e)}),function(){const e=AFRAME.registerComponent;AFRAME.registerComponent=function(t){return e.apply(AFRAME,arguments),i(t)}}()})(),e.exports.decorate=function(e,i){return t.add(e,i)}},function(e){(function(t,i){e.exports=i()})('undefined'==typeof self?this:self,function(){return function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var i=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(i,'a',i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=0)}([function(e,t,i){'use strict';function a(e,t,a,o){var r,s,l,i,d,p;if(p=c(t,/\s+/),1===p.length)return n(e,t,a,o);for(C.length=0,u(S,p),l=0;l<S.length;l++){if(-1===x.indexOf(S[l])){C.push(S[l]);continue}s=n(e,C.pop()),d=S[l+1].replace(v,''),r=-1===S[l].indexOf('!')?s===d:s!==d,C.push(r),l++}if(1===C.length)return C[0];for(i=C[0].constructor===Boolean?C[0]:n(e,C[0],a,o),l=1;l<C.length;l+=2)(C[l]===E||C[l]===f)&&(C[l+1]=C[l+1].constructor===Boolean?C[l+1]:n(e,C[l+1]),C[l]===E?i=i||C[l+1]:C[l]===f&&(i=i&&C[l+1]));return i}function n(e,t,a,o){var r,i,s,l;for(a&&t.startsWith(a.for)&&(i=t,t=a.in),l=e,s=c(d(t),'.'),r=0;r<s.length;r++)r<s.length-1&&!(s[r]in l)&&console.error('[state] Not found:',s,s[r]),l=l[s[r]];if(a&&i.startsWith(a.for)){if(!a.key)return l[o];for(r=0;r<l.length;r++)if(l[r][a.key]===o){l=n(l[r],i.replace(a.for+'.',''));break}}return'!'===t[0]&&'!'===t[1]?!!l:'!'===t[0]?!l:l}function o(e){for(var t in e)delete e[t]}function r(){var e=arguments;return function(){var t;for(t=0;t<e.length;t++)e[t].apply(this,arguments)}}function s(e,t){var a,i;for(i=t.split(/\s+/),a=0;a<i.length;a++)-1!==A.indexOf(i[a])||i[a].startsWith('\'')||-1!==e.indexOf(i[a])||e.push(l(i[a]))}function l(e){var t;return e=d(e.trim()),t=e.indexOf('.'),-1===t?e:e.substring(0,e.indexOf('.'))}function d(e){if(0===e.indexOf('!!'))return e.replace('!!','');return 0===e.indexOf('!')?e.replace('!',''):e}function c(e,t){return(T[t]||(T[t]={}),T[t][e])?T[t][e]:(T[t][e]=e.split(t),T[t][e])}function u(e,t){var a;for(e.length=0,a=0;a<t.length;a++)e[a]=t[a]}var p='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},g=i(1),m=i(2).wrapArray,h={initialState:{},nonBindedStateKeys:[],handlers:{},computeState:function(){}},b='object',y=/s+/;AFRAME.registerState=function(e){AFRAME.utils.extend(h,e)},AFRAME.registerSystem('state',{init:function(){var e=this,t;for(t in this.diff={},this.state=AFRAME.utils.clone(h.initialState),this.subscriptions=[],this.initEventHandlers(),this.state)this.state[t]&&this.state[t].constructor===Array&&(this.state[t].__dirty=!0,m(this.state[t]));this.lastState=AFRAME.utils.clone(this.state),this.eventDetail={lastState:this.lastState,state:this.state},this.el.addEventListener('loaded',function(){var t;for(h.computeState(e.state,'@@INIT'),t=0;t<e.subscriptions.length;t++)e.subscriptions[t].onStateUpdate(e.state)})},dispatch:function(e,t){var a,i;for(i in h.handlers[e](this.state,t),h.computeState(this.state,e,t),this.diff)delete this.diff[i];for(g(this.lastState,this.state,this.diff,h.nonBindedStateKeys),a=0;a<this.subscriptions.length;a++){if('bind-for'===this.subscriptions[a].name){if(!this.state[this.subscriptions[a].keysToWatch[0]].__dirty)continue;}else if(!this.shouldUpdate(this.subscriptions[a].keysToWatch,this.diff))continue;this.subscriptions[a].onStateUpdate()}for(i in this.state)this.state[i]&&this.state[i].constructor===Array&&(this.state[i].__dirty=!1);this.copyState(this.lastState,this.state),this.eventDetail.action=e,this.eventDetail.payload=t,this.el.emit('stateupdate',this.eventDetail)},copyState:function(e,t,i){for(var a in t)if(i||-1===h.nonBindedStateKeys.indexOf(a)){if(t[a]&&t[a].constructor===Object){if(!(a in e)){e[a]=AFRAME.utils.clone(t[a]);continue}this.copyState(e[a],t[a],!0);continue}e[a]=t[a]}},subscribe:function(e){this.subscriptions.push(e)},unsubscribe:function(e){this.subscriptions.splice(this.subscriptions.indexOf(e),1)},shouldUpdate:function(e,t){for(var i in t)if(-1!==e.indexOf(i))return!0;return!1},initEventHandlers:function(){function e(e){var t=this;this.el.addEventListener(e,function(i){t.dispatch(e,i.detail)})}var t=[],i=this,a;for(a in e=e.bind(this),h.handlers)-1===t.indexOf(a)&&(t.push(a),e(a))},renderTemplate:function(){var e=/{{\s*(\w*\.)?([\w.]+)\s*}}/g;return function(t,i,n){var o,r;for(r=t;o=e.exec(t);)r=r.replace(o[0],('undefined'==typeof i?'undefined':p(i))===b?a(i,o[2])||'':i);return n?r:document.createRange().createContextualFragment(r)}}(),select:a}),AFRAME.registerComponent('bind',{schema:{default:{},parse:function(e){var t,a,i,n;if(e.constructor===Object)return e;if(-1===e.indexOf(':'))return e;for(t={},i=c(e,';'),a=0;a<i.length;a++)n=c(i[a].trim(),':'),t[n[0]]=n[1].trim();return t}},multiple:!0,init:function(){var e=this.data,t;this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system=this.el.sceneEl.systems.state,this.id&&(t=c(this.id,'__')[0]),this.isNamespacedBind=this.id&&t in AFRAME.components&&!AFRAME.components[t].isSingleProp||t in AFRAME.systems,this.lastData={},this.updateObj={},this.system.subscribe(this),this.onStateUpdate=this.onStateUpdate.bind(this)},update:function(){var e=this.data,t,i;if(this.keysToWatch.length=0,'string'==typeof e)s(this.keysToWatch,e);else for(i in e)s(this.keysToWatch,e[i]);t=this.el.closest('[bind-for]'),t&&t!==this.el?(this.bindForEl=t,this.bindRootEl=this.el.closest('[data-bind-for-key]'),this.bindFor=this.bindForEl.getAttribute('bind-for'),this.bindForKey=this.bindRootEl.getAttribute('data-bind-for-key'),this.keysToWatch.push(this.bindFor.in),this.bindForEl.addEventListener('bindforrender',this.onStateUpdate)):(this.bindFor='',this.bindForKey=''),this.onStateUpdate()},onStateUpdate:function(){var e=!1,t=this.el,i,n,r,s,l;if(t.parentNode){if(this.isNamespacedBind&&o(this.updateObj),r=this.system.state,this.bindFor&&void 0!==this.bindForKey&&!this.bindFor.key){for(s=t;s.parentNode&&s.parentNode!==this.bindForEl;)s.parentNode&&(s=s.parentNode);this.bindForKey=parseInt(s.dataset.bindForKey,10)}if(p(this.data)!==b){try{l=a(r,this.data,this.bindFor,this.bindForKey)}catch(t){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}return('undefined'==typeof l?'undefined':p(l))!==b&&p(this.lastData)!==b&&this.lastData===l?void 0:(AFRAME.utils.entity.setComponentProperty(t,this.id,l),void(this.lastData=l))}for(i in this.data){n=this.data[i].trim();try{if(l=a(r,n,this.bindFor,this.bindForKey),this.bindFor&&void 0===l)return}catch(t){throw new Error('[aframe-state-component] Key \''+n+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}if(('undefined'==typeof l?'undefined':p(l))===b||p(this.lastData[i])===b||this.lastData[i]!==l){if(i in AFRAME.components&&void 0===l)return void t.removeAttribute(i);this.isNamespacedBind?this.updateObj[i]=l:AFRAME.utils.entity.setComponentProperty(t,i,l),this.lastData[i]=l}}for(e in this.updateObj);this.isNamespacedBind&&e&&t.setAttribute(this.id,this.updateObj)}},remove:function(){this.system.unsubscribe(this),this.bindForEl&&this.bindForEl.removeEventListener('bindforrender',this.onStateUpdate)}}),AFRAME.registerComponent('bind-toggle',{schema:{type:'string'},multiple:!0,init:function(){this.system=this.el.sceneEl.systems.state,this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system.subscribe(this),this.onStateUpdate()},update:function(){this.keysToWatch.length=0,s(this.keysToWatch,this.data)},onStateUpdate:function(){var e=this.el,t,i;t=this.system.state;try{i=a(t,this.data)}catch(t){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}i?e.setAttribute(this.id,''):e.removeAttribute(this.id)},remove:function(){this.system.unsubscribe(this)}}),AFRAME.registerComponent('bind-for',{schema:{for:{type:'string'},in:{type:'string'},key:{type:'string'},template:{type:'string'}},init:function(){this.system=this.el.sceneEl.systems.state,this.onStateUpdate=this.onStateUpdate.bind(this),this.keysToWatch=[],this.renderedKeys=[],this.system.subscribe(this)},update:function(){this.keysToWatch[0]=c(this.data.in,'.')[0],this.template=this.el.children[0]&&'TEMPLATE'===this.el.children[0].tagName?this.el.children[0].innerHTML.trim():document.querySelector(this.data.template).innerHTML.trim(),this.onStateUpdate()},onStateUpdate:function(){var e=[],t=[];return function(){var n=this.data,o=this.el,r,s,l,i,d,c,u;try{i=a(this.system.state,n.in)}catch(t){throw new Error('[aframe-state-component] Key \''+n.in+'\' not found in state.'+(' #'+o.getAttribute('id')+'['+this.attrName+']'))}for(e.length=0,l=0;l<i.length;l++)u=i[l],r=n.key?u[n.key].toString():l.toString(),c=n.key?u[n.key].toString():u.toString(),e.push(c),-1===this.renderedKeys.indexOf(c)&&(o.appendChild(this.system.renderTemplate(this.template,u)),o.children[o.children.length-1].setAttribute('data-bind-for-key',r),!n.key&&o.children[o.children.length-1].setAttribute('data-bind-for-value',u),this.renderedKeys.push(c));for(t.length=0,l=0;l<o.children.length;l++)'TEMPLATE'!==o.children[l].tagName&&(d=n.key?o.children[l].getAttribute('data-bind-for-key'):o.children[l].getAttribute('data-bind-for-value'),-1===e.indexOf(d)&&(t.push(o.children[l]),this.renderedKeys.splice(this.renderedKeys.indexOf(d),1)));for(l=0;l<t.length;l++)t[l].parentNode.removeChild(t[l]);if(i.length&&i[0].constructor===String)for(l=0;l<i.length;l++)s=o.querySelector('[data-bind-for-value="'+i[l]+'"]'),s&&s.setAttribute('data-bind-for-key',l.toString());this.el.emit('bindforrender',null,!1)}}()});var f='&&',v=/'/g,E='||',x=['==','===','!=','!=='],S=[],C=[];e.exports.composeHandlers=function(){var e=arguments,t,a,i;for(i={},a=0;a<e.length;a++)for(t in e[a])t in i?i[t].constructor===Array?i[t].push(e[a][t]):i[t]=[i[t],e[a][t]]:i[t]=e[a][t];for(t in i)i[t].constructor===Array&&(i[t]=r.apply(this,i[t]));return i},e.exports.composeFunctions=r;var A=['||','&&','!=','!==','==','==='],T={}},function(e){'use strict';e.exports=function(){var e=[];return function(t,a,n,o){var r,s,l,d,c,u,i;for(c in d=n||{},e.length=0,t)e.push(c);if(!a)return d;for(l in a)-1===e.indexOf(l)&&e.push(l);for(u=0;u<e.length;u++)(c=e[u],!(o&&-1!==o.indexOf(c)))&&(r=t[c],s=a[c],i=r&&s&&r.constructor===Object&&s.constructor===Object,(!i||AFRAME.utils.deepEqual(r,s))&&(i||r===s)||(d[c]=s));return d}}()},function(e){'use strict';function t(e,t){var i=e[t];e[t]=function(){i.apply(e,arguments),e.__dirty=!0}}var a=['push','pop','shift','unshift','splice'];e.exports.wrapArray=function(e){var n;if(!e.__wrapped){for(n=0;n<a.length;n++)t(e,a[n]);e.__wrapped=!0}}}])})},function(e,t,i){var a=i(15);AFRAME.registerComponent('face-colors',{schema:{baseColor:{type:'color'},faceColors:a,variation:{default:0.05}},update:function(e){var t=this.data,a=this.el,n=this,o,r,s,l,i;if(i=a.getObject3D('mesh'),!i||!i.geometry)return void a.addEventListener('componentinitialized',function t(i){'geometry'!==i.detail.name||(a.removeEventListener('componentinitialized',t),n.update(e))});if(s=i.geometry,e.baseColor!==t.baseColor)for(l=0;l<s.faces.length;l++)s.faces[l].color.set(t.baseColor).addScalar(Math.random()*t.variation);for(o in t.faceColors)for(r=t.faceColors[o],l=0;l<r.length;l++){if(faceIndex=r[l],!s.faces[faceIndex])return;s.faces[faceIndex].color.set(o)}s.colorsNeedUpdate=!0},remove:function(){var e,t;if(this.el.getObject3D('mesh'))for(e=this.el.getObject3D('mesh').geometry,t=0;t<e.faces.length;t++)e.faces[t].color.setRGB(1,1,1)}})},function(){AFRAME.registerComponent('geometry-merger',{schema:{deleteOriginalMesh:{default:!1},deleteOriginalEntities:{default:!1},hideOriginalEntities:{default:!0},ignoreWithComponent:{default:''},isParentMerger:{default:!1},materialComponent:{default:'super-material'}},init:function(){var e=this,t;if(this.initialMergeDone=!1,this.mergeCount=0,this.data.materialComponent&&!this.el.components[this.data.materialComponent])return void this.el.addEventListener('componentinitialized',function t(i){i.detail.name!==e.data.materialComponent||(e.init(),e.el.removeEventListener('componentinitialized',t))});if(this.geometry=new THREE.Geometry,this.mesh=new THREE.Mesh(this.geometry),this.el.setObject3D('mesh',this.mesh),this.faceIndex={},this.vertexIndex={},this.data.isParentMerger){for(t=0;t<this.el.children.length;t++)this.el.children[t].components['geometry-merger'].initialMergeDone?this.mergeMesh(this.el.children[t].getObject3D('mesh')):this.el.children[t].addEventListener('initialmerge',()=>{this.mergeMesh(this.el.children[t].getObject3D('mesh'))});this.childAttachedHandler=this.childAttachedHandler.bind(this),this.el.addEventListener('child-attached',this.childAttachedHandler)}else this.el.object3D.traverse(this.mergeMesh.bind(this)),this.object3DSetHandler=this.object3DSetHandler.bind(this),this.el.addEventListener('object3dset',this.object3DSetHandler)},mergeMesh:function(e){if(!('Mesh'!==e.type||this.isRemoved)&&e!==this.mesh&&e.el!==this.el&&e.geometry&&e.geometry.faces){if(this.data.ignoreWithComponent)for(var t in e.el.components)if(e.el.components[t].name===this.data.ignoreWithComponent)return;if(!(this.data.isParentMerger&&e.el.parentNode!==this.el)&&(this.faceIndex[e.parent.uuid]=[this.geometry.faces.length,this.geometry.faces.length+e.geometry.faces.length-1],this.vertexIndex[e.parent.uuid]=[this.geometry.vertices.length,this.geometry.vertices.length+e.geometry.vertices.length-1],e.parent.updateMatrix(),this.geometry.merge(e.geometry,e.parent.matrix),this.geometry.elementsNeedUpdate=!0,this.geometry.computeBoundingSphere(),this.data.hideOriginalEntities&&(e.el.object3D.visible=!1,e.el.object3D.matrixAutoUpdate=!1),this.data.deleteOriginalMesh&&e.parent.remove(e),++this.mergeCount===(parseInt(this.el.dataset.geometryMergerChildCount,10)||this.el.children.length)&&!this.initialMergeDone&&(this.initialMergeDone=!0,this.el.emit('initialmerge',this.el),this.data.deleteOriginalEntities)))for(;0<this.el.children.length;)this.el.removeChild(this.el.children[0])}},remove:function(){var e;if(this.data.hideOriginalEntities)for(e=0;e<this.el.children.length;e++)this.el.children[e].object3D.visible=!0,this.el.children[e].object3D.matrixAutoUpdate=!0;this.geometry.dispose(),this.el.removeObject3D('mesh'),this.childAttachedHandler&&this.el.removeEventListener('child-attached',this.childAttachedHandler),this.object3DSetHandler&&this.el.removeEventListener('object3dset',this.object3DSetHandler),this.isRemoved=!0},childAttachedHandler:function(e){var t=this;this.isRemoved||e.detail.el.parentNode!==this.el||e.detail.el.addEventListener('initialmerge',function e(i){t.mergeMesh(i.detail.getObject3D('mesh')),i.detail.removeEventListener('initialmerge',e)})},object3DSetHandler:function(e){this.isRemoved||'mesh'!==e.detail.type||this.mergeMesh(e.detail.object)}})},function(e){e.exports={default:{},parse:function(e){return e?'string'==typeof e?(e=e.replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '),JSON.parse(e)):e:null},stringify:JSON.stringify}},function(){AFRAME.registerComponent('debug-scripts',{schema:{addShape:{default:!0},enabled:{default:!1}},init:function(){var e;(this.data.enabled||AFRAME.utils.getUrlParameter('debug-scripts'))&&'false'!==AFRAME.utils.getUrlParameter('debug-scripts')&&(console.log('%c debug-scripts enabled ','background: #222; color: red'),e=document.getElementById('primaryHand'),this.el.emit('menubuttonpress',{id:'mainMenuBuild',menu:'mainMenu'}),this.el.emit('menubuttonpress',{id:'buildMenuCraft',menu:'buildMenu'}),this.el.emit('menubuttonpress',{id:'craftMenuScript',menu:'craftMenu'}))}})},function(){AFRAME.registerComponent('script-active-color',{schema:{activeOption:{type:'string'}},update:function(){var e,t;for(t=0;t<this.el.children.length;t++)e=this.el.children[t],e.dataset.option===this.data.activeOption?e.children[0].setAttribute('super-material','color','#48BAEA'):e.children[0].setAttribute('super-material','color','#333')}})},function(){AFRAME.registerComponent('script-menu-add',{schema:{type:{type:'string',oneOf:['when','then']}},init:function(){this.handleAdd=this.handleAdd.bind(this),this.el.addEventListener('click',this.handleAdd),this.eventDetail={addType:this.data.type}},handleAdd:function(e){this.eventDetail.option=e.target.dataset.option,this.el.sceneEl.emit('scriptmenuadd',this.eventDetail)}})},function(){AFRAME.registerComponent('script-menu-field-press',{init:function(){this.onPress=this.onPress.bind(this),this.el.addEventListener('click',this.onPress),this.eventDetail={}},onPress:function(e){e.target.classList.contains('scriptMenuItemField')&&(this.eventDetail.fieldType=e.target.dataset.fieldType,this.eventDetail.lineNumber=e.target.parentNode.dataset.lineNumber,this.eventDetail.scriptType=e.target.dataset.scriptType,this.el.sceneEl.emit('scriptfieldpress',this.eventDetail))}})},function(){AFRAME.registerComponent('script-menu-go-to-state-panel',{init:function(){this.onPress=this.onPress.bind(this),this.el.addEventListener('click',this.onPress),this.eventDetail={}},onPress:function(e){e.target.classList.contains('stateOption')&&(this.eventDetail.state=e.target.dataset.option,this.el.sceneEl.emit('scriptfieldgotostateselect',this.eventDetail))}})},function(e,t,i){'use strict';function a(e,t,a,n){var o='',r=0,s,i,l,d,c;for(s=0;s<a.length;s++){if(d=e.children[s]||document.createElement('a-entity'),l='text scriptMenuItemText',0===s)l+=' scriptMenuItemRootText',c=a[0],r++;else if(a[s].startsWith('$')){switch(o='scriptMenuItemField',l='slice '+l,l+=' scriptMenuItemField',a[s]){case'${state}':{l+=' scriptMenuItemFieldState',c=t[r],d.dataset.fieldType='state',d.dataset.title='Select state';break}case'${time}':{l+=' scriptMenuItemFieldTime',c=`${t[r]/1e3} s`,d.dataset.fieldType='time',d.dataset.title='Specify duration';break}}r++}else l+=' scriptMenuItemNormalText',c=a[s];d.setAttribute('class',o),d.setAttribute('mixin',l),d.setAttribute('text','value',c),d.dataset.scriptType=n,e.children[s]||e.appendChild(d)}return i}Object.defineProperty(t,'__esModule',{value:!0});var n=i(31),o=n.a.labels.when,r=n.a.labels.then;AFRAME.registerComponent('script-menu-render',{schema:{activeScript:{type:'string'},needsUpdate:{default:0},scriptMode:{default:!1}},init:function(){this.thenList=document.getElementById('scriptMenuThenList'),this.whenList=document.getElementById('scriptMenuWhenList')},update:function(){var e,t,i,n,s;if(this.data.scriptMode){for(s=this.el.sceneEl.systems.state.state,e=s.entityIndex[s.stagedEntityId],i=e.attributes[`super-script__${this.data.activeScript}`],t=0;t<this.thenList.children.length;t++)this.thenList.children[t].setAttribute('visible',!!(i&&i.then[t]));for(t=0;t<this.whenList.children.length;t++)this.whenList.children[t].setAttribute('visible',!!(i&&i.when[t]));if(i){for(t=0;t<i.when.length;t++)n=this.whenList.children[t]||document.createElement('a-entity'),n.setAttribute('class','scriptMenuWhen'),n.setAttribute('mixin','text scriptMenuItem'),n.dataset.lineNumber=t,a(n,i.when[t],o[i.when[t][0]],'when'),this.whenList.children[t]||this.whenList.appendChild(n);for(t=0;t<i.then.length;t++)n=this.thenList.children[t]||document.createElement('a-entity'),n.setAttribute('class','scriptMenuThen'),n.setAttribute('mixin','text scriptMenuItem'),n.dataset.lineNumber=t,a(n,i.then[t],r[i.then[t][0]],'then'),this.thenList.children[t]||this.thenList.appendChild(n)}}}})},function(){AFRAME.registerComponent('script-menu-state-change',{schema:{state:{default:'default'}},update:function(){var e=this.data,t=this.el,i,a,n,o;if((n=t.querySelector('[data-staged].entity'),!!n)&&(a=n.getAttribute('id'),o='default'===e.state?t.sceneEl.systems.state.state.entityIndex[a].attributes:t.sceneEl.systems.state.state.entityIndex[a].states[e.state],!!o))for(i in o)n.setAttribute(i,o[i])}})},function(){AFRAME.registerComponent('script-menu-toggle',{schema:{isStateMenu:{default:!1}},init:function(){this.onClick=this.onClick.bind(this),this.el.addEventListener('click',this.onClick),this.eventDetail={},this.eventName=this.data.isStateMenu?'scriptstatetoggle':'scripttoggle'},onClick:function(e){this.eventDetail.option=e.target.parentNode.dataset.option,this.el.emit(this.eventName,this.eventDetail)}})},function(){AFRAME.registerComponent('super-script-toggler',{schema:{playMode:{default:!0}},update:function(){var e,t,a,n,o;for(t=this.el.children,o=0;o<t.length;o++)for(n in e=t[o],e.components)a=e.components[n],'super-script'===a.name&&t[o].setAttribute(a.attrName,'enabled',this.data.playMode)}})},function(){AFRAME.registerComponent('super-script',{schema:{enabled:{default:!0},when:{type:'array'},then:{type:'array'},in:{type:'number',default:0}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=void 0},update:function(){this.clearScript(),this.setupEventHandler()},remove:function(){this.clearScript()},setupEventHandler:function(){var e,t,i;switch(this.data.when[0][0]){case'touched':{e='hitstart';break}}t=this.createEventHandlerFunction(),i=()=>{this.data.enabled&&setTimeout(t,this.data.in)},this.el.addEventListener(e,i),this.eventName=e,this.eventHandler=i},createEventHandlerFunction:function(){var e;return()=>{for(e=0;e<this.data.then.length;e++)switch(this.data.then[e][0]){case'gotostate':{this.el.setAttribute('go-to-state',{state:this.data.then[e][1],duration:this.data.then[e][2]});break}}}},clearScript:function(){this.el.removeEventListener(this.eventName,this.eventHandler),this.eventHandler=null,this.eventName=void 0}})},function(){var e={black:{skyColor:'#000000',horizonColor:'#1d1d1d',groundColor:'#5c5c5c'},blue:{skyColor:'#5992e6',horizonColor:'#b8e7e7',groundColor:'#3da3c9'},brown:{skyColor:'#125598',horizonColor:'#b9e6f4',groundColor:'#7a4941'},darkbrown:{skyColor:'#118faa',horizonColor:'#96e0ac',groundColor:'#705134'},darkgray:{skyColor:'#1a1a1a',horizonColor:'#272727',groundColor:'#676767'},darkpink:{skyColor:'#3c354d',horizonColor:'#7d564d',groundColor:'#695641'},darkred:{skyColor:'#000000',horizonColor:'#781a12',groundColor:'#701710'},gray:{skyColor:'#5b5b5b',horizonColor:'#787878',groundColor:'#585858'},green:{skyColor:'#1f5b98',horizonColor:'#b0f4e7',groundColor:'#517139'},lightblue:{skyColor:'#38a3f1',horizonColor:'#c1eee1',groundColor:'#a47142'},lightgray:{skyColor:'#667d97',horizonColor:'#c0c0c0',groundColor:'#6c886d'},lightpurple:{skyColor:'#915CB9',horizonColor:'#ebca8d',groundColor:'#597c36'},orange:{skyColor:'#ed741b',horizonColor:'#fbc173',groundColor:'#2c6c94'},orangered:{skyColor:'#e64a1e',horizonColor:'#d7bf1a',groundColor:'#326135'},pink:{skyColor:'#EDA78A',horizonColor:'#f7ebc8',groundColor:'#af8674'},purple:{skyColor:'#6B3869',horizonColor:'#1d1238',groundColor:'#8c56a9'},red:{skyColor:'#821c13',horizonColor:'#1c6177',groundColor:'#981b1e'},teal:{skyColor:'#00b295',horizonColor:'#e6e1aa',groundColor:'#b5742d'},white:{skyColor:'#c7c7c7',horizonColor:'#e6e6df',groundColor:'#d4d4d4'},yellow:{skyColor:'#15ae71',horizonColor:'#c9c130',groundColor:'#a38b56'}},t={black:{color:'#c8c8c8',intensity:'0.15'},blue:{color:'#FFFFFF',intensity:'0.8'},brown:{color:'#e6dbc8',intensity:'1'},darkbrown:{color:'#f7f2c1',intensity:'1'},darkgray:{color:'#747474',intensity:'0.45'},darkpink:{color:'#d19156',intensity:'0.7'},darkred:{color:'#3e7c84',intensity:'0.35'},gray:{color:'#FFFFFF',intensity:'0.65'},green:{color:'#faf8d3',intensity:1},lightblue:{color:'#cef0ec',intensity:'0.95'},lightgray:{color:'#FFFFFF',intensity:'0.8'},lightpurple:{color:'#efc472',intensity:'0.95'},orange:{color:'#fbb168',intensity:'1'},orangered:{color:'#f5f283',intensity:1},pink:{color:'#fceee0',intensity:'0.8'},purple:{color:'#9cb5e2',intensity:'0.55'},red:{color:'#56cfe4',intensity:'0.75'},teal:{color:'#d1ceba',intensity:1},white:{color:'#dee2e2',intensity:'0.9'},yellow:{color:'#e7d34b',intensity:'0.75'}};AFRAME.registerComponent('super-environment-updater',{schema:{buildMode:{default:!1},craftMode:{default:!1},isSiteLoading:{default:!1},preset:{default:'teal'}},init:function(){this.resetValues={dressing:'none',ground:'flat',groundColor2:'#b5742d',groundColor:'#b5742d',groundTexture:'squares',groundYScale:1,horizonColor:'#e6e1aa',lighting:'none',preset:'default',shadow:!0,skyColor:'#00b295',skyType:'gradient'},this.buildMode={grid:'1x1',gridColor:'#717317'},this.craftMode={grid:'crosses',gridColor:'#24B59F',groundColor2:'#626262',groundColor:'#5B5B5B',skyColor:'#808080'},this.loadingMode={grid:'none',gridColor:'#24B59F',groundColor2:'#333',groundColor:'#222',skyColor:'#010101'},this.playMode={grid:'none'},this.createEnvironment()},update:function(){var t={};return function(){var i=this.envEl;Object.assign(t,this.resetValues),envPreset=e[this.data.preset],envPreset.groundColor2=envPreset.groundColor,Object.assign(t,envPreset),this.setLights(),this.data.isSiteLoading?(Object.assign(t,this.loadingMode),i.setAttribute('super-environment',t)):this.data.buildMode?(Object.assign(t,this.buildMode),i.setAttribute('super-environment',t)):this.data.craftMode?(Object.assign(t,this.craftMode),i.setAttribute('super-environment',t)):(Object.assign(t,this.playMode),i.setAttribute('super-environment',t))}}(),createEnvironment:function(){this.envEl=document.createElement('a-entity'),this.envEl.setAttribute('id','superEnvironment'),this.ambientlightEl=document.createElement('a-entity'),this.ambientlightEl.setAttribute('id','superLightAmbient'),this.ambientlightEl.setAttribute('light',{type:'ambient',color:'#111',intensity:1}),this.envEl.appendChild(this.ambientlightEl),this.hemilightEl=document.createElement('a-entity'),this.hemilightEl.setAttribute('id','superLightHemisphere'),this.hemilightEl.setAttribute('light',{type:'hemisphere',intensity:0.5,groundColor:'#FFF',color:'#24B59F'}),this.envEl.appendChild(this.hemilightEl),this.keylightEl=document.createElement('a-entity'),this.keylightEl.setAttribute('id','superLightDirectional'),this.keylightEl.setAttribute('light',{castShadow:!0,color:'#d58f62',intensity:0.8,shadowBias:-1e-4,shadowCameraBottom:-20,shadowCameraFov:360,shadowCameraLeft:-20,shadowCameraNear:0.01,shadowCameraRight:20,shadowCameraTop:20,shadowMapHeight:2048,shadowMapWidth:2048}),this.keylightEl.object3D.position.set(2,9,2),this.envEl.appendChild(this.keylightEl),this.el.sceneEl.appendChild(this.envEl)},setLights:function(){var e={},i={};return function(){var a;a=t[this.data.preset],e.color=a.color,e.intensity=a.intensity,this.keylightEl.setAttribute('light',e),i.color=envPreset.skyColor,i.groundColor=envPreset.groundColor,i.intensity=0.5*a.intensity,this.hemilightEl.setAttribute('light',i),this.ambientlightEl.setAttribute('light','intensity',a.intensity)}}()})},function(){function e(e){var t={};return'none'!==e.grid&&(t.grid=e.grid,t.gridColor=e.gridColor),t.groundColor=e.groundColor,t.groundColor2=e.groundColor2,t.groundTexture=e.groundTexture,JSON.stringify(t)}var t=Math.abs,a=Math.sin,n=Math.floor,o=Math.min,s=Math.PI,l=Math.max,r={};if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('super-environment',{schema:{active:{default:!1},preset:{default:'default',oneOf:['none','default','contact','egypt','checkerboard','forest','goaland','yavapai','goldmine','arches','threetowers','poison','tron','japan','dream','volcano','starry','osiris']},seed:{type:'int',default:1,min:0,max:1e3},skyType:{default:'color',oneOf:['none','color','gradient','atmosphere']},skyColor:{type:'color'},horizonColor:{type:'color'},lighting:{default:'distant',oneOf:['none','distant','point']},shadow:{default:!1},shadowSize:{default:10},lightPosition:{type:'vec3',default:{x:0,y:1,z:-0.2}},fog:{type:'float',default:0,min:0,max:1},flatShading:{default:!1},playArea:{type:'float',default:1,min:1,max:100},ground:{default:'hills',oneOf:['none','flat','hills','canyon','spikes','noise']},groundYScale:{type:'float',default:3,min:0,max:50},groundTexture:{default:'none',oneOf:['none','checkerboard','squares','walkernoise']},groundColor:{type:'color',default:'#553e35'},groundColor2:{type:'color',default:'#694439'},dressing:{default:'none',oneOf:['none','cubes','pyramids','cylinders','hexagons','stones','trees','mushrooms','towers','apparatus','arches','torii']},dressingAmount:{type:'int',default:10,min:0,max:1e3},dressingColor:{type:'color',default:'#795449'},dressingScale:{type:'float',default:5,min:0,max:100},dressingVariance:{type:'vec3',default:{x:1,y:1,z:1}},dressingUniformScale:{default:!0},dressingOnPlayArea:{type:'float',default:0,min:0,max:1},grid:{default:'none',oneOf:['none','1x1','2x2','crosses','dots','xlines','ylines']},gridColor:{type:'color',default:'#ccc'}},multiple:!1,presets:{none:{},default:{active:!0,seed:1,skyType:'atmosphere',skyColor:'#88c',horizonColor:'#ddd',lighting:'distant',lightPosition:{x:-0.11,y:1,z:0.33},fog:0.78,flatShading:!1,playArea:1,ground:'hills',groundYScale:3,groundTexture:'checkerboard',groundColor:'#454545',groundColor2:'#5d5d5d',dressing:'none',dressingAmount:10,dressingColor:'#795449',dressingScale:1,dressingVariance:{x:0,y:0,z:0},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'none',gridColor:'#ccc',shadow:!1},contact:{active:!0,seed:14,skyType:'gradient',skyColor:'#478d54',horizonColor:'#b696cb',lighting:'distant',lightPosition:{x:0,y:2.01,z:-1},fog:0.8,flatShading:!1,playArea:1,ground:'spikes',groundYScale:4.91,groundTexture:'none',groundColor:'#2e455f',groundColor2:'#694439',dressing:'apparatus',dressingAmount:7,dressingColor:'#657067',dressingScale:20,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'1x1',gridColor:'#478d54',shadow:!1},egypt:{active:!0,seed:26,skyType:'gradient',skyColor:'#1b7660',horizonColor:'#e4b676',lighting:'distant',lightPosition:{x:0,y:1.65,z:-1},fog:0.75,flatShading:!1,playArea:1,ground:'hills',groundYScale:5,groundTexture:'walkernoise',groundColor:'#664735',groundColor2:'#6c4b39',dressing:'pyramids',dressingAmount:10,dressingColor:'#7c5c45',dressingScale:5,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'spots',gridColor:'#e4b676',shadow:!1},checkerboard:{active:!0,seed:1,skyType:'gradient',skyColor:'#0d0d0d',horizonColor:'#404040',lighting:'distant',lightPosition:{x:0,y:1,z:-0.2},fog:0.81,flatShading:!0,playArea:1,ground:'hills',groundYScale:4.81,groundTexture:'checkerboard',groundColor:'#252525',groundColor2:'#111111',dressing:'cubes',dressingAmount:10,dressingColor:'#9f9f9f',dressingScale:1.51,dressingVariance:{x:5,y:20,z:5},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'dots',gridColor:'#ccc',shadow:!1},forest:{active:!0,seed:8,skyType:'gradient',skyColor:'#24b59f',horizonColor:'#eff9b7',lighting:'distant',lightPosition:{x:-1.2,y:0.88,z:-0.55},fog:0.8,flatShading:!1,playArea:1,ground:'noise',groundYScale:4.18,groundTexture:'squares',groundColor:'#937a24',groundColor2:'#987d2e',dressing:'trees',dressingAmount:500,dressingColor:'#888b1d',dressingScale:1,dressingVariance:{x:10,y:10,z:10},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'none',gridColor:'#c5a543',shadow:!1},goaland:{active:!0,seed:17,skyType:'gradient',skyColor:'#14645f',horizonColor:'#a3dab8',lighting:'point',lightPosition:{x:0.1,y:4,z:0.56},fog:0.73,flatShading:!1,playArea:1,ground:'noise',groundYScale:0.81,groundTexture:'none',groundColor:'#ae3241',groundColor2:'#db4453',dressing:'mushrooms',dressingAmount:150,dressingColor:'#a9313d',dressingScale:5,dressingVariance:{x:5,y:10,z:5},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'dots',gridColor:'#239893',shadow:!1},yavapai:{active:!0,seed:11,skyType:'gradient',skyColor:'#239849',horizonColor:'#cfe0af',lighting:'distant',lightPosition:{x:0.5,y:1,z:0},fog:0.8,flatShading:!0,playArea:1,ground:'canyon',groundYScale:9.76,groundTexture:'walkernoise',groundColor:'#C66344',groundColor2:'#c96b4b',dressing:'stones',dressingAmount:500,dressingColor:'#C66344',dressingScale:0.06,dressingVariance:{x:0.2,y:0.1,z:0.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:'none',gridColor:'#239893',shadow:!1},goldmine:{active:!0,seed:53,skyType:'gradient',skyColor:'#1e1c1a',horizonColor:'#8c7964',lighting:'point',lightPosition:{x:-0.09,y:3,z:0.33},fog:0.43,flatShading:!0,playArea:1.08,ground:'canyon',groundYScale:50,groundTexture:'none',groundColor:'#353535',groundColor2:'#454545',dressing:'hexagons',dressingAmount:300,dressingColor:'#fe921b',dressingScale:0.5,dressingVariance:{x:2,y:8,z:2},dressingUniformScale:!0,dressingOnPlayArea:0.03,grid:'none',gridColor:'#ccc',shadow:!1},threetowers:{active:!0,seed:5,skyType:'gradient',skyColor:'#23a06b',horizonColor:'#f5e170',lighting:'distant',lightPosition:{x:0.5,y:1,z:0},fog:0.8,flatShading:!1,playArea:1,ground:'spikes',groundYScale:4.26,groundTexture:'walkernoise',groundColor:'#273a49',groundColor2:'#2b464f',dressing:'towers',dressingAmount:3,dressingColor:'#5f6d94',dressingScale:50,dressingVariance:{x:10,y:100,z:10},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'none',gridColor:'#239893',shadow:!1},poison:{active:!0,seed:92,skyType:'gradient',skyColor:'#1ea84a',horizonColor:'#177132',lighting:'distant',lightPosition:{x:0.5,y:1,z:0},fog:0.8,flatShading:!1,playArea:1,ground:'canyon',groundYScale:9.76,groundTexture:'none',groundColor:'#851f31',groundColor2:'#912235',dressing:'hexagons',dressingAmount:20,dressingColor:'#c7415b',dressingScale:20,dressingVariance:{x:20,y:200,z:20},dressingUniformScale:!1,dressingOnPlayArea:0,grid:'crosses',gridColor:'#1ea84a',shadow:!1},arches:{active:!0,seed:19,skyType:'atmosphere',skyColor:'#8cbdc8',horizonColor:'#ddd',lighting:'distant',lightPosition:{x:-0.11,y:0.16,z:0.33},fog:0.67,flatShading:!0,playArea:1,ground:'canyon',groundYScale:10,groundTexture:'walkernoise',groundColor:'#a87d6f',groundColor2:'#795449',dressing:'arches',dressingAmount:6,dressingColor:'#795449',dressingScale:26,dressingVariance:{x:20,y:40,z:20},dressingUniformScale:!0,dressingOnPlayArea:0.04,grid:'none',gridColor:'#ccc',shadow:!1},tron:{active:!0,seed:14,skyType:'gradient',skyColor:'#091b39',horizonColor:'#284a9e',lighting:'distant',lightPosition:{x:-0.72,y:0.62,z:0.4},fog:0.8,flatShading:!1,playArea:1,ground:'spikes',groundYScale:4.91,groundTexture:'none',groundColor:'#061123',groundColor2:'#694439',dressing:'towers',dressingAmount:5,dressingColor:'#fb000e',dressingScale:15,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'1x1',gridColor:'#fb000e',shadow:!1},japan:{active:!0,seed:14,skyType:'gradient',skyColor:'#7e5db5',horizonColor:'#b4adda',lighting:'distant',lightPosition:{x:1.33,y:1,z:0.24},fog:0.9,flatShading:!1,playArea:1,ground:'hills',groundYScale:25,groundTexture:'walkernoise',groundColor:'#7e5db5',groundColor2:'#cabdf5',dressing:'torii',dressingAmount:4,dressingColor:'#bc5e7c',dressingScale:15,dressingVariance:{x:0,y:0,z:0},dressingUniformScale:!0,dressingOnPlayArea:0,grid:'spots',gridColor:'#e4b676',shadow:!1},dream:{active:!0,seed:17,skyType:'gradient',skyColor:'#87faf4',horizonColor:'#b34093',lighting:'distant',lightPosition:{x:-0.72,y:0.53,z:0.97},fog:0.8,flatShading:!1,playArea:1,ground:'hills',groundYScale:20,groundTexture:'checkerboard',groundColor:'#b34093',groundColor2:'#c050a2',dressing:'mushrooms',dressingAmount:300,dressingColor:'#3cf7ed',dressingScale:0.2,dressingVariance:{x:0.2,y:0.2,z:0.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:'none',gridColor:'#239893',shadow:!1},volcano:{active:!0,seed:92,skyType:'gradient',skyColor:'#4a070f',horizonColor:'#f62300',lighting:'point',lightPosition:{x:0.5,y:2.25,z:0},fog:0.87,flatShading:!1,playArea:1,ground:'canyon',groundYScale:9.76,groundTexture:'walkernoise',groundColor:'#fb0803',groundColor2:'#510000',dressing:'arches',dressingAmount:15,dressingColor:'#fb0803',dressingScale:3,dressingVariance:{x:10,y:100,z:10},dressingUniformScale:!1,dressingOnPlayArea:0.2,grid:'none',gridColor:'#fa0e00',shadow:!1},starry:{active:!0,seed:1,skyType:'atmosphere',skyColor:'#88c',horizonColor:'#ddd',lighting:'distant',lightPosition:{x:0,y:-0.01,z:-0.46},fog:0.7,flatShading:!1,playArea:1,ground:'hills',groundYScale:3,groundTexture:'none',groundColor:'#553e35',groundColor2:'#694439',dressing:'none',dressingAmount:100,dressingColor:'#795449',dressingScale:5,dressingVariance:{x:1,y:1,z:1},dressingUniformScale:!0,grid:'1x1',dressingOnPlayArea:0,gridColor:'#39d2f2',shadow:!1},osiris:{active:!0,seed:46,skyType:'atmosphere',skyColor:'#88c',horizonColor:'#ddd',lighting:'distant',lightPosition:{x:0,y:0.02,z:-0.46},fog:0,flatShading:!1,playArea:1,ground:'hills',groundYScale:3,groundTexture:'none',groundColor:'#9e7b47',groundColor2:'#9e7b47',dressing:'pyramids',dressingAmount:7,dressingColor:'#9e7b47',dressingScale:5,dressingVariance:{x:30,y:30,z:30},dressingUniformScale:!0,grid:'dots',dressingOnPlayArea:0,gridColor:'#daa452',shadow:!1}},init:function(){for(var e in this.STAGE_SIZE=30,this.assets={arches:[{type:'mesh',vertices:[409,268,4,351,228,36,336,236,-57,-152,391,69,-135,358,88,-119,330,43,-20,358,-35,-153,357,-47,37,413,-26,-20,411,-14,-302,148,154,-339,121,-126,-389,200,-88,-477,193,-76,-314,346,-19,-314,306,-30,-250,296,-73,-267,237,-82,-212,303,-68,-245,200,-67,-223,304,108,-329,299,107,-289,350,76,-320,342,69,119,373,-39,38,370,8,113,367,52,492,202,-31,462,83,-104,447,71,-80,426,112,25,482,189,-7,222,372,6,121,402,41,87,382,67,221,346,55,559,93,-13,528,47,39,505,21,-111,528,54,-101,616,31,-53,442,256,-15,300,338,19,257,308,-79,408,256,-74,312,352,-26,384,297,-31,437,257,-47,-29,415,53,-232,377,59,-139,335,77,-132,344,2,-18,377,-37,-171,387,-28,-254,384,18,-651,-27,27,-435,-28,179,-345,149,165,-272,-28,23,-215,146,-2,-279,-29,-59,-211,145,-55,-337,-28,-128,-413,247,0,-293,363,24,-214,254,-36,-164,290,33,-284,150,94,-218,362,105,75,369,29,518,147,-63,447,190,-70,445,56,-105,391,185,-60,431,49,-33,459,83,26,470,162,42,130,390,53,167,341,-30,125,394,-45,239,368,-17,91,414,10,450,18,2,449,-27,-9,436,-28,-58,496,-27,-110,582,-28,-140,647,-27,-56,325,325,-45,-307,297,-56,-647,-28,-45,-188,310,-54,-264,197,113,-367,175,139,8,387,82,426,45,-55,114,359,-28,500,27,44,461,-29,13,-512,-27,-151,-152,376,-38,-490,-28,148,12,370,-28,442,160,42,465,194,32,381,183,-33,649,-27,-34,444,16,29,616,-28,25,417,267,-66,-132,352,-34,-322,-27,130,-271,86,-115,-635,-28,-121,-291,203,-99,176,405,-10,561,52,-93,371,305,9,311,237,-22,377,200,-81,-129,406,46,-154,371,99,-82,361,71,-21,354,26,-91,363,-27,-165,413,-12,-414,215,110,-238,127,26,-408,-28,-128,-674,-28,-94,-446,232,-39,-311,226,-90,-255,210,-61,-235,192,-11,-217,218,58,-269,299,124,-386,276,78,-399,281,42,15,373,58,16,393,75,549,107,-46,481,188,-68,409,120,-41,541,81,12,230,368,41,194,350,-50,224,361,-50,604,-28,-10,602,-27,35,486,56,-121,502,69,-120,457,-27,-110,226,317,-40,-584,-28,-124,439,-26,-30,467,-26,39,547,-27,-146,21,368,14,466,229,-29,578,-27,44,609,-27,-96,291,356,-15,290,306,34,255,321,28,231,311,-5,-251,386,50,-183,307,87,-152,307,24,-264,373,-12,-392,-27,190,-333,-28,84,-281,-27,54,-270,-28,-23,-308,-28,-101,-687,-27,-59,39,418,39,413,163,25,404,206,-90,54,400,-31,121,352,8,-454,41,148,-426,9,182,-564,115,3,-427,27,-107,-548,118,-32,-556,122,-53,-517,91,-101,-475,54,140,-461,52,-134,-558,119,-71,-434,286,59,-687,-31,52,-595,146,22,-670,-28,164,-537,166,122,-575,-28,217,-566,159,65,-470,152,136,-712,-29,102,-639,-29,211,-532,-30,181,-442,-30,-100],faces:[76,104,162,1,176,103,103,76,1,2,119,73,73,105,2,2,118,152,45,161,46,46,109,45,3,120,49,49,68,3,3,121,139,139,48,3,4,122,94,94,121,4,6,123,124,9,175,81,10,169,111,10,67,92,88,43,146,11,131,114,11,128,183,13,130,15,90,184,174,90,182,184,130,184,63,14,130,63,15,130,14,16,131,12,15,168,53,18,91,17,131,16,17,65,133,132,65,132,91,67,134,166,166,92,67,20,135,92,20,166,4,4,121,20,22,135,68,25,102,96,25,157,102,69,138,157,69,157,25,39,150,71,71,141,39,28,150,149,149,72,28,142,176,105,36,140,27,27,143,36,32,115,81,32,144,161,161,80,32,77,35,144,34,26,77,78,179,96,145,152,78,178,79,145,80,146,79,147,140,36,143,108,36,143,37,148,74,95,154,154,83,74,72,149,151,151,95,72,38,150,156,40,147,106,70,140,40,40,116,70,42,162,0,35,163,162,43,145,146,46,117,41,47,158,27,48,139,175,122,138,94,157,138,123,52,178,102,52,102,6,52,124,7,7,100,52,53,125,8,57,93,181,56,169,181,59,127,58,60,173,61,62,128,11,11,112,62,65,91,167,65,167,66,126,93,21,22,68,49,72,95,29,142,29,74,74,82,142,75,107,97,75,97,103,76,97,37,104,143,31,78,152,164,78,164,179,79,178,8,97,155,159,107,98,155,83,98,82,154,95,84,39,116,86,86,156,39,87,160,116,24,145,96,162,104,0,105,118,2,43,177,119,44,177,43,91,51,167,44,88,109,46,161,117,3,68,121,3,48,120,4,166,50,50,122,4,5,123,122,123,138,122,110,124,51,170,10,111,110,91,7,7,124,110,8,125,9,9,81,8,186,12,188,92,135,10,11,114,112,64,63,137,13,15,89,89,53,100,64,168,14,14,168,15,89,100,16,16,12,89,100,18,16,17,91,132,112,19,61,18,7,91,19,17,132,133,127,59,133,59,61,136,21,22,134,127,133,20,92,166,121,135,20,158,31,27,21,135,22,23,137,136,24,102,178,178,145,24,25,179,69,26,94,138,27,140,70,27,70,141,150,177,71,28,177,150,29,142,73,73,119,29,142,82,30,30,176,142,107,75,82,31,143,27,33,81,175,31,41,104,115,79,8,32,33,144,80,115,32,33,175,139,35,162,42,77,139,34,163,26,179,163,179,164,78,96,145,177,29,119,108,143,148,148,37,159,97,159,37,74,83,82,38,149,150,156,150,39,40,106,87,87,116,40,140,147,40,161,144,42,42,117,161,41,0,104,41,117,0,0,117,42,164,118,163,1,163,118,118,176,1,118,105,176,152,118,164,43,152,145,43,119,2,71,109,141,47,41,158,44,71,177,45,109,88,45,88,146,46,47,109,141,47,27,167,50,166,49,120,165,139,121,94,5,122,50,123,51,124,157,6,102,157,123,6,100,8,178,5,167,51,6,124,52,100,178,52,53,168,125,125,165,120,54,125,168,9,48,175,120,9,125,93,10,135,181,101,56,57,169,10,59,172,61,67,170,171,67,171,127,58,127,171,129,186,113,60,61,172,61,173,112,62,112,173,174,189,129,165,64,23,64,137,23,165,22,49,64,54,168,17,114,131,17,112,114,66,133,65,19,132,133,19,133,61,134,133,66,166,134,66,166,66,167,93,135,21,68,135,121,23,136,22,94,34,139,25,96,179,26,138,69,69,179,26,30,103,176,116,141,70,39,141,116,73,142,105,143,76,37,26,35,77,103,97,76,77,144,33,33,139,77,38,151,149,80,161,45,80,45,146,81,115,8,107,155,97,82,98,107,95,151,84,38,156,85,86,116,160,96,102,24,72,29,28,29,95,74,75,30,82,108,147,36,88,44,43,91,110,51,170,67,10,11,183,131,64,14,63,89,15,53,100,7,18,112,17,19,127,134,67,136,126,21,158,41,31,33,32,81,115,80,79,177,28,29,43,2,152,71,44,109,47,46,41,141,109,47,167,5,50,123,5,51,100,53,8,125,54,165,9,120,48,93,57,10,59,58,172,174,185,189,165,54,64,165,23,22,94,26,34,30,75,103,143,104,76,26,163,35,38,85,151,192,182,191,183,128,201,12,13,89,181,169,57,186,153,113,188,183,99,184,182,63,185,13,189,180,181,93,186,99,153,189,186,129,185,184,130,186,13,12,187,93,126,193,199,194,194,196,193,200,187,195,187,197,195,187,126,197,197,190,194,190,136,137,190,196,194,63,182,192,63,192,196,192,198,196,191,182,55,193,196,198,194,199,197,195,197,199,136,197,126,190,137,63,190,63,196,197,136,190,192,191,198,201,99,183,90,55,182,181,180,101,185,130,13,186,188,99,186,189,13,187,180,93,200,101,187,183,188,131,184,185,174,180,187,101,16,18,17,12,131,188,35,42,144,163,1,162,76,162,1,79,146,145]}],stones:[{type:'mesh',vertices:[-376,189,42,230,223,-310,353,162,-62,414,-23,-67,256,90,-475,24,85,-526,-418,-16,57,-432,66,-40,-199,151,-376,-155,49,467,-91,289,201,293,197,91,81,-17,-480,42,108,431,-359,-17,-250,383,-19,-243,194,-15,270,-272,180,293,-86,212,262,234,54,297,395,97,-302,-123,-21,-444,-416,-19,-123,-323,-18,267,-100,-16,429,-300,96,-361,163,-19,409,118,201,-431,-241,-18,391,-130,274,-309,306,-19,-399,-221,96,404],faces:[31,18,17,0,17,18,3,20,2,18,11,10,29,27,8,27,29,1,0,18,10,10,29,0,16,19,26,11,2,1,20,30,4,20,3,15,30,12,4,4,12,5,5,27,4,4,27,20,21,25,5,7,8,25,22,7,14,7,25,14,23,28,31,0,7,17,24,26,9,31,28,9,8,27,5,2,20,1,13,19,18,10,11,1,19,13,26,3,11,19,19,16,3,11,3,2,11,18,19,20,15,30,29,10,1,25,21,14,8,5,25,5,12,21,6,7,22,7,6,23,8,0,29,8,7,0,23,31,7,13,31,9,18,31,13,9,28,24,26,13,9,27,1,20,7,31,17]},{type:'mesh',vertices:[-217,34,-153,198,90,20,212,85,169,-131,93,171,197,113,30,173,121,164,315,29,-16,219,24,189,282,50,-102,232,38,-181,-195,-9,-166,-156,30,-207,-51,-9,-231,-180,91,-173,-19,73,-204,-280,23,96,-242,100,107,3,158,-82,109,88,221,275,-10,-40,236,-10,-135,-178,49,184,-1,-10,-243,265,-11,109,-12,-9,237,-36,46,251,-233,86,-81,93,77,-171,-163,133,69,18,16,263,296,44,93,131,-12,-226,-89,-10,-201,-273,-10,-51,-240,-9,110,190,-12,192,-253,-11,-92,42,43,-258,-115,-11,238,168,99,-88,-285,-10,24,71,124,-158,298,-10,10,116,150,-24,-282,44,39],faces:[44,16,26,13,26,16,0,26,13,27,14,41,4,5,1,7,30,2,28,5,43,41,39,27,17,43,41,43,4,39,13,28,17,17,41,13,28,43,17,24,29,38,29,35,7,18,25,29,5,18,2,18,5,3,30,42,6,30,35,23,19,20,8,8,20,9,9,39,8,1,30,8,31,37,9,11,14,37,14,27,37,32,11,12,11,37,12,11,0,13,33,40,44,44,26,33,33,0,36,34,38,15,44,40,15,21,3,16,27,39,9,2,30,1,21,25,3,16,3,28,28,3,5,4,43,5,41,43,39,13,16,28,25,21,38,38,29,25,7,18,29,29,24,35,18,7,2,18,3,25,30,23,42,30,7,35,8,30,6,6,19,8,6,42,19,8,39,1,37,31,22,27,9,37,9,20,31,10,11,32,11,10,0,12,37,22,14,13,41,14,11,13,33,26,0,36,0,10,21,44,15,16,44,21,15,40,34,38,21,15,4,1,39,5,2,1]},{type:'mesh',vertices:[-101,102,57,99,35,102,40,72,80,59,14,-168,-186,22,45,-176,25,-30,66,-7,146,153,-7,53,-110,47,-96,-90,-8,-146,150,-7,-12,-200,-7,8,-173,-7,-55,55,46,-60,125,-7,110,136,30,-10,-149,58,68,-15,82,-71,98,-7,-86,-34,-6,-194,-33,-7,171,-36,65,137,38,-8,-192,-103,-9,147,-12,62,-152],faces:[2,17,0,17,8,0,17,24,8,19,24,22,5,11,4,2,13,17,17,13,24,21,23,20,1,2,21,7,15,1,7,10,15,5,9,12,15,18,13,0,5,16,0,8,5,1,15,2,10,18,15,3,13,18,24,3,22,11,23,4,4,16,5,16,4,23,24,13,3,15,13,2,6,1,21,6,21,20,6,14,1,2,0,21,1,14,7,3,18,22,8,24,19,8,19,9,12,11,5,5,8,9,16,23,21,16,21,0]},{type:'mesh',vertices:[86,55,-18,58,38,73,97,-12,79,135,7,10,-93,-11,-72,-133,5,33,13,68,-32,94,-11,-57,-90,52,53,-24,-11,-106,-13,-10,104,-75,49,-69,-12,18,114,49,-12,-96,-46,-11,-85,-119,-11,-26,48,5,-111,-58,-11,105,-117,-12,52,-5,35,-93,123,-11,7],faces:[5,8,11,2,3,1,8,1,6,11,8,6,6,19,11,10,12,17,20,7,3,3,7,16,16,0,3,16,9,19,14,4,9,15,18,5,5,11,15,18,17,5,19,0,16,1,3,0,0,6,1,19,6,0,12,8,17,2,1,12,12,10,2,1,8,12,3,2,20,16,13,9,16,7,13,19,4,11,15,11,4,17,8,5,9,4,19]}],torii:[{type:'mesh',mirror:!0,flatShading:!0,vertices:[692,966,-52,661,834,-52,692,966,52,661,834,52,0,894,-52,0,776,-52,0,894,52,0,776,52,518,935,52,345,913,52,170,899,52,162,779,52,328,790,52,494,808,52,170,899,-52,345,913,-52,518,935,-52,494,808,-52,328,790,-52,162,779,-52,0,618,16,0,697,16,0,618,-16,0,697,-16,586,618,16,586,697,16,586,618,-16,586,697,-16,331,-29,-75,331,766,-52,369,-29,-65,357,766,-45,396,-29,-37,377,766,-26,406,-29,0,384,766,0,396,-29,37,377,766,26,369,-29,65,357,766,45,331,-29,75,331,766,52,294,-29,65,305,766,45,267,-29,37,286,766,26,257,-29,0,279,766,0,267,-29,-37,286,766,-26,294,-29,-65,305,766,-45,0,777,85,0,681,33,333,762,-75,333,806,-75,371,762,-65,371,806,-65,398,762,-37,398,806,-37,408,762,0,408,806,0,398,762,37,398,806,37,371,762,65,371,806,65,333,762,75,333,806,75,296,762,65,296,806,65,268,762,37,268,806,37,258,762,0,258,806,0,268,762,-37,268,806,-37,296,762,-65,296,806,-65,0,681,-33,0,777,-85,52,681,33,52,777,85,52,681,-33,52,777,-85],faces:[4,10,14,1,13,17,11,6,7,0,3,1,16,1,17,4,19,5,14,18,19,15,17,18,3,8,13,13,9,12,12,10,11,19,7,5,19,12,11,18,13,12,16,2,0,15,8,16,14,9,15,23,26,22,27,24,26,25,20,24,26,20,22,23,25,27,29,30,28,31,32,30,33,34,32,35,36,34,37,38,36,39,40,38,41,42,40,43,44,42,45,46,44,47,48,46,49,50,48,51,28,50,55,56,54,57,58,56,59,60,58,61,62,60,63,64,62,79,81,83,65,66,64,82,53,78,67,68,66,81,53,80,69,70,68,83,80,82,71,72,70,79,82,78,73,74,72,75,63,59,75,76,74,77,54,76,60,68,76,4,6,10,1,3,13,11,10,6,0,2,3,16,0,1,4,14,19,14,15,18,15,16,17,3,2,8,13,8,9,12,9,10,19,11,7,19,18,12,18,17,13,16,8,2,15,9,8,14,10,9,23,27,26,27,25,24,25,21,20,26,24,20,23,21,25,29,31,30,31,33,32,33,35,34,35,37,36,37,39,38,39,41,40,41,43,42,43,45,44,45,47,46,47,49,48,49,51,50,51,29,28,55,57,56,57,59,58,59,61,60,61,63,62,63,65,64,79,52,81,65,67,66,82,80,53,67,69,68,81,52,53,69,71,70,83,81,80,71,73,72,79,83,82,73,75,74,59,57,55,55,77,75,75,73,71,71,69,75,67,65,63,63,61,59,59,55,75,75,69,67,67,63,75,75,77,76,77,55,54,76,54,56,56,58,76,60,62,68,64,66,68,68,70,72,72,74,68,76,58,60,62,64,68,68,74,76]}],hexagons:[{type:'extrude',vertices:[-0.198,-0.302,0.197,-0.3,0.372,0,0.199,0.298,-0.202,0.298,-0.368,0]}],towers:[{type:'extrude',vertices:[-0.054,-0.178,-0.007,-0.182,0.069,-0.027,0.189,0.079,0.178,0.124,-0.007,0.097,-0.145,0.182,-0.178,0.144,-0.079,-0.021]},{type:'lathe',segments:4,vertices:[0.004,0.02,0.012,0.092,0.042,0.166,0.067,0.55,0.101,0.594,0.105,0.838,0.193,0.934,0.18,0.994]},{type:'lathe',segments:5,vertices:[0.069,0.216,0.067,0.562,0.126,0.562,0.128,0.774,0.191,0.774,0.193,0.986]}],trees:[{type:'lathe',noise:0.015,segments:6,vertices:[0.004,0.826,0.054,0.832,0.105,0.854,0.136,0.9,0.136,0.958,0.118,0.994]},{type:'lathe',noise:0.015,segments:14,vertices:[0.004,0.01,0.069,0.022,0.13,0.068,0.178,0.18,0.189,0.32,0.191,0.59,0.193,0.75,0.138,0.79,0.018,0.808,0.018,0.996]},{type:'lathe',noise:0.015,segments:14,vertices:[0.002,0.436,0.126,0.46,0.201,0.57,0.219,0.72,0.154,0.846,0.028,0.884,0.034,0.996]}],apparatus:[{type:'lathe',segments:10,vertices:[0.004,0.23,0.042,0.23,0.069,0.36,0.038,0.362,0.038,0.372,0.06,0.372,0.073,0.572,0.024,0.572,0.024,0.67,0.069,0.67,0.075,0.722,0.097,0.724,0.105,0.852,0.083,0.902,0.065,0.902,0.065,0.924,0.128,0.924,0.146,0.996]},{type:'lathe',segments:16,vertices:[0.001,0.232,0.229,0.182,0.486,0.07,0.356,0.182,0.213,0.242,0.154,0.242,0.144,0.262,0.178,0.262,0.126,0.314,0.04,0.328,0.038,0.374,0.058,0.374,0.071,0.408,0.026,0.406,0.03,0.42,0.091,0.418,0.034,0.496,0.01,0.498,0.03,0.506,0.014,0.998]}],mushrooms:[{type:'lathe',noise:0.02,segments:14,vertices:[0.001,0.006,0.13,0.018,0.341,0.084,0.437,0.144,0.492,0.234,0.484,0.246,0.276,0.232,0.107,0.284,0.046,0.346,0.062,0.852,0.097,0.956,0.166,0.998]},{type:'lathe',noise:0.02,segments:10,vertices:[0.001,0.562,0.091,0.572,0.172,0.61,0.223,0.666,0.256,0.74,0.258,0.806,0.246,0.824,0.062,0.826,0.065,0.948,0.097,0.998]},{type:'lathe',noise:0.02,segments:10,vertices:[0.001,0.768,0.099,0.772,0.219,0.802,0.306,0.844,0.352,0.886,0.352,0.908,0.118,0.904,0.107,0.93,0.115,0.966,0.14,0.996]}]},this.assets)for(var t=0,i;t<this.assets[e].length;t++)if(i=this.assets[e][t],'mesh'==i.type)for(var a=0,n=i.vertices.length;a<n;a++)i.vertices[a]/=1e3;this.userFog=this.el.sceneEl.getAttribute('fog'),this.sky=document.createElement('a-sky'),this.sky.setAttribute('radius',200),this.sky.setAttribute('segments-height',6),this.sky.setAttribute('segments-width',6),this.sky.setAttribute('material','side','double'),this.stars=null,this.ground=document.createElement('a-entity'),this.ground.setAttribute('rotation','-90 0 0'),this.ground.classList.add('environmentGround'),this.groundGeometry=null,this.dressing=document.createElement('a-entity'),this.el.appendChild(this.ground),this.el.appendChild(this.dressing),this.el.appendChild(this.sky)},getFogColor:function(e,t){var n;if('color'==e||'none'==e)n=new THREE.Color(this.data.skyColor);else if('gradient'==e)n=new THREE.Color(this.data.horizonColor);else if('atmosphere'==e){var r=[1,0.5,0.22,0.1,0.05,0],s=['#C0CDCF','#81ADC5','#525e62','#2a2d2d','#141616','#000'];if(0>=t)return'#000';t=o(1,t);for(var l=0;l<r.length;l++)if(t>r[l]){var i=new THREE.Color(s[l-1]),d=new THREE.Color(s[l]),c=(t-r[l])/(r[l-1]-r[l]);d.lerp(i,c),n=d;break}}return n.multiplyScalar(0.9),n.lerp(new THREE.Color(this.data.groundColor),0.3),'#'+n.getHexString()},update:function(e){if(!e||void 0===e.preset||e.preset!==this.data.preset){var t=Object.assign({},this.presets[this.data.preset]);e&&void 0!==e.preset||Object.assign(t,this.el.components['super-environment'].attrValue),this.el.setAttribute('super-environment',t)}var i=this.data.skyType,a=new THREE.Vector3(this.data.lightPosition.x,this.data.lightPosition.y,this.data.lightPosition.z);if(a.normalize(),this.sunlight){if(this.sunlight.setAttribute('position',this.data.lightPosition),'atmosphere'!=i){var n=new THREE.Color(this.data.skyColor);n.r=(n.r+1)/2,n.g=(n.g+1)/2,n.b=(n.b+1)/2,this.hemilight.setAttribute('light',{color:'#'+n.getHexString()}),this.sunlight.setAttribute('light',{intensity:0.6}),this.hemilight.setAttribute('light',{intensity:0.6})}else this.sunlight.setAttribute('light',{intensity:0.1+0.5*a.y}),this.hemilight.setAttribute('light',{intensity:0.1+0.5*a.y});this.sunlight.setAttribute('light',{castShadow:this.data.shadow,shadowCameraLeft:-this.data.shadowSize,shadowCameraBottom:-this.data.shadowSize,shadowCameraRight:this.data.shadowSize,shadowCameraTop:this.data.shadowSize})}if(i!=e.skyType||this.data.skyColor!=e.skyColor||this.data.horizonColor!=e.horizonColor){this.sky.removeAttribute('material');var o={side:'double'};o.shader={none:'flat',color:'flat',gradient:'super-gradientshader',atmosphere:'super-skyshader'}[i],this.stars&&this.stars.setAttribute('visible','atmosphere'==i),'color'==i?(o.color=this.data.skyColor,o.fog=!1):'gradient'==i&&(o.topColor=this.data.skyColor,o.bottomColor=this.data.horizonColor),this.sky.setAttribute('material',o)}'atmosphere'==i&&(this.sky.setAttribute('material',{sunPosition:a}),this.setStars(2e3*(1-l(0,8*(a.y+0.08))))),0<this.data.fog?this.el.sceneEl.setAttribute('fog',{color:this.getFogColor(i,a.y),far:250}):this.el.sceneEl.removeAttribute('fog'),this.data.lighting!==e.lighting&&(this.sunlight&&(this.sunlight.setAttribute('light',{type:'point'==this.data.lighting?'point':'directional'}),this.sunlight.setAttribute('visible','none'!==this.data.lighting)),this.hemilight&&this.hemilight.setAttribute('visible','none'!==this.data.lighting));var r=!this.groundGeometry||this.data.seed!=e.seed||this.data.ground!=e.ground||this.data.playArea!=e.playArea||this.data.flatShading!=e.flatShading;(r||this.data.groundColor!=e.groundColor||this.data.groundColor2!=e.groundColor2||this.data.groundYScale!=e.groundYScale||this.data.groundTexture!=e.groundTexture||this.data.gridColor!=e.gridColor||this.data.grid!=e.grid)&&(this.updateGround(r),this.hemilight&&this.hemilight.setAttribute('light',{groundColor:this.data.groundColor})),(this.data.seed!=e.seed||this.data.dressingOnPlayArea!=e.dressingOnPlayArea||this.data.dressing!=e.dressing||this.data.flatShading!=e.flatShading||this.data.dressingAmount!=e.dressingAmount||this.data.dressingScale!=e.dressingScale||this.data.dressingColor!=e.dressingColor||this.data.dressingVariance.x!=e.dressingVariance.x||this.data.dressingVariance.y!=e.dressingVariance.y||this.data.dressingVariance.z!=e.dressingVariance.z||this.data.dressingUniformScale!=e.dressingUniformScale)&&this.updateDressing(),this.sky.setAttribute('visible','none'!==i),this.el.setAttribute('visible',this.data.active),this.data.active||(this.userFog?this.el.sceneEl.setAttribute('fog',this.userFog):this.el.sceneEl.removeAttribute('fog')),this.dumpParametersDiff()},logPreset:function(){var e='{';for(var t in this.schema)if('preset'!=t){e+=t+': ';var i=this.schema[t].type;e+='vec3'==i?'{ x: '+this.data[t].x+', y: '+this.data[t].y+', z: '+this.data[t].z+'}':'string'==i||'color'==i?'"'+this.data[t]+'"':this.data[t],e+=', '}e+='}',console.log(e)},dumpParametersDiff:function(){function e(e){return n(1e3*e)/1e3}var t=[],a='none'!=this.data.preset&&this.presets[this.data.preset];for(var o in a&&t.push('preset: '+this.data.preset),this.schema)if(!('preset'==o||a&&void 0===a[o])){var i=a?a[o]:this.schema[o].default,r=this.data[o],s=this.schema[o].type;if('vec3'==s){var l=i;'string'==typeof i&&(i=i.split(' '),l={x:i[0],y:i[1],z:i[2]}),(e(l.x)!=e(r.x)||e(l.y)!=e(r.y)||e(l.z)!=e(r.z))&&t.push(o+': '+e(r.x)+' '+e(r.y)+' '+e(r.z))}else i!=r&&('number'==this.schema[o].type&&(r=e(r)),t.push(o+': '+r))}},random:function(e){return parseFloat('0.'+a(9999*this.data.seed*e).toString().substr(7))},updateGround:function(a){var n=16;if(a){var s='none'!=this.data.ground;if(this.ground.setAttribute('visible',s),!s)return;this.groundGeometry||(this.groundGeometry=new THREE.PlaneGeometry(this.STAGE_SIZE+2,this.STAGE_SIZE+2,n-1,n-1));for(var c=new d,u=this.groundGeometry.vertices,p=this.groundGeometry.vertices.length,g=10,m=g/n,b=0,i=0,f=0;b<p;b++){if('flat'==this.data.ground){u[b].z=0;continue}var y;switch(this.data.ground){case'hills':{y=l(0,c.noise(i,f,0));break}case'canyon':{y=0.2+0.8*c.noise(i,f,0),y=o(1,10*Math.pow(y,2));break}case'spikes':{y=0.02>this.random(b)?this.random(b+1):0;break}case'noise':{y=0.35>this.random(b)?this.random(b+1):0;break}}y+=0.1*this.random(b+2);var h=2*i/g-1,v=2*f/g-1,E=this.data.playArea;h=l(0,o(1,(t(h)-(E-0.9))*(1/E))),v=l(0,o(1,(t(v)-(E-0.9))*(1/E))),y*=h>v?h:v,u[b].z=y,i+=m,10<=i&&(i=0,f+=m)}this.groundGeometry.computeFaceNormals(),this.data.flatShading?this.groundGeometry.computeFlatVertexNormals():this.groundGeometry.computeVertexNormals(),this.groundGeometry.verticesNeedUpdate=!0,this.groundGeometry.normalsNeedUpdate=!0}this.ground.setAttribute('scale',{z:this.data.groundYScale});var x=2048,S=20,C=this.STAGE_SIZE/S,A=e(this.data);if(!(A in r)){var T=document.createElement('canvas');T.width=x,T.height=x;var D=new THREE.Texture(T);D.wrapS=THREE.RepeatWrapping,D.wrapT=THREE.RepeatWrapping,D.repeat.set(C,C);var I=document.createElement('canvas');I.width=x,I.height=x;var j=new THREE.Texture(I);j.wrapS=THREE.RepeatWrapping,j.wrapT=THREE.RepeatWrapping,j.repeat.set(C,C);var w=new THREE.MeshLambertMaterial({map:j,emissive:new THREE.Color(16777215),emissiveMap:D});this.data.flatShading&&(w.flatShading=!0);var k=I.getContext('2d'),L=T.getContext('2d');this.drawTexture(k,x,S),L.fillStyle='#000000',L.fillRect(0,0,x,x),this.drawGrid(L,x,S),j.needsUpdate=!0,D.needsUpdate=!0,r[A]=w}var w=r[A];if(a){var M=new THREE.Mesh(this.groundGeometry,w);this.ground.setObject3D('mesh',M)}else this.ground.getObject3D('mesh').material=w;this.ground.setAttribute('shadow',{cast:!1,receive:this.data.shadow})},drawGrid:function(e,t,a){if('none'!=this.data.grid){var o=n(a/2),r=t/(a/2),d,i,c;switch(e.fillStyle=this.data.gridColor,this.data.grid){case'1x1':case'2x2':{for('1x1'==this.data.grid&&(o*=2,r=t/a),d=0;d<o;d++)c=n(d*r),e.fillRect(0,c,t,1),e.fillRect(c,0,1,t);break}case'crosses':{var u=n(r/20);for(d=0;d<o+1;d++)for(c=n(d*r),i=0;i<o+1;i++){var p=n(-u+i*r);e.fillRect(p,c,2*u,1),e.fillRect(c,p,1,2*u)}break}case'dots':{for(d=0;d<o+1;d++)for(i=0;i<o+1;i++)e.beginPath(),e.arc(n(i*r),n(d*r),4,0,2*s),e.fill();break}case'xlines':{for(d=0;d<o;d++)e.fillRect(n(d*r),0,1,t);break}case'ylines':{for(d=0;d<o;d++)e.fillRect(0,n(d*r),t,1);break}}}},drawTexture:function(e,t,a){e.fillStyle=this.data.groundColor,e.fillRect(0,0,t,t);var o,i,r,l,c,u,p;if('none'!=this.data.groundTexture)switch(this.data.groundTexture){case'checkerboard':{e.fillStyle=this.data.groundColor2;var g=n(a/2),m=t/(a/2);for(o=0;o<g+1;o+=2)for(var h=0;h<g+1;h++)e.fillRect(n((o+h%2)*m),n(h*m),n(m),n(m));break}case'squares':{var b=16,y=t/b;for(r=new THREE.Color(this.data.groundColor),l=new THREE.Color(this.data.groundColor2),o=0;o<b*b;o++)i=0.5<this.random(o+3)?r.clone():l.clone(),i.addScalar(0.1*this.random(o+3)-0.05),e.fillStyle='#'+i.getHexString(),e.fillRect(o%b*y,n(o/b)*y,y,y);break}case'noise':{u=e.getImageData(0,0,t,t),c=u.data,r=new THREE.Color(this.data.groundColor),l=new THREE.Color(this.data.groundColor2);var f=new THREE.Color(l.r-r.r,l.g-r.g,l.b-r.b),v=new d;for(o=0,h=0,p=c.length;o<p;o+=4,h++){var E=v.noise(3*(h%t/t),3*(h/t/t),0);c[o+0]=n(255*(r.r+f.r*E)),c[o+1]=n(255*(r.g+f.g*E)),c[o+2]=n(255*(r.b+f.b*E))}e.putImageData(u,0,0);break}case'walkernoise':{var x=n(t/2),s=document.createElement('canvas');s.width=x,s.height=x;var S=s.getContext('2d');S.fillStyle=this.data.groundColor,S.fillRect(0,0,x,x),u=S.getImageData(0,0,x,x),c=u.data,r=new THREE.Color(this.data.groundColor),l=new THREE.Color(this.data.groundColor2);var C=[],A=1e3;for(o=0;o<A;o++)i=r.clone().lerp(l,Math.random()),C.push({x:Math.random()*x,y:Math.random()*x,r:n(255*i.r),g:n(255*i.g),b:n(255*i.b)});for(var T=0;T<5e3;T++)for(o=0;o<A;o++){var D=C[o],I=4*n(D.y*x+D.x);c[I+0]=D.r,c[I+1]=D.g,c[I+2]=D.b,D.x+=n(3*Math.random())-1,D.y+=n(3*Math.random())-1,D.x>=x&&(D.x-=x),D.y>=x&&(D.y-=x),0>D.x&&(D.x=x+D.x),0>D.y&&(D.y=x+D.y)}S.putImageData(u,0,0),e.drawImage(s,0,0,t,t);break}}},getAssetGeometry:function(e){function t(e,t){for(var a=new THREE.Vector3,n=0,i=e.vertices.length;n<i;n++)a.x=(o.random(n)-0.5)*t,a.y=(o.random(n+i)-0.5)*t,a.z=(o.random(n+2*i)-0.5)*t,e.vertices[n].add(a)}if(!e)return null;for(var a=[],o=this,n=0,r,i,l;n<e.length;n++)if('lathe'==e[n].type){var d=-99999,c=[];for(l=e[n].vertices,r=0;r<l.length;r+=2)c.push(new THREE.Vector2(l[r],l[r+1])),l[r+1]>d&&(d=l[r+1]);i=new THREE.LatheGeometry(c,e[n].segments||8),i.applyMatrix(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-s,0,0))),i.applyMatrix(new THREE.Matrix4().makeTranslation(0,d,0)),e[n].noise&&t(i,e[n].noise),a.push(i)}else if('extrude'==e[n].type){var u=new THREE.Shape;for(l=e[n].vertices,r=0;r<l.length;r+=2)0==r?u.moveTo(l[r],l[r+1]):u.lineTo(l[r],l[r+1]);i=new THREE.ExtrudeGeometry(u,{amount:1,bevelEnabled:!1}),i.applyMatrix(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-s/2,0,0))),e[n].noise&&t(i,e[n].noise),a.push(i)}else if('mesh'==e[n].type){i=new THREE.Geometry,l=e[n].vertices;for(var p=e[n].faces,g=0;g<l.length;g+=3)i.vertices.push(new THREE.Vector3(l[g],l[g+1],l[g+2]));for(var m=0;m<p.length;m+=3)i.faces.push(new THREE.Face3(p[m],p[m+1],p[m+2]));this.data.flatShading||e[n].flatShading?i.computeFaceNormals():i.computeVertexNormals(),e[n].mirror&&i.merge(i,new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(0,s,0))),e[n].noise&&t(i,e[n].noise),a.push(i)}return a},updateDressing:function(){var e=new THREE.Object3D;if(this.dressing.setAttribute('visible','none'!=this.data.dressing),'none'!=this.data.dressing){var t=new THREE.Geometry,o;switch(this.data.dressing){case'cubes':{o=[new THREE.BoxGeometry(1,1,1)],o[0].applyMatrix(new THREE.Matrix4().makeTranslation(0,0.5,0));break}case'pyramids':{o=[new THREE.ConeGeometry(1,1,4,1,!0)],o[0].applyMatrix(new THREE.Matrix4().makeTranslation(0,0.5,0));break}case'cylinders':{o=[new THREE.CylinderGeometry(0.5,0.5,1,8,1,!0)],o[0].applyMatrix(new THREE.Matrix4().makeTranslation(0,0.5,0));break}default:{if(o=this.getAssetGeometry(this.assets[this.data.dressing]),!o)return;break}}for(var d=0,i=88343;d<this.data.dressingAmount;d++,i++){var r=o[n(this.random(33+d)*o.length)],c=this.data.dressingScale,u=new THREE.Vector3(this.data.dressingVariance.x,this.data.dressingVariance.y,this.data.dressingVariance.z),p=this.random(i)<this.data.dressingOnPlayArea,g;g=p?15*this.random(i+1):10+l(u.x,u.z)+10*this.random(i+1)+this.random(i+2)*this.STAGE_SIZE/3;var m=2*(this.random(i+3)*s),h=new THREE.Matrix4,b=this.random(i+4),y=this.data.dressingUniformScale;h.compose(new THREE.Vector3(Math.cos(m)*g,0,a(m)*g),new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),2*((this.random(i+5)-0.5)*u.length()*s)),new THREE.Vector3(c+(y?b:this.random(i+6))*u.x,c+(y?b:this.random(i+7))*u.y,c+(y?b:this.random(i+8))*u.z)),t.merge(r,h)}var f=new THREE.BufferGeometry;f.fromGeometry(t);var v=new THREE.MeshLambertMaterial({color:new THREE.Color(this.data.dressingColor),vertexColors:THREE.VertexColors});this.data.flatShading&&f.computeVertexNormals();var E=new THREE.Mesh(f,v);e.add(E),this.dressing.setObject3D('mesh',e)}},createStars:function(){for(var e=new THREE.BufferGeometry,t=new Float32Array(3*2e3),a=this.STAGE_SIZE-1,n=new THREE.Vector3,o=0;o<t.length;o+=3)n.set(this.random(o+23)-0.5,this.random(o+24),this.random(o+25)-0.5),n.normalize(),n.multiplyScalar(a),t[o]=n.x,t[o+1]=n.y,t[o+2]=n.z;e.addAttribute('position',new THREE.BufferAttribute(t,3)),e.setDrawRange(0,0);var i=new THREE.PointsMaterial({size:0.01,color:13421772,fog:!1});this.stars.setObject3D('mesh',new THREE.Points(e,i))},setStars:function(e){this.stars||(this.stars=document.createElement('a-entity'),this.stars.id='stars',this.createStars(),this.el.appendChild(this.stars)),e=n(o(2e3,l(0,e))),this.stars.getObject3D('mesh').geometry.setDrawRange(0,e)}}),AFRAME.registerShader('super-skyshader',{schema:{luminance:{type:'number',default:1,min:0,max:2,is:'uniform'},turbidity:{type:'number',default:2,min:0,max:20,is:'uniform'},reileigh:{type:'number',default:1,min:0,max:4,is:'uniform'},mieCoefficient:{type:'number',default:5e-3,min:0,max:0.1,is:'uniform'},mieDirectionalG:{type:'number',default:0.8,min:0,max:1,is:'uniform'},sunPosition:{type:'vec3',default:{x:0,y:0,z:-1},is:'uniform'},color:{type:'color',default:'#fff'}},vertexShader:'varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}',fragmentShader:'uniform sampler2D skySampler;\nuniform vec3 sunPosition;\nvarying vec3 vWorldPosition;\nvec3 cameraPos = vec3(0., 0., 0.);\nuniform float luminance;\nuniform float turbidity;\nuniform float reileigh;\nuniform float mieCoefficient;\nuniform float mieDirectionalG;\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\nconst float pi = 3.141592653589793238462643383279502884197169;\nconst float n = 1.0003;\nconst float N = 2.545E25;\nconst float pn = 0.035;\nconst vec3 lambda = vec3(680E-9, 550E-9, 450E-9);\nconst vec3 K = vec3(0.686, 0.678, 0.666);\nconst float v = 4.0;\nconst float rayleighZenithLength = 8.4E3;\nconst float mieZenithLength = 1.25E3;\nconst vec3 up = vec3(0.0, 1.0, 0.0);\nconst float EE = 1000.0;\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\nconst float cutoffAngle = pi/1.95;\nconst float steepness = 1.5;\nvec3 totalRayleigh(vec3 lambda)\n{\nreturn (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));\n}\nvec3 simplifiedRayleigh()\n{\nreturn 0.0005 / vec3(94, 40, 18);\n}\nfloat rayleighPhase(float cosTheta)\n{   \nreturn (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));\n}\nvec3 totalMie(vec3 lambda, vec3 K, float T)\n{\nfloat c = (0.2 * T ) * 10E-18;\nreturn 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;\n}\nfloat hgPhase(float cosTheta, float g)\n{\nreturn (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));\n}\nfloat sunIntensity(float zenithAngleCos)\n{\nreturn EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));\n}\n// Filmic ToneMapping http://filmicgames.com/archives/75\nfloat A = 0.15;\nfloat B = 0.50;\nfloat C = 0.10;\nfloat D = 0.20;\nfloat E = 0.02;\nfloat F = 0.30;\nfloat W = 1000.0;\nvec3 Uncharted2Tonemap(vec3 x)\n{\nreturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\nvoid main() \n{\nfloat sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);\nfloat reileighCoefficient = reileigh - (1.0* (1.0-sunfade));\nvec3 sunDirection = normalize(sunPosition);\nfloat sunE = sunIntensity(dot(sunDirection, up));\nvec3 betaR = simplifiedRayleigh() * reileighCoefficient;\nvec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;\nfloat zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));\nfloat sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));\nfloat sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));\nvec3 Fex = exp(-(betaR * sR + betaM * sM));\nfloat cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);\nfloat rPhase = rayleighPhase(cosTheta*0.5+0.5);\nvec3 betaRTheta = betaR * rPhase;\nfloat mPhase = hgPhase(cosTheta, mieDirectionalG);\nvec3 betaMTheta = betaM * mPhase;\nvec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));\nLin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));\nvec3 direction = normalize(vWorldPosition - cameraPos);\nfloat theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]\nfloat phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]\nvec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);\nvec3 L0 = vec3(0.1) * Fex;\nfloat sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);\nL0 += (sunE * 19000.0 * Fex)*sundisk;\nvec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));\nvec3 texColor = (Lin+L0);   \ntexColor *= 0.04 ;\ntexColor += vec3(0.0,0.001,0.0025)*0.3;\nfloat g_fMaxLuminance = 1.0;\nfloat fLumScaled = 0.1 / luminance;     \nfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); \nfloat ExposureBias = fLumCompressed;\nvec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);\nvec3 color = curr*whiteScale;\nvec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));\ngl_FragColor.rgb = retColor;\ngl_FragColor.a = 1.0;\n}'}),AFRAME.registerShader('super-gradientshader',{schema:{topColor:{type:'color',default:'1 0 0',is:'uniform'},bottomColor:{type:'color',default:'0 0 1',is:'uniform'}},vertexShader:'varying vec3 vWorldPosition;\nvoid main() {\n vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n vWorldPosition = worldPosition.xyz;\n gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );\n}',fragmentShader:'uniform vec3 bottomColor;\nuniform vec3 topColor;\nuniform float offset;\nvarying vec3 vWorldPosition;\nvoid main() {\n float h = normalize( vWorldPosition ).y;\n gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max(h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );\n}'});var d=function(e){e==void 0&&(e=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];var t;for(t=0;256>t;t++)this.p[t]=n(256*e.random(666));for(this.perm=[],t=0;512>t;t++)this.perm[t]=this.p[255&t]};d.prototype.dot=function(e,t,i,a){return e[0]*t+e[1]*i+e[2]*a},d.prototype.mix=function(e,i,a){return(1-a)*e+a*i},d.prototype.fade=function(e){return e*e*e*(e*(6*e-15)+10)},d.prototype.noise=function(e,t,i){var a=n(e),o=n(t),r=n(i);e-=a,t-=o,i-=r,a&=255,o&=255,r&=255;var s=this.perm[a+this.perm[o+this.perm[r]]]%12,l=this.perm[a+this.perm[o+this.perm[r+1]]]%12,d=this.perm[a+this.perm[o+1+this.perm[r]]]%12,c=this.perm[a+this.perm[o+1+this.perm[r+1]]]%12,p=this.perm[a+1+this.perm[o+this.perm[r]]]%12,g=this.perm[a+1+this.perm[o+this.perm[r+1]]]%12,m=this.perm[a+1+this.perm[o+1+this.perm[r]]]%12,h=this.perm[a+1+this.perm[o+1+this.perm[r+1]]]%12,b=this.dot(this.grad3[s],e,t,i),y=this.dot(this.grad3[p],e-1,t,i),f=this.dot(this.grad3[d],e,t-1,i),E=this.dot(this.grad3[m],e-1,t-1,i),x=this.dot(this.grad3[l],e,t,i-1),S=this.dot(this.grad3[g],e-1,t,i-1),C=this.dot(this.grad3[c],e,t-1,i-1),A=this.dot(this.grad3[h],e-1,t-1,i-1),T=this.fade(e),u=this.fade(t),v=this.fade(i),D=this.mix(b,y,T),I=this.mix(x,S,T),j=this.mix(f,E,T),w=this.mix(C,A,T),k=this.mix(D,j,u),L=this.mix(I,w,u),M=this.mix(k,L,v);return M}},function(e,t,i){var a=i(32).SHAPES;a=AFRAME.utils.clone(a),AFRAME.registerGeometry('sinTube',{schema:{radius:{default:1},scale:{default:1}},init:function(){function e(e){THREE.Curve.call(this),this.scale=void 0===e?1:e}return e.prototype=Object.create(THREE.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=function(e){var t=Math.sin(2*Math.PI*e);return new THREE.Vector3(3*e-1.5,t,0).multiplyScalar(this.scale)},function(t){this.geometry=new THREE.TubeGeometry(new e(t.scale),10,t.radius,6,!1)}}()}),AFRAME.registerGeometry('trianglePrism',{schema:{thickness:{default:1},sideLength:{default:1}},init:function(){function e(e,i){var a,n;n=[new THREE.Vector2(-0.5,-0.5).multiplyScalar(e),new THREE.Vector2(0.5,-0.5).multiplyScalar(e),new THREE.Vector2(0.5,0.5).multiplyScalar(e)],a=new THREE.Shape,function(e){e.moveTo(n[0].x,n[0].y);for(var t=1;t<n.length;t++)e.lineTo(n[t].x,n[t].y);e.lineTo(n[0].x,n[0].y)}(a),t.amount=i,THREE.ExtrudeGeometry.call(this,a,t)}var t;return t={height:1,bevelEnabled:!1},e.prototype=Object.create(THREE.ExtrudeGeometry.prototype),function(t){this.geometry=new e(t.sideLength,t.height)}}()}),AFRAME.registerComponent('super-geometry',{schema:{type:{type:'string'}},update:function(){var e=this.el;if(a[this.data.type])switch(a[this.data.type].buffer=!1,a[this.data.type].skipCache=!0,delete a[this.data.type].legacy,e.setAttribute('geometry',a[this.data.type],!0),this.data.type){case'semicylinder':{e.getObject3D('mesh').geometry.translate(0,0,0.05);break}case'semicylinder2':{e.getObject3D('mesh').geometry.translate(0,0,0.05);break}case'semisphere':{e.getObject3D('mesh').geometry.translate(0,0,-0.05);break}case'semisphere2':{e.getObject3D('mesh').geometry.translate(0,-0.05,0);break}case'semitorus':{e.getObject3D('mesh').geometry.translate(0,-0.05,0);break}case'semitorus2':{e.getObject3D('mesh').geometry.translate(0,-0.05,0);break}case'quartertorus':{e.getObject3D('mesh').geometry.translate(-0.05,-0.06,0);break}case'quartertorus2':{e.getObject3D('mesh').geometry.translate(-0.05,-0.06,0);break}case'triangleprism':{e.getObject3D('mesh').geometry.translate(0,0,-0.05);break}}}})},function(e,t,i){function a(e,t){return e.getObject3D('mesh')?void t(e.getObject3D('mesh')):void e.addEventListener('object3dset',function i(a){'mesh'!==a.detail.type||(e.removeEventListener('object3dset',i),t(e.getObject3D('mesh')))})}i(13),i(30);var n={};n.menuIcon=new THREE.CanvasTexture(function(e,t){var i,a,n;return i=document.createElement('canvas'),i.setAttribute('height','1024'),i.setAttribute('width','1024'),i.setAttribute('id','menuIconsAtlas'),i.style.display='none',a=i.getContext('2d'),n=new Image,n.onload=()=>{a.drawImage(n,0,0,1024,1024),t(i)},n.src=e,i}('assets/img/menuIcons.svg',(e)=>{document.addEventListener('DOMContentLoaded',()=>{document.body.appendChild(e)}),n.menuIcon.needsUpdate=!0}));var o={faded:{type:'MeshPhongMaterial',emissive:'#333',emissiveIntensity:0.5,transparent:!0,opacity:0.65,flatShading:!0,vertexColors:THREE.FaceColors,side:THREE.DoubleSide},menuIcon:{type:'MeshBasicMaterial',flatShading:!0,transparent:!0,map:n.menuIcon,vertexColors:THREE.FaceColors,side:THREE.DoubleSide},phong:{type:'MeshPhongMaterial',emissive:'#333',emissiveIntensity:0.5,flatShading:!0,vertexColors:THREE.FaceColors,side:THREE.DoubleSide}},r={};AFRAME.registerSystem('super-material',{init:function(){var e,t;for(e in this.config=o,this.materials=r,o)t=o[e],r[e]=new THREE[t.type](t),r[e].shadowSide=THREE.BackSide}}),AFRAME.registerComponent('super-material',{schema:{color:{default:''},type:{default:'phong'}},init:function(){var e=this.data;a(this.el,(t)=>{t.material=r[e.type],this.setColor()}),this.el.addEventListener('componentchanged',(e)=>{'geometry'!==e.detail.name&&'slice9'!==e.detail.name||this.setColor()})},update:function(e){var t=this.data,i=this;e.type&&e.type!==t.type&&(this.el.getObject3D('mesh').material=r[t.type]),t.color&&e.color!==t.color&&a(this.el,()=>{this.setColor()})},setColor:function(){var e=this.data,t=this.el,i;e.color&&(i=t.getObject3D('mesh').geometry,-1===i.type.indexOf('BufferGeometry')?(t.removeAttribute('face-colors'),t.setAttribute('face-colors','baseColor',e.color)):(t.removeAttribute('vertex-colors-buffer'),setTimeout(()=>{t.setAttribute('vertex-colors-buffer','baseColor',e.color)})))}})},function(){var e=new THREE.Color;AFRAME.registerComponent('vertex-colors-buffer',{schema:{baseColor:{type:'color'},itemSize:{default:3}},update:function(t){var a=this.data,n=this.el,o=this,r,s,i,l;if(l=this.el.getObject3D('mesh'),!l||!l.geometry)return void n.addEventListener('object3dset',function e(i){'mesh'!==i.detail.type||(n.removeEventListener('object3dset',e),o.update(t))});if(i=l.geometry,!i.attributes.position)return void console.warn('Geometry has no vertices',n);for(i.attributes.color||i.addAttribute('color',new THREE.BufferAttribute(new Float32Array(i.attributes.position.array.length),3)),r=i.attributes.color.array,e.set(a.baseColor),s=0;s<r.length;s+=a.itemSize)r[s]=e.r,r[s+1]=e.g,r[s+2]=e.b;i.attributes.color.needsUpdate=!0}})},function(e,t){'use strict';t.a={labels:{when:{touched:['Touched']},then:{gotostate:['Go to state','${state}','over','${time}']}},defaultFieldValues:{when:{},then:{gotostate:['2',1000]}}}},function(e){var t=Math.PI;e.exports.SHAPES={box:{primitive:'box',depth:0.1,height:0.1,width:0.1,segmentsDepth:1,segmentsHeight:1,segmentsWidth:1},cone:{primitive:'cone',height:0.1,radiusBottom:0.05,radiusTop:1e-4,segmentsHeight:0,segmentsRadial:0,legacy:!0},cone2:{primitive:'cone',height:0.1,radiusBottom:0.05,radiusTop:1e-4,segmentsHeight:0,segmentsRadial:8},frustum:{primitive:'cone',height:0.05,radiusBottom:0.05,radiusTop:0.025,segmentsHeight:0,segmentsRadial:8},cylinder:{primitive:'cylinder',height:0.1,radius:0.1,segmentsHeight:0,segmentsRadial:0,legacy:!0},cylinder2:{primitive:'cylinder',height:0.1,radius:0.1,segmentsHeight:0,segmentsRadial:8},decagon:{detail:1,primitive:'tetrahedron',radius:0.1},dodecahedron:{primitive:'dodecahedron',radius:0.1},quartertorus:{arc:90,primitive:'torus',radius:0.1,radiusTubular:0.01,segmentsRadial:6,segmentsTubular:12,legacy:!0},quartertorus2:{arc:90,primitive:'torus',radius:0.1,radiusTubular:0.01,segmentsRadial:8,segmentsTubular:3},octahedron:{primitive:'octahedron',detail:0,radius:0.1},semicylinder:{primitive:'cylinder',height:0.1,radius:0.1,thetaLength:180,thetaStart:90,segmentsHeight:0,segmentsRadial:0,legacy:!0},semicylinder2:{primitive:'cylinder',height:0.1,radius:0.1,thetaLength:180,thetaStart:90,segmentsHeight:0,segmentsRadial:4},semisphere:{primitive:'sphere',segmentsHeight:6,segmentsWidth:6,radius:0.1,phiLength:180,legacy:!0},semisphere2:{primitive:'sphere',segmentsHeight:3,segmentsWidth:8,radius:0.1,thetaLength:90},semitorus:{arc:180,primitive:'torus',radius:0.1,radiusTubular:0.01,segmentsRadial:6,segmentsTubular:12},semitorus2:{arc:180,primitive:'torus',radius:0.1,radiusTubular:0.01,segmentsRadial:8,segmentsTubular:4},sinTube:{primitive:'sinTube',radius:0.03,scale:0.1},sphere:{primitive:'sphere',segmentsHeight:6,segmentsWidth:6,radius:0.1,legacy:!0},sphere2:{primitive:'sphere',segmentsHeight:6,segmentsWidth:8,radius:0.1},tetrahedron:{detail:0,primitive:'tetrahedron',radius:0.1},triangleprism:{primitive:'trianglePrism',height:0.1,sideLength:0.1},torus:{arc:360,primitive:'torus',radius:0.1,radiusTubular:0.01,segmentsRadial:8,segmentsTubular:8},torus2:{arc:360,primitive:'torus',radius:0.1,radiusTubular:0.01,segmentsRadial:8,segmentsTubular:8,legacy:!0}},e.exports.SHAPE_ROTATIONS={semicylinder:new THREE.Euler(t/2,0,0),semicylinder2:new THREE.Euler(t/2,0,0),semisphere:new THREE.Euler(-t/2,0,0),tetrahedron:new THREE.Euler(0,0,-t/4)}},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),i.d(t,'publishHandlers',function(){return n}),t.publishComputeState=function(e){e.siteNameText=e.isSitePublished?`${a}/${e.siteName}`:'(not yet published)',e.publishSiteButtonText=e.hasEntities?e.isSitePublishing?'Publishing...':e.isSitePublished?'Publish Update':'Publish Site':'Start Crafting to Publish!',e.isThingPublished=!!e.entityIndex[e.focusedEntityId]&&e.entityIndex[e.focusedEntityId].isPublished,e.publishThingButtonText=e.isThingPublishing?'Publishing...':e.isThingPublished?'Publish Update':'Publish Thing'};var a='supermedium.com/craft',n={sitepublishfail:function(e){e.isSitePublishing=!1},sitepublishstart:function(e){e.isSitePublishing=!0},sitepublishsuccess:function(e,t){e.isSitePublished?gtag('event','publishsiteupdate'):gtag('event','publishsitenew'),e.isSitePublished=!0,e.isSitePublishing=!1,e.siteName=t.name}}},function(e,t,i){'use strict';function a(e){var t,i,a;return i=e.entityIndex[e.stagedEntityId],t=e.scriptMenu.activeScript,a=i.attributes[`super-script__${t}`],a||(a=i.attributes[`super-script__${t}`]=o()),a}function n(e){for(var t in e.scriptMenu.panels)e.scriptMenu.panels[t]=!1}function o(){return{enabled:!1,when:[],then:[],in:0}}Object.defineProperty(t,'__esModule',{value:!0}),i.d(t,'scriptHandlers',function(){return s});var r=i(31),s={menubuttonpress:function(e,t){var i,a;switch(t.id){case'craftMenuScript':{for(a in e.scriptMode=!0,i=e.entities[e.stagedEntityId],i.shapes)delete i.shapes[a].attributes['data-staged'];e.dirtyEntityIds=Object.keys(i.shapes),e.focusedEntityId=e.stagedEntityId;break}case'scriptMenuBack':{for(a in e.scriptMenu.activeScript='1',e.scriptMenu.activeScriptState='default',n(e),e.scriptMode=!1,i=e.entities[e.stagedEntityId],i.shapes)i.shapes[a].attributes['data-staged']='';for(a in e.dirtyEntityIds=Object.keys(i.shapes),i.shapes){e.focusedEntityId=a;break}break}case'scriptMenuScript':{e.scriptMenu.activeScriptState='default';break}case'scriptMenuState':{n(e);break}}},scriptfieldgotostateselect:function(e,t){var i;i=a(e),i.then[e.scriptMenu.activeScriptLine.lineNumber][1]=t.state,e.scriptMenu.needsUpdate++,n(e)},scriptfieldpress:function(e,t){switch(n(e),e.scriptMenu.activeScriptLine.lineNumber=t.lineNumber,e.scriptMenu.activeScriptLine.type=t.scriptType,t.fieldType){case'state':{e.scriptMenu.panels.goToStateVisible=!0;break}}},scriptmenuadd:function(e,t){var i,n;n=a(e),i=r.a.defaultFieldValues[t.addType][t.option],n[t.addType].push([t.option].concat(i||[])),e.scriptMenu.needsUpdate++,e.scriptMenu.panels.addThenVisible=!1,e.scriptMenu.panels.addWhenVisible=!1},scriptmenutoggleaddthen:function(e){n(e),e.scriptMenu.panels.addThenVisible=!e.scriptMenu.panels.addThenVisible},scriptmenutoggleaddwhen:function(e){n(e),e.scriptMenu.panels.addWhenVisible=!e.scriptMenu.panels.addWhenVisible},scriptstatetoggle:function(e,t){e.scriptMenu.activeScriptState=t.option},scripttoggle:function(e,t){e.scriptMenu.activeScript=t.option,e.scriptMenu.panels.addThenVisible=!1,e.scriptMenu.panels.addWhenVisible=!1}}},function(e,t,i){'use strict';function a(e){e.tools.colorerEnabled=e.activeMenu===r.MENUS.CRAFT.MATERIAL,r.MENU_TO_SECTION[e.activeMenu]===r.MENU_SECTIONS.CRAFT&&(e.tools.airScalerEnabled=!e.tools.colorerEnabled,e.tools.grabberEnabled=!e.tools.colorerEnabled,e.tools.primaryCraftActionsEnabled=!e.tools.colorerEnabled,e.tools.scalerEnabled=!e.tools.colorerEnabled,e.tools.selectorEnabled=!e.tools.colorerEnabled,e.tools.raycasterEnabled=e.tools.colorerEnabled,e.tools.tips.normalTipVisible=!e.tools.colorerEnabled),r.MENU_TO_SECTION[e.activeMenu]===r.MENU_SECTIONS.BUILD&&(e.tools.airScalerEnabled=!0,e.tools.cameraScalerEnabled=!0,e.tools.grabberEnabled=!0,e.tools.primaryCraftActionsEnabled=!0,e.tools.scalerEnabled=!0,e.tools.selectorEnabled=!0,e.tools.tips.normalTipVisible=!0),r.MENU_TO_SECTION[e.activeMenu]===r.MENU_SECTIONS.MAIN&&(e.tools.airScalerEnabled=!1,e.tools.cameraScalerEnabled=!1,e.tools.grabberEnabled=!1,e.tools.tips.normalTipVisible=!1,e.tools.primaryCraftActionsEnabled=!1,e.tools.scalerEnabled=!1,e.tools.selectorEnabled=!0)}Object.defineProperty(t,'__esModule',{value:!0}),i.d(t,'toolsHandlers',function(){return l}),t.toolsComputeState=function(e){e.tools.clonerEnabled=e.tools.primaryCraftActionsEnabled,e.tools.deleterEnabled=e.tools.primaryCraftActionsEnabled,e.tools.gridTransformTogglerEnabled=e.tools.primaryCraftActionsEnabled,e.tools.menuRaycasterEnabled=!e.grabbedEntityId&&!e.airScalerActive&&!e.deleterActive&&!e.isGrabbingToInventory&&!e.teleporterActive,e.tools.undoEnabled=!e.playMode&&0<n.superHistory.length};var n=i(9),o=i.n(n),r=i(1),s=i.n(r),l={addshape:function(e){e.tools.scalerEnabled=!0},airscaleactivate:function(e){e.tools.airScalerActive=!0,e.tools.grabberEnabled=!1,e.tools.primaryCraftActionsEnabled=!1,e.tools.uniformScaleEnabled=!0,e.tools.tips.normalTipVisible=!1,e.tools.tips.scaleTipVisible=!0},airscaledeactivate:function(e){e.tools.airScalerActive=!1,e.tools.grabberEnabled=!0,e.tools.scalerEnabled=!0,e.tools.primaryCraftActionsEnabled=!0,e.tools.uniformScaleEnabled=!1,e.tools.tips.normalTipVisible=!0,e.tools.tips.scaleTipVisible=!1},airscalestart:function(e){e.tools.selectorEnabled=!1,gtag('event','airscale')},airscaleend:function(e){e.tools.selectorEnabled=!0},cloneend:function(e){e.tools.clonerActive=!1,e.tools.deleterEnabled=!0},clonestart:function(e){e.tools.clonerActive=!0,e.tools.deleterEnabled=!1},deletecancel:function(e){e.tools.airScalerEnabled=!0,e.tools.scalerEnabled=!0,e.tools.deleterActive=!1,e.tools.tips.normalTipVisible=!0},deleteend:function(e){e.tools.airScalerEnabled=!0,e.tools.scalerEnabled=!0,e.tools.deleterActive=!1,e.tools.tips.normalTipVisible=!0},deletestart:function(e){e.tools.airScalerEnabled=!1,e.tools.scalerEnabled=!1,e.tools.deleterActive=!0,e.tools.tips.normalTipVisible=!1},gridtransformtoggle:function(e){e.tools.gridTransformActive=!e.tools.gridTransformActive,gtag('event','gridtransformtoggle')},grab:function(e){e.tools.airScalerEnabled=!1,e.tools.menuRaycasterEnabled=!1,e.tools.selectorEnabled=!1,e.tools.tips.normalTipVisible=!1},inventorygrab:function(e){e.tools.tips.normalTipVisible=!1},inventoryclose:function(e){e.buildMode&&(e.tools.grabberEnabled=!0)},inventoryopen:function(e){e.buildMode&&(e.tools.grabberEnabled=!1)},menubuttonclick:a,newblanksite:a,newsitename:a,referenceimageclose:function(e){e.tools.referenceImageActive=!1},referenceimageloaded:function(e){e.tools.referenceImageEnabled=!0},referenceimageopen:function(e){e.tools.referenceImageActive=!0},scaleend:function(e){e.tools.airScalerEnabled=!0,e.tools.selectorEnabled=!0;e.tools.uniformScaleEnabled||!e.tools.airScalerActive&&(e.tools.clonerEnabled=!0)},scalestart:function(e){e.tools.airScalerActive||(e.tools.airScalerEnabled=!1),e.tools.clonerEnabled=!1,e.tools.selectorEnabled=!1},scalepointhitstart:function(e){e.tools.grabberEnabled=!1,e.tools.tips.normalTipVisible=!1,e.tools.tips.scaleTipVisible=!0},scalepointhitend:function(e){e.tools.airScalerActive||(e.tools.grabberEnabled=!0),e.tools.tips.normalTipVisible=!0,e.tools.tips.scaleTipVisible=!1},selectorlaserstart:function(e){e.tools.tips.normalTipVisible=!1},selectorlaserend:function(e){e.tools.tips.normalTipVisible=!0},teleporterend:function(e){e.tools.teleporterActive=!1},teleporterstart:function(e){e.tools.teleporterActive=!0},toinventorygrabend:function(e){e.tools.menuRaycasterEnabled=!0},toinventorygrabstart:function(e){e.tools.menuRaycasterEnabled=!1},ungrab:function(e){e.tools.airScalerEnabled=!0,e.tools.menuRaycasterEnabled=!0,e.tools.scalerEnabled=!0,e.tools.selectorEnabled=!0,e.tools.tips.normalTipVisible=!0},uniformscaledisable:function(e){e.tools.uniformScaleEnabled=!1,e.tools.primaryCraftActionsEnabled=!0},uniformscaleenable:function(e){e.tools.uniformScaleEnabled=!0,e.tools.primaryCraftActionsEnabled=!1},uniformscaleend:function(e){e.tools.uniformScaleActive=!1},uniformscalestart:function(e){e.tools.uniformScaleActive=!0}}},function(e,t,i){'use strict';var a=i(173),n=i(38),o=i(176),r=i(180),s;s=e.exports=function(t,i){var o,s,l,d,u;return 2>arguments.length||'string'!=typeof t?(d=i,i=t,t=null):d=arguments[2],null==t?(o=l=!0,s=!1):(o=r.call(t,'c'),s=r.call(t,'e'),l=r.call(t,'w')),u={value:i,configurable:o,enumerable:s,writable:l},d?a(n(d),u):u},s.gs=function(t,i,s){var l,d,u,p;return'string'==typeof t?u=arguments[3]:(u=s,s=i,i=t,t=null),null==i?i=void 0:o(i)?null==s?s=void 0:!o(s)&&(u=s,s=void 0):(u=i,i=s=void 0),null==t?(l=!0,d=!1):(l=r.call(t,'c'),d=r.call(t,'e')),p={get:i,set:s,configurable:l,enumerable:d},u?a(n(u),p):p}},function(e){'use strict';e.exports=function(){}},function(e,t,i){'use strict';var a=i(4),n=Array.prototype.forEach,o=Object.create,r=function(e,t){for(var i in e)t[i]=e[i]};e.exports=function(){var e=o(null);return n.call(arguments,function(t){a(t)&&r(Object(t),e)}),e}},function(e){'use strict';e.exports=function(e){if('function'!=typeof e)throw new TypeError(e+' is not a function');return e}},function(e,t,i){'use strict';var a=i(10),n=i(5);e.exports=n.apply(null,a('\n\r\u2028\u2029'))},function(){function e(e,t){var a;for(e.length=0,a=0;a<t.length;a++)e[a]=t[a]}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var t={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent('aabb-collider',{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:''}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,t),this.el.sceneEl.addEventListener('object3dset',this.setDirty),this.el.sceneEl.addEventListener('object3dremove',this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener('object3dset',this.setDirty),this.el.sceneEl.removeEventListener('object3dremove',this.setDirty)},tick:function(t){var a=this.boundingBox,n=this.centerDifferenceVec3,o=this.clearedIntersectedEls,r=this.intersectedEls,s=this.el,l=this.newIntersectedEls,d=this.objectEls,c=this.prevCheckTime,u=this.previousIntersectedEls,p=this,g,m,h,b,i;if(this.data.enabled&&!(c&&t-c<this.data.interval)&&(this.prevCheckTime=t,i=s.getObject3D('mesh')||s.getObject3D('text'),!!i)){for(this.dirty&&this.refreshObjects(),a.setFromObject(i),this.boxMin.copy(a.min),this.boxMax.copy(a.max),a.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(i),!this.boxHelper.parent&&s.sceneEl.object3D.add(this.boxHelper)),e(u,r),r.length=0,b=0;b<d.length;b++){if(!this.data.collideNonVisible&&!d[b].getAttribute('visible')){this.data.debug&&(g=d[b].getObject3D('mesh').boxHelper,g&&(s.sceneEl.object3D.remove(g),d[b].getObject3D('mesh').boxHelper=null));continue}this.isIntersecting(d[b])&&r.push(d[b])}for(l.length=0,b=0;b<r.length;b++)-1===u.indexOf(r[b])&&l.push(r[b]);for(o.length=0,b=0;b<u.length;b++)-1===r.indexOf(u[b])&&(u[b].hasAttribute('aabb-collider')||u[b].emit('hitend'),o.push(u[b]));for(b=0;b<l.length;b++)l[b].hasAttribute('aabb-collider')||l[b].emit('hitstart');for(b=0;b<r.length;b++)n.copy(r[b].getObject3D('mesh').boundingBoxCenter).sub(this.boxCenter),(void 0==m||n.length()<m)&&(m=n.length(),h=r[b]);!r.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear'),this.closestIntersectedEl=null,s.emit('hitclosestclear',this.hitClosestClearEventDetail)):h!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear',this.hitClosestClearEventDetail)),h&&(h.emit('hitclosest'),this.closestIntersectedEl=h,this.hitClosestEventDetail.el=h,s.emit('hitclosest',this.hitClosestEventDetail))),o.length&&s.emit('hitend'),l.length&&s.emit('hitstart',this.hitStartEventDetail)}},isIntersecting:function(){var e=new THREE.Box3;return function(t){var i,a,n;if(i=t.getObject3D('mesh')||t.getObject3D('text'),!!i)return e.setFromObject(i),this.data.debug&&(!i.boxHelper&&(i.boxHelper=new THREE.BoxHelper(i,new THREE.Color(Math.random(),Math.random(),Math.random())),t.sceneEl.object3D.add(i.boxHelper)),i.boxHelper.setFromObject(i)),a=e.min,n=e.max,i.boundingBoxCenter=i.boundingBoxCenter||new THREE.Vector3,e.getCenter(i.boundingBoxCenter),this.boxMin.x<=n.x&&this.boxMax.x>=a.x&&this.boxMin.y<=n.y&&this.boxMax.y>=a.y&&this.boxMin.z<=n.z&&this.boxMax.z>=a.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){var e=this.data;this.objectEls=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children,this.dirty=!1}})},function(e,t,i){window.download=i(57),window.GIF=i(58).GIF;var a=i(56);if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('camera-recorder',{dependencies:['camera'],schema:{dur:{default:3e3},enabled:{default:!0},framerate:{default:60},lookAt:{type:'vec3'},holdTimeAfter:{default:250},motionBlurEnabled:{default:!0},name:{default:''},quality:{default:10},positionFrom:{type:'vec3'},positionTo:{type:'vec3'},rotationFrom:{type:'vec3'},rotationTo:{type:'vec3'},showControls:{default:!0},workers:{default:8},workerPath:{default:'./'}},multiple:!0,init:function(){var e=this.data;this.startRecordingBound=()=>{this.startRecording(!1)},this.startPreviewingBound=()=>{this.startRecording(!0)},this.data.showControls&&(this.injectRecordButton(),this.injectDryRunButton()),this.capture=new a({format:'gif',name:e.name||void 0,motionBlurFrames:e.motionBlurEnabled?1:0,onProgress:(e)=>{this.el.emit('camerarecorderprogress',e,!1)},quality:e.quality,workers:e.workers,workersPath:e.workerPath}),this.lookAt=new THREE.Vector3,this.originalPosition=new THREE.Vector3,this.originalQuaternion=new THREE.Quaternion,this.originalCameraPosition=new THREE.Vector3,this.originalCameraQuaternion=new THREE.Quaternion},update:function(){var e=this.data,t=this.el,i;this.time=0,i=this.el.getDOMAttribute('camera-recorder'),'positionTo'in i&&t.setAttribute('animation__recorderposition',{property:'position',dur:e.dur,easing:'linear',from:'positionFrom'in i?e.positionFrom:t.getAttribute('position'),startEvents:'camerarecorderanimationstart',pauseEvents:'camerarecorderanimationstop',to:e.positionTo}),'rotationTo'in i&&t.setAttribute('animation__recorderrotation',{property:'rotation',dur:e.dur,easing:'linear',from:'rotationFrom'in i?e.rotationFrom:t.getAttribute('rotation'),startEvents:'camerarecorderanimationstart',pauseEvents:'camerarecorderanimationstop',to:e.rotationTo}),'lookAt'in i&&this.lookAt.copy(e.lookAt)},play:function(){var e=this.el;e.addEventListener('camerarecorderstart',this.startRecordingBound),e.addEventListener('camerarecorderdrystart',this.startPreviewingBound),e.hasAttribute('look-controls')&&e.getAttribute('look-controls').enabled&&(e.setAttribute('look-controls','enabled',!1),this.flippedLookControls=!0),e.hasAttribute('orbit-controls')&&e.getAttribute('orbit-controls').enabled&&(e.setAttribute('orbit-controls','enabled',!1),this.flippedOrbitControls=!0),this.resetPose()},remove:function(){var e=this.el;e.emit('camerarecorderanimationstop',null,!1),e.removeEventListener('camerarecorderstart',this.startRecordingBound),e.removeEventListener('camerarecorderdrystart',this.startPreviewingBound),this.flippedLookControls&&e.setAttribute('look-controls','enabled',!0),this.flippedOrbitControls&&e.setAttribute('orbit-controls','enabled',!0),setTimeout(()=>{e.object3D.position.copy(this.originalPosition),e.object3D.quaternion.copy(this.originalQuaternion),e.getObject3D('camera').position.copy(this.originalCameraPosition),e.getObject3D('camera').quaternion.copy(this.originalCameraQuaternion)})},tick:function(){(this.isRecording||this.isPreviewing)&&(!this.lookAt||this.el.object3D.lookAt(this.lookAt))},tock:function(e,t){if(this.isRecording||this.isPreviewing)return(this.time+=t,this.time>this.data.dur+this.data.holdTimeAfter)?(this.time=0,setTimeout(()=>{this.resetPose()},this.data.holdTimeAfter+100),this.isPreviewing)?void(this.isPreviewing=!1):(this.isRecording=!1,this.capture.stop(),this.capture.save(),void(this.recordButton&&(this.recordButton.setAttribute('disabled',''),this.recordButton.innerHTML='Processing...'))):void(this.isRecording&&this.capture.capture(this.el.sceneEl.canvas))},resetPose:function(){this.originalPosition.copy(this.el.object3D.position),this.originalQuaternion.copy(this.el.object3D.quaternion),this.originalCameraPosition.copy(this.el.getObject3D('camera').position),this.originalCameraQuaternion.copy(this.el.getObject3D('camera').quaternion)},startRecording:function(e){this.el.emit('camerarecorderanimationstart'),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),setTimeout(()=>('lookAt'in this.el.getDOMAttribute('camera-recorder')&&(this.el.getObject3D('camera').rotation.y=Math.PI),e?void(this.isPreviewing=!0):void(this.capture.start(),this.isRecording=!0)))},injectRecordButton:function(){var e;e=document.createElement('button'),e.innerHTML='Start recording',e.style.left='5px',e.style.position='fixed',e.style.top='5px',e.style.zIndex=999999999999,document.body.appendChild(e),e.addEventListener('click',()=>{this.startRecording()}),this.recordButton=e},injectDryRunButton:function(){var e;e=document.createElement('button'),e.innerHTML='Preview recording',e.style.left='5px',e.style.position='fixed',e.style.top='30px',e.style.zIndex=999999999999,document.body.appendChild(e),e.addEventListener('click',()=>{this.startRecording(!0)})}})},function(){var e=AFRAME.utils.styleParser;if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('event-set',{schema:{default:'',parse:function(t){var i,a,n,o;for(n in o=e.parse(t),i={},o)a=n.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase(),i[a]=o[n];return i}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=null},update:function(){this.removeEventListener(),this.updateEventListener(),this.addEventListener()},remove:function(){this.removeEventListener()},pause:function(){this.removeEventListener()},play:function(){this.addEventListener()},updateEventListener:function(){var e=this.data,t=this.el,i,a,n;i=e._event||this.id,a=e._target,delete e._event,delete e._target,n=a?t.sceneEl.querySelector(a):t,this.eventName=i,this.eventHandler=function(){for(var t in e)AFRAME.utils.entity.setComponentProperty.call(this,n,t,e[t])}},addEventListener:function(){this.el.addEventListener(this.eventName,this.eventHandler)},removeEventListener:function(){this.el.removeEventListener(this.eventName,this.eventHandler)}})},function(){var e={},t={};AFRAME.registerComponent('gltf-part',{schema:{buffer:{default:!0},part:{type:'string'},src:{type:'asset'}},update:function(){var e=this.el;!this.data.part&&this.data.src||this.getModel(function(t){t&&e.setObject3D('mesh',t)})},getModel:function(i){var a=this;return t[this.data.src]?void i(this.selectFromModel(t[this.data.src])):e[this.data.src]?e[this.data.src].then(function(e){i(a.selectFromModel(e))}):void(e[this.data.src]=new Promise(function(n){new THREE.GLTFLoader().load(a.data.src,function(o){var r=o.scene||o.scenes[0];t[a.data.src]=r,delete e[a.data.src],i(a.selectFromModel(r)),n(r)},function(){},console.error)}))},selectFromModel:function(e){var t,i;return(i=e.getObjectByName(this.data.part),!i)?void console.error('[gltf-part] `'+this.data.part+'` not found in model.'):(t=i.getObjectByProperty('type','Mesh').clone(!0),this.data.buffer)?(t.geometry=t.geometry.toNonIndexed(),t):(t.geometry=new THREE.Geometry().fromBufferGeometry(t.geometry),t)}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('haptics',{dependencies:['tracked-controls'],schema:{actuatorIndex:{default:0},dur:{default:100},enabled:{default:!0},events:{type:'array'},eventsFrom:{type:'string'},force:{default:1}},multiple:!0,init:function(){var e=this.data,t=this;if(this.pulse=this.pulse.bind(this),this.el.components['tracked-controls'].controller){if(this.gamepad=this.el.components['tracked-controls'].controller,!this.gamepad.hapticActuators.length)return;this.addEventListeners()}else this.el.addEventListener('controllerconnected',function(){setTimeout(function(){t.gamepad=t.el.components['tracked-controls'].controller,t.gamepad.hapticActuators.length&&t.addEventListeners()},150)})},remove:function(){this.removeEventListeners()},pulse:function(){var e=this.data,t;e.enabled&&this.gamepad&&this.gamepad.hapticActuators&&(t=this.gamepad.hapticActuators[e.actuatorIndex],t.pulse(e.force,e.dur))},addEventListeners:function(){var e=this.data,t,i;for(i=e.eventsFrom?document.querySelector(e.eventsFrom):this.el,t=0;t<e.events.length;t++)i.addEventListener(e.events[t],this.pulse)},removeEventListeners:function(){var e=this.data,t,i;for(i=e.eventsFrom?document.querySelector(e.eventsFrom):this.el,t=0;t<e.events.length;t++)i.removeEventListener(e.events[t],this.pulse)}})},function(e){function t(e,t,i){var a=[],n=Math.ceil(t/e.columns),o,r,s;o=e.marginColumn,r=e.marginRow,i&&(o=e.margin,r=e.margin);for(var l=0;l<n;l++)for(var d=0;d<e.columns;d++)s=[0,0,0],0===e.plane.indexOf('x')&&(s[0]=d*o),0===e.plane.indexOf('y')&&(s[1]=d*o),1===e.plane.indexOf('y')&&(s[1]=l*r),1===e.plane.indexOf('z')&&(s[2]=l*r),a.push(s);return a}function i(e,t){for(var a=[],n=0;n<t;n++){var i=isNaN(e.angle)?n*(2*Math.PI)/t:0.01745329252*(n*e.angle);var o=[];0===e.plane.indexOf('x')&&(o[0]=e.radius*d(i)),0===e.plane.indexOf('y')&&(o[1]=e.radius*d(i)),1===e.plane.indexOf('y')&&(o[1]=e.radius*c(i)),1===e.plane.indexOf('z')&&(o[2]=e.radius*c(i)),a.push(o)}return a}function a(e,i){return e.columns=i,t(e,i,!0)}function n(e){return s([[1,0,0],[0,1,0],[0,0,1],[-1,0,0],[0,-1,0],[0,0,-1]],e.radius/2)}function o(e){var t=(1+2.23606797749979)/2,i=1/t,a=2-t,n=-1*i,o=-1*a;return s([[-1,a,0],[-1,o,0],[0,-1,a],[0,-1,o],[0,1,a],[0,1,o],[1,a,0],[1,o,0],[i,i,i],[i,i,n],[i,n,i],[i,n,n],[a,0,1],[a,0,-1],[n,i,i],[n,i,n],[n,n,i],[n,n,n],[o,0,1],[o,0,-1]],e.radius/2)}function r(e){var t=-1/1.7320508075688772;return s([[0,0,1.7320508075688772+t],[-1,0,t],[1,0,t],[0,0.816496580927726*2,0]],e.radius/2)}function s(e,t){return e.map(function(e){return e.map(function(e){return e*t})})}function l(e,t){e.forEach(function(e,a){var i=t[a];e.setAttribute('position',{x:i[0],y:i[1],z:i[2]})})}var d=Math.cos,c=Math.sin;AFRAME.registerComponent('layout',{schema:{angle:{type:'number',default:!1,min:0,max:360,if:{type:['circle']}},columns:{default:1,min:0,if:{type:['box']}},margin:{default:1,min:0,if:{type:['box','line']}},marginColumn:{default:1,min:0,if:{type:['box']}},marginRow:{default:1,min:0,if:{type:['box']}},plane:{default:'xy'},radius:{default:1,min:0,if:{type:['circle','cube','dodecahedron','pyramid']}},reverse:{default:!1},type:{default:'line',oneOf:['box','circle','cube','dodecahedron','line','pyramid']},fill:{default:!0,if:{type:['circle']}}},init:function(){var e=this,t=this.el;this.children=t.getChildEntities(),this.initialPositions=[],this.children.forEach(function(t){function i(){var i=t.getAttribute('position');e.initialPositions.push([i.x,i.y,i.z])}return t.hasLoaded?i():void t.addEventListener('loaded',i)}),t.addEventListener('child-attached',function(i){i.detail.el.parentNode!==t||(e.children.push(i.detail.el),e.update())}),t.addEventListener('child-detached',function(t){-1===e.children.indexOf(t.detail.el)||(e.children.splice(e.children.indexOf(t.detail.el),1),e.initialPositions.splice(e.children.indexOf(t.detail.el),1),e.update())})},update:function(){var e=this.children,s=this.data,d=this.el,c=e.length,u,p;switch(s.type){case'box':{u=t;break}case'circle':{u=i;break}case'cube':{u=n;break}case'dodecahedron':{u=o;break}case'pyramid':{u=r;break}default:u=a;}p=u(s,c,'margin'in d.getDOMAttribute('layout')),s.reverse&&p.reverse(),l(e,p)},remove:function(){this.el.removeEventListener('child-attached',this.childAttachedCallback),l(this.children,this.initialPositions)}}),e.exports.getBoxPositions=t,e.exports.getCirclePositions=i,e.exports.getLinePositions=a,e.exports.getCubePositions=n,e.exports.getDodecahedronPositions=o,e.exports.getPyramidPositions=r},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerPrimitive('a-log',{defaultComponents:{geometry:{primitive:'plane',height:5},log:{},material:{color:'#111',shader:'flat',side:'double'},text:{color:'lightgreen',baseline:'top',align:'center',height:5}},mappings:{channel:'log.channel'}}),AFRAME.registerSystem('log',{schema:{console:{default:!0}},init:function(){var e=this.data,t=this.logs=[],i=this.loggers=[];AFRAME.log=function(a,n){t.push([a,n]),i.forEach(function(e){e.receiveLog(a,n)}),e.console&&console.log('[log:'+(n||'')+'] '+a)}},registerLogger:function(e){this.loggers.push(e),this.logs.forEach(function(t){e.receiveLog.apply(e,t)})},unregisterLogger:function(e){this.loggers.splice(this.loggers.indexOf(e),1)}}),AFRAME.registerComponent('log',{schema:{channel:{type:'string'},filter:{type:'string'},max:{default:100},showErrors:{default:!0}},init:function(){this.logs=[],this.system.registerLogger(this)},play:function(){var e=this;this.el.sceneEl.addEventListener('log',function(t){t.detail&&e.receiveLog(t.detail.message,t.detail.channel)}),window.onerror=function(t){e.receiveLog('Error: '+t)}},receiveLog:function(e,t){var i=this.data;'string'!=typeof e&&(e=JSON.stringify(e));i.channel&&t&&i.channel!==t||i.filter&&-1===e.indexOf(i.filter)||(this.logs.push(e),i.max&&this.logs.length>i.max&&this.logs.shift(),this.el.setAttribute('text',{value:this.logs.join('\n')}))},remove:function(){this.el.removeAttribute('text'),this.system.unregisterLogger(this)}})},function(){AFRAME.registerComponent('proxy-event',{schema:{captureBubbles:{default:!1},enabled:{default:!0},event:{type:'string'},from:{type:'string'},to:{type:'string'},as:{type:'string'},bubbles:{default:!1}},multiple:!0,init:function(){var e=this.data,t=this.el,a=this,n,o,i;if(e.from?'PARENT'===e.from?n=[t.parentNode]:n=document.querySelectorAll(e.from):'CHILDREN'===e.to?i=t.querySelectorAll('*'):'SELF'===e.to?i=[t]:i=document.querySelectorAll(e.to),e.from)for(o=0;o<n.length;o++)this.addEventListenerFrom(n[o]);else t.addEventListener(e.event,function(e){var n=a.data;if(n.enabled&&(n.captureBubbles||e.target===t))for(o=0;o<i.length;o++)i[o].emit(n.as||n.event,e.detail?e.detail:null,n.bubbles)})},addEventListenerFrom:function(e){var t=this.data,i=this;e.addEventListener(t.event,function(t){var a=i.data;a.enabled&&(a.captureBubbles||t.target===e)&&i.el.emit(a.as||a.event,t.detail?t.detail:null,!1)})}})},function(){function e(e){return'back'===e?THREE.BackSide:'double'===e?THREE.DoubleSide:THREE.FrontSide}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('slice9',{schema:{bottom:{default:0,min:0},color:{type:'color',default:'#fff'},debug:{default:!1},height:{default:1,min:0},left:{default:0,min:0},opacity:{default:1,min:0,max:1},padding:{default:0.1,min:0.01},right:{default:0,min:0},side:{default:'front',oneOf:['front','back','double']},src:{type:'map'},top:{default:0,min:0},transparent:{default:!0},width:{default:1,min:0},usingCustomMaterial:{default:!1},usingAtlas:{default:!1},uvAtlasMin:{type:'vec2'},uvAtlasMax:{type:'vec2'}},init:function(){var e=this.data,t,i;this.textureSrc=null,t=this.geometry=new THREE.PlaneBufferGeometry(e.width,e.height,3,3),e.usingCustomMaterial?this.plane=new THREE.Mesh(t):(i=this.material=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.debug}),this.plane=new THREE.Mesh(t,i)),this.el.setObject3D('mesh',this.plane)},regenerateMesh:function(){function e(e,t,i){a[3*e]=t,a[3*e+1]=i}function t(e,t,a){i.usingAtlas&&(t=i.uvAtlasMin.x+t*(i.uvAtlasMax.x-i.uvAtlasMin.x),a=i.uvAtlasMin.y+a*(i.uvAtlasMax.y-i.uvAtlasMin.y)),n[2*e]=t,n[2*e+1]=a}var i=this.data,a=this.geometry.attributes.position.array,n=this.geometry.attributes.uv.array,o,r,s;if(!this.material||this.material.map){i.usingCustomMaterial?(o=1,s=1):(o=this.material.map.image.width,s=this.material.map.image.width),r={left:i.left/s,right:i.right/s,top:i.top/o,bottom:i.bottom/o},t(1,r.left,1),t(2,r.right,1),t(4,0,r.bottom),t(5,r.left,r.bottom),t(6,r.right,r.bottom),t(7,1,r.bottom),t(8,0,r.top),t(9,r.left,r.top),t(10,r.right,r.top),t(11,1,r.top),t(13,r.left,0),t(14,r.right,0),i.usingAtlas&&(t(0,0,1),t(3,1,1),t(12,0,0),t(15,1,0));var l=i.width/2,d=i.height/2,c=-l+i.padding,u=l-i.padding,p=d-i.padding,g=-d+i.padding;e(0,-l,d),e(1,c,d),e(2,u,d),e(3,l,d),e(4,-l,p),e(5,c,p),e(6,u,p),e(7,l,p),e(8,-l,g),e(9,c,g),e(10,u,g),e(11,l,g),e(13,c,-d),e(14,u,-d),e(12,-l,-d),e(15,l,-d),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0}},update:function(t){var i=this.data,a;a=AFRAME.utils.diff(i,t),i.usingCustomMaterial||(this.material.color.setStyle(i.color),this.material.opacity=i.opacity,this.material.transparent=i.transparent,this.material.wireframe=i.debug,this.material.side=e(i.side),'src'in a&&this.updateMap()),('width'in a||'height'in a||'padding'in a||'left'in a||'top'in a||'bottom'in a||'right'in a)&&this.regenerateMesh()},updateMap:function(){function e(e){this.material.map=e,this.material.needsUpdate=!0,this.regenerateMesh()}var t=this.data.src;return t?t===this.textureSrc?void 0:(this.textureSrc=t,void this.el.sceneEl.systems.material.loadTexture(t,{src:t},e.bind(this))):void(!this.material.map||e(null))}})},function(e,t,i){function a(e){var t='line'===e.type?2:e.curveNumberPoints;return new l(t,e.curveLineWidth)}function n(e){var t,i,a;return i=document.createElement('a-entity'),i.className='hitEntity',i.setAttribute('visible',!1),a=document.createElement('a-entity'),a.setAttribute('geometry',{primitive:'torus',radius:e.hitCylinderRadius,radiusTubular:0.01}),a.setAttribute('material',{shader:'flat',color:e.hitCylinderColor,side:'double',depthTest:!1}),a.setAttribute('rotation','-90 0 0'),i.appendChild(a),t=document.createElement('a-entity'),t.setAttribute('position',{x:0,y:e.hitCylinderHeight/2,z:0}),t.setAttribute('geometry',{primitive:'cylinder',segmentsHeight:1,radius:e.hitCylinderRadius,height:e.hitCylinderHeight,openEnded:!0}),t.setAttribute('material',{shader:'flat',color:e.hitCylinderColor,side:'double',src:r,transparent:!0,depthTest:!1}),i.appendChild(t),i}function o(){var e,t;return e=new THREE.PlaneBufferGeometry(100,100),e.rotateX(-Math.PI/2),t=new THREE.MeshBasicMaterial({color:16776960}),new THREE.Mesh(e,t)}var r=i(62),s=i(60),l=i(61);if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),a=t.length;0<=--a&&t.item(a)!==this;);return-1<a}),AFRAME.registerComponent('teleport-controls',{schema:{type:{default:'parabolic',oneOf:['parabolic','line']},button:{default:'trackpad',oneOf:['trackpad','trigger','grip','menu']},startEvents:{type:'array'},endEvents:{type:'array'},collisionEntities:{default:''},checkCollisionChildren:{default:!0},direction:{type:'vec3',default:new THREE.Vector3(0,0,-1)},hitEntity:{type:'selector'},hitEntityAlignNormal:{default:!0},cameraRig:{type:'selector'},teleportOrigin:{type:'selector'},hitCylinderColor:{type:'color',default:'#99ff99'},hitCylinderRadius:{default:0.25,min:0},hitCylinderHeight:{default:0.3,min:0},interval:{default:0},maxLength:{default:10,min:0,if:{type:['line']}},curveNumberPoints:{default:30,min:2,if:{type:['parabolic']}},curveLineWidth:{default:0.025},curveHitColor:{type:'color',default:'#99ff99'},curveMissColor:{type:'color',default:'#ff0000'},curveShootingSpeed:{default:5,min:0,if:{type:['parabolic']}},defaultPlaneSize:{default:100},landingNormal:{type:'vec3',default:'0 1 0'},landingMaxAngle:{default:'45',min:0,max:360}},init:function(){var e=this.data,t=this.el,a,n;if(this.active=!1,this.obj=t.object3D,this.hitPoint=new THREE.Vector3,this.rigWorldPosition=new THREE.Vector3,this.newRigWorldPosition=new THREE.Vector3,this.teleportEventDetail={oldPosition:this.rigWorldPosition,newPosition:this.newRigWorldPosition,hitPoint:this.hitPoint},this.intersections=[],this.meshes=[],this.hit=!1,this.prevCheckTime=void 0,this.prevHitHeight=0,this.referenceNormal=new THREE.Vector3,this.curveMissColor=new THREE.Color,this.curveHitColor=new THREE.Color,this.raycaster=new THREE.Raycaster,this.defaultPlane=o(this.data.defaultPlaneSize),this.defaultCollisionMeshes=[this.defaultPlane],a=this.teleportEntity=document.createElement('a-entity'),a.classList.add('teleportRay'),a.object3D.visible=!1,t.sceneEl.appendChild(this.teleportEntity),this.onButtonDown=this.onButtonDown.bind(this),this.onButtonUp=this.onButtonUp.bind(this),this.data.startEvents.length&&this.data.endEvents.length){for(n=0;n<this.data.startEvents.length;n++)t.addEventListener(this.data.startEvents[n],this.onButtonDown);for(n=0;n<this.data.endEvents.length;n++)t.addEventListener(this.data.endEvents[n],this.onButtonUp)}else t.addEventListener(e.button+'down',this.onButtonDown),t.addEventListener(e.button+'up',this.onButtonUp);this.refreshMeshes()},update:function(e){var t=this.data,i=AFRAME.utils.diff(t,e);this.referenceNormal.copy(t.landingNormal),this.curveMissColor.set(t.curveMissColor),this.curveHitColor.set(t.curveHitColor),(!this.line||'curveLineWidth'in i||'curveNumberPoints'in i||'type'in i)&&(this.line=a(t),this.teleportEntity.setObject3D('mesh',this.line.mesh)),t.hitEntity?this.hitEntity=t.hitEntity:(!this.hitEntity||'hitCylinderColor'in i||'hitCylinderHeight'in i||'hitCylinderRadius'in i)&&(this.hitEntity&&this.hitEntity.parentNode.removeChild(this.hitEntity),this.hitEntity=n(t),this.el.sceneEl.appendChild(this.hitEntity)),this.hitEntity.object3D.visible=!1,'collisionEntities'in i&&this.refreshMeshes()},remove:function(){var e=this.el,t=this.hitEntity,i=this.teleportEntity;t&&t.parentNode.removeChild(t),i&&i.parentNode.removeChild(i),e.sceneEl.removeEventListener('child-attached',this.childAttachHandler),e.sceneEl.removeEventListener('child-detached',this.childDetachHandler)},tick:function(){var e=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3(0,-9.8,0),a=new THREE.Vector3,r=new THREE.Vector3,l=new THREE.Quaternion,d=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,p=new THREE.Vector3,g=new THREE.Vector3;return function(m){if(this.active&&!(this.prevCheckTime&&m-this.prevCheckTime<this.data.interval)){this.prevCheckTime=m;var h=this.obj.matrixWorld;h.decompose(d,l,c);var b=u.copy(this.data.direction).applyQuaternion(l).normalize();if(this.line.setDirection(g.copy(b)),this.obj.getWorldPosition(e),r.copy(e),this.teleportEntity.object3D.visible=!0,this.line.material.color.set(this.curveMissColor),this.hitEntity.object3D.visible=!1,this.hit=!1,'parabolic'===this.data.type){n.copy(b).multiplyScalar(this.data.curveShootingSpeed);for(var y=0,i;y<this.line.numPoints;y++){i=y/(this.line.numPoints-1),s(e,n,o,i,a);var t=p.copy(a).sub(r).normalize();if(this.raycaster.far=t.length(),this.raycaster.set(r,t),this.checkMeshCollisions(y,a))break;r.copy(a)}}else'line'===this.data.type&&(a.copy(r).add(g.copy(b).multiplyScalar(this.data.maxLength)),this.raycaster.far=this.data.maxLength,this.raycaster.set(e,b),this.line.setPoint(0,e),this.checkMeshCollisions(1,a))}}}(),refreshMeshes:function(){var e=this.data,t=this.el,a,n,i;if(!e.collisionEntities)return void(this.collisionEntities=[]);if(a=[].slice.call(t.sceneEl.querySelectorAll(e.collisionEntities)),this.collisionEntities=a,this.data.checkCollisionChildren&&(t.sceneEl.removeEventListener('child-attached',this.childAttachHandler),this.childAttachHandler=function(t){t.detail.el.matches(e.collisionEntities)&&a.push(t.detail.el)},t.sceneEl.addEventListener('child-attached',this.childAttachHandler),t.sceneEl.removeEventListener('child-detached',this.childDetachHandler),this.childDetachHandler=function(t){var i;t.detail.el.matches(e.collisionEntities)&&(i=a.indexOf(t.detail.el),-1===i||a.splice(i,1))},t.sceneEl.addEventListener('child-detached',this.childDetachHandler)),this.data.collisionEntities){var i=this.meshes=[];for(n=0;n<this.collisionEntities.length;n++){var o=this.collisionEntities[n].getObject3D('mesh');o?this.meshes.push(o):this.collisionEntities[n].addEventListener('object3dset',function(e){e.target!==this||'mesh'!==e.detail.type||i.push(e.detail.object)})}}else this.meshes=this.defaultCollisionMeshes},onButtonDown:function(){this.active=!0,this.el.emit('teleportstart')},onButtonUp:function(){const e=new THREE.Vector3,t=new THREE.Vector3,a=[new THREE.Vector3,new THREE.Vector3],n=new THREE.Vector3;return function(){if(this.active&&(this.active=!1,this.hitEntity.object3D.visible=!1,this.teleportEntity.object3D.visible=!1,!!this.hit)){const i=this.data.cameraRig||this.el.sceneEl.camera.el;i.object3D.getWorldPosition(this.rigWorldPosition),this.newRigWorldPosition.copy(this.hitPoint);const s=this.data.teleportOrigin;if(s&&(s.getObject3D('camera')?s.getObject3D('camera').getWorldPosition(e):s.getWorldPosition(e),this.newRigWorldPosition.sub(e).add(this.rigWorldPosition)),this.newRigWorldPosition.y=this.rigWorldPosition.y+this.hitPoint.y-this.prevHitHeight,this.prevHitHeight=this.hitPoint.y,t.copy(this.newRigWorldPosition),i.object3D.parent&&i.object3D.parent.worldToLocal(t),i.object3D.position.copy(t),!this.data.cameraRig)for(var o=document.querySelectorAll('a-entity[tracked-controls]'),r=0;r<o.length;r++)o[r].object3D.getWorldPosition(n),a[r].copy(this.newRigWorldPosition).sub(this.rigWorldPosition).add(n),o[r].object3D.position.copy(a[r]);this.el.emit('teleported',this.teleportEventDetail)}}}(),checkMeshCollisions:function(){var e=new THREE.Vector3;return function(t,i){var a=this.intersections,t;if(a.length=0,this.raycaster.intersectObjects(this.meshes,!0,a),0<a.length&&!this.hit&&this.isValidNormalsAngle(a[0].face.normal)){var n=a[0].point;this.line.material.color.set(this.curveHitColor),this.hitEntity.object3D.position.copy(n),this.hitEntity.object3D.visible=!0,this.hit=!0,this.hitPoint.copy(a[0].point),this.data.hitEntityAlignNormal&&(e.copy(a[0].point).add(a[0].face.normal),a[0].object.localToWorld(e),this.hitEntity.object3D.lookAt(e));for(var o=t;o<this.line.numPoints;o++)this.line.setPoint(o,this.hitPoint);return!0}return this.line.setPoint(t,i),!1}}(),isValidNormalsAngle:function(e){var t=this.referenceNormal.angleTo(e);return THREE.Math.RAD2DEG*t<=this.data.landingMaxAngle}})},function(e,t,i){function a(e,t,i){return new Promise(function(a){u(t).then(function(){h[e]={template:s(t)(i.trim()),type:t},a(h[e])})})}function n(e,t,i){return t===f?e(i):t===v?e(i):t===E?Mustache.render(e,i):t===x?e.render(i):p(e,i)}function o(e,t){var i=document.querySelector(e),n=i.getAttribute('type'),o=i.innerHTML;if(!t){if(!n)throw new Error('Must provide `type` attribute for <script> templates (e.g., handlebars, jade, nunjucks, html)');if(-1!==n.indexOf('handlebars'))t=f;else if(-1!==n.indexOf('jade'))t=v;else if(-1!==n.indexOf('mustache'))t=E;else if(-1!==n.indexOf('nunjucks'))t=x;else if(-1!==n.indexOf('html'))t=S;else return void b('Template type could not be inferred from the script tag. Please add a type.')}return new Promise(function(i){a(e,t,o).then(function(e){i(e,t)})})}function r(e,t){return new Promise(function(i){var n;n=new XMLHttpRequest,n.addEventListener('load',function(){a(e,t,n.response).then(function(e){i(e,t)})}),n.open('GET',e),n.send()})}function s(e){return e===f?l:e===v?d:e===E?l:e===x?c:function(e){return e}}function l(e){return Handlebars.compile(e)}function d(e){return jade.compile(e)}function c(e){return nunjucks.compile(e)}function u(e){return new Promise(function(t){if(!e||'html'===e)return t();var i=C[e];if(!0===C[e])return t();i||(i=document.createElement('script'),C[e]=i,i.setAttribute('src',A[e]),y('Lazy-loading %s engine. Please add <script src="%s"> to your page.',e,A[e]),document.body.appendChild(i));var a=i.onload||function(){};i.onload=function(){a(),C[e]=!0,t()}})}var p=i(190),g=AFRAME.utils.debug,m=AFRAME.utils.extend,h={},b=g('template-component:error'),y=g('template-component:info'),f='handlebars',v='jade',E='mustache',x='nunjucks',S='html',C={};C[f]=!!window.Handlebars,C[v]=!!window.jade,C[E]=!!window.Mustache,C[x]=!!window.nunjucks;var A={};A[f]='https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js',A[v]='https://cdnjs.cloudflare.com/ajax/libs/jade/1.11.0/jade.min.js',A[E]='https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.min.js',A[x]='https://cdnjs.cloudflare.com/ajax/libs/nunjucks/2.3.0/nunjucks.min.js',AFRAME.registerComponent('template',{schema:{insert:{default:'beforeend'},type:{default:''},src:{default:''},data:{default:''}},update:function(e){var t=this.data,i=this.el,a='#'===t.src[0]?o:r,n=h[t.src];if(e&&e.src!==t.src)for(;i.firstChild;)i.removeChild(i.firstChild);return n?void this.renderTemplate(n):void a(t.src,t.type).then(this.renderTemplate.bind(this))},renderTemplate:function(e){var t=this.el,i=this.data,a={};Object.keys(t.dataset).forEach(function(e){a[e]=t.dataset[e]}),i.data&&(a=m(a,t.getAttribute(i.data)));var o=n(e.template,e.type,a);t.insertAdjacentHTML(i.insert,o),t.emit('templaterendered')}});AFRAME.registerComponent('template-set',{schema:{on:{type:'string'},src:{type:'string'},data:{type:'string'}},init:function(){var e=this.data,t=this.el;t.addEventListener(e.on,function(){t.setAttribute('template',{src:e.src,data:e.data})})}})},function(e,t,i){var a=i(162);'string'==typeof a&&(a=[[e.i,a,'']]);var n={hmr:!0},o;n.transform=o;i(198)(a,n);a.locals&&(e.exports=a.locals),!1},function(e,t,i){function a(e){return i(n(e))}function n(e){var t=o[e];if(!(t+1))throw new Error('Cannot find module \''+e+'\'.');return t}var o={"./air-scaler.js":67,"./background-audio.js":68,"./blur-things.js":69,"./bounding-box.js":70,"./camera-scaler.js":71,"./cloner.js":72,"./collidable.js":73,"./collider-highlight.js":74,"./colorer.js":75,"./console-shortcuts.js":76,"./controller-button-feedback.js":77,"./controller.js":78,"./debug-controller.js":79,"./debug-cursor.js":80,"./debug-shapes.js":81,"./deleter.js":82,"./entity-raycaster.js":83,"./entity-recenter.js":84,"./explore-site-navigate.js":85,"./face-colors.js":13,"./gallery-item.js":86,"./gallery-layout.js":87,"./gallery.js":88,"./geometry-merger-init.js":89,"./geometry-merger-shape-active-color.js":90,"./geometry-merger-temporary-color.js":91,"./geometry-merger-toggler.js":92,"./geometry-merger.js":14,"./gif-studio.js":93,"./go-to-state.js":94,"./grabber.js":95,"./grid-transform-toggler.js":96,"./handedness.js":97,"./hit-emit.js":98,"./human-scale-marker.js":99,"./indexeddb.js":100,"./inventory-dropper.js":101,"./inventory-grabber.js":102,"./inventory-item.js":103,"./inventory.js":104,"./laser.js":105,"./layout-text.js":106,"./load-menu-refresh.js":107,"./loading-splash.js":108,"./menu-button-switcher.js":109,"./menu-container-click-listener.js":110,"./menu-edit-button.js":111,"./menu-environment.js":112,"./menu-handedness.js":113,"./menu-hover-color.js":114,"./menu-icon.js":115,"./menu-load-button.js":116,"./menu-material.js":117,"./menu-raycaster.js":118,"./menu-remix-button.js":119,"./menu-selected-thing.js":120,"./menu-shape.js":121,"./menu-toggler.js":122,"./menu-tooltip.js":123,"./menu.js":124,"./mobile-shadow-toggle.js":125,"./orbit-controls.js":126,"./paginator.js":127,"./plane-grid-uvs.js":128,"./play-sound.js":129,"./preloader.js":130,"./propertyTypes/object.js":15,"./publish.js":131,"./published-site-text-color.js":132,"./raycastable.js":133,"./raycaster-target.js":134,"./reference-image.js":135,"./render-entities.js":136,"./renderer-pixel-ratio.js":137,"./saveload.js":138,"./scaler.js":139,"./script/debug-scripts.js":16,"./script/script-active-color.js":17,"./script/script-menu-add.js":18,"./script/script-menu-field-press.js":19,"./script/script-menu-go-to-state-panel.js":20,"./script/script-menu-render.js":21,"./script/script-menu-state-change.js":22,"./script/script-menu-toggle.js":23,"./script/super-script-toggler.js":24,"./script/super-script.js":25,"./selector.js":140,"./shadow-type.js":141,"./shape-add-effect.js":142,"./staged-entity.js":143,"./sub-object.js":144,"./super-environment-updater.js":26,"./super-environment.js":27,"./super-geometry.js":28,"./super-material-active-color.js":145,"./super-material.js":29,"./teleport-listener.js":146,"./teleport-refresh.js":147,"./teleporter.js":148,"./thumb-controls.js":149,"./tip-normal.js":150,"./tutorial-cursor.js":151,"./ui.js":152,"./undo-icon.js":153,"./user.js":154,"./vertex-colors-buffer.js":30};a.keys=function(){return Object.keys(o)},a.resolve=n,e.exports=a,a.id=53},function(e,t,i){function a(e){return i(n(e))}function n(e){var t=o[e];if(!(t+1))throw new Error('Cannot find module \''+e+'\'.');return t}var o={"./debug-scripts.js":16,"./script-active-color.js":17,"./script-menu-add.js":18,"./script-menu-field-press.js":19,"./script-menu-go-to-state-panel.js":20,"./script-menu-render.js":21,"./script-menu-state-change.js":22,"./script-menu-toggle.js":23,"./super-script-toggler.js":24,"./super-script.js":25};a.keys=function(){return Object.keys(o)},a.resolve=n,e.exports=a,a.id=54},function(e,t,i){function a(e){return i(n(e))}function n(e){var t=o[e];if(!(t+1))throw new Error('Cannot find module \''+e+'\'.');return t}var o={"./history.js":9,"./index.js":161,"./publish.js":33,"./script.js":34,"./tools.js":35};a.keys=function(){return Object.keys(o)},a.resolve=n,e.exports=a,a.id=55},function(e,t,i){(function(e,a){var n;(function(){'use strict';function o(e){return e&&e.Object===Object?e:null}function r(e){return('0000000'+e+'').slice(-7)}function s(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+'-'+e()+'-'+e()+'-'+e()+'-'+e()+e()+e()}function l(e){var t={};this.settings=e,this.on=function(e,i){t[e]=i},this.emit=function(e){var i=t[e];i&&i.apply(null,Array.prototype.slice.call(arguments,1))},this.filename=e.name||s(),this.extension='',this.mimeType=''}function d(e){l.call(this,e),this.extension='.tar',this.mimeType='application/x-tar',this.fileExtension='',this.baseFilename=this.filename,this.tape=null,this.count=0,this.part=1,this.frames=0}function c(e){d.call(this,e),this.type='image/png',this.fileExtension='.png'}function u(e){d.call(this,e),this.type='image/jpeg',this.fileExtension='.jpg',this.quality=e.quality/100||.8}function p(e){var t=document.createElement('canvas');'image/webp'!==t.toDataURL('image/webp').substr(5,10)&&console.log('WebP not supported - try another export format'),l.call(this,e),this.quality=e.quality/100||.8,this.extension='.webm',this.mimeType='video/webm',this.baseFilename=this.filename,this.framerate=e.framerate,this.frames=0,this.part=1,this.videoWriter=new WebMWriter({quality:this.quality,fileWriter:null,fd:null,frameRate:this.framerate})}function g(e){l.call(this,e),e.quality=e.quality/100||.8,this.encoder=new FFMpegServer.Video(e),this.encoder.on('process',function(){this.emit('process')}.bind(this)),this.encoder.on('finished',function(e,t){var i=this.callback;i&&(this.callback=void 0,i(e,t))}.bind(this)),this.encoder.on('progress',function(e){this.settings.onProgress&&this.settings.onProgress(e)}.bind(this)),this.encoder.on('error',function(e){alert(JSON.stringify(e,null,2))}.bind(this))}function m(e){l.call(this,e),this.framerate=this.settings.framerate,this.type='video/webm',this.extension='.webm',this.stream=null,this.mediaRecorder=null,this.chunks=[]}function h(e){l.call(this,e),e.quality=31-(30*e.quality/100||10),e.workers=e.workers||4,this.extension='.gif',this.mimeType='image/gif',this.canvas=document.createElement('canvas'),this.ctx=this.canvas.getContext('2d'),this.sizeSet=!1,this.encoder=new GIF({workers:e.workers,quality:e.quality,workerScript:e.workersPath+'gif.worker.js'}),this.encoder.on('progress',function(e){this.settings.onProgress&&this.settings.onProgress(e)}.bind(this)),this.encoder.on('finished',function(e){var t=this.callback;t&&(this.callback=void 0,t(e))}.bind(this))}function b(e){function t(){function e(){return this._hooked||(this._hooked=!0,this._hookedTime=this.currentTime||0,this.pause(),$.push(this)),this._hookedTime+E.startTime}f('Capturer start'),P=window.Date.now(),M=P+E.startTime,O=window.performance.now(),R=O+E.startTime,window.Date.prototype.getTime=function(){return M},window.Date.now=function(){return M},window.setTimeout=function(e,i){var a={callback:e,time:i,triggerTime:M+i};return S.push(a),f('Timeout set to '+a.time),a},window.clearTimeout=function(e){for(var t=0;t<S.length;t++)if(S[t]==e){S.splice(t,1),f('Timeout cleared');continue}},window.setInterval=function(e,i){var a={callback:e,time:i,triggerTime:M+i};return C.push(a),f('Interval set to '+a.time),a},window.clearInterval=function(){return f('clear Interval'),null},window.requestAnimationFrame=function(e){D.push(e)},window.performance.now=function(){return R};try{Object.defineProperty(HTMLVideoElement.prototype,'currentTime',{get:e}),Object.defineProperty(HTMLAudioElement.prototype,'currentTime',{get:e})}catch(e){f(e)}}function i(){I=!1,N.stop(),o()}function a(e,t){W(e,0,t)}function n(){a(b)}function o(){f('Capturer stop'),window.setTimeout=W,window.setInterval=q,window.clearInterval=Y,window.clearTimeout=Z,window.requestAnimationFrame=K,window.Date.prototype.getTime=J,window.Date.now=Q,window.performance.now=X}function r(){var e=A/E.framerate;(E.frameLimit&&A>=E.frameLimit||E.timeLimit&&e>=E.timeLimit)&&(i(),y());var t=new Date(null);t.setSeconds(e),B.textContent=2<E.motionBlurFrames?'CCapture '+E.format+' | '+A+' frames ('+T+' inter) | '+t.toISOString().substr(11,8):'CCapture '+E.format+' | '+A+' frames | '+t.toISOString().substr(11,8)}function s(e){(F.width!==e.width||F.height!==e.height)&&(F.width=e.width,F.height=e.height,U=new Uint16Array(4*(F.height*F.width)),z.fillStyle='#0',z.fillRect(0,0,F.width,F.height))}function l(e){z.drawImage(e,0,0),V=z.getImageData(0,0,F.width,F.height);for(var t=0;t<U.length;t+=4)U[t]+=V.data[t],U[t+1]+=V.data[t+1],U[t+2]+=V.data[t+2];T++}function d(){for(var e=V.data,t=0;t<U.length;t+=4)e[t]=2*U[t]/E.motionBlurFrames,e[t+1]=2*U[t+1]/E.motionBlurFrames,e[t+2]=2*U[t+2]/E.motionBlurFrames;z.putImageData(V,0,0),N.add(F),A++,T=0,f('Full MB Frame! '+A+' '+M);for(var t=0;t<U.length;t+=4)U[t]=0,U[t+1]=0,U[t+2]=0;gc()}function b(){var e=1e3/E.framerate,t=(A+T/E.motionBlurFrames)*e;M=P+t,R=O+t,$.forEach(function(e){e._hookedTime=t/1e3}),r(),f('Frame: '+A+' '+T);for(var i=0;i<S.length;i++)if(M>=S[i].triggerTime){a(S[i].callback),S.splice(i,1);continue}for(var i=0;i<C.length;i++)if(M>=C[i].triggerTime){a(C[i].callback),C[i].triggerTime+=C[i].time;continue}D.forEach(function(e){a(e,M-j)}),D=[]}function y(e){e||(e=function(e){return download(e,N.filename+N.extension,N.mimeType),!1}),N.save(e)}function f(e){k&&console.log(e)}function v(e){var t=w[e];t&&t.apply(null,Array.prototype.slice.call(arguments,1))}var E=e||{},x=new Date,S=[],C=[],A=0,T=0,D=[],I=!1,w={},k,L,M,P,R,O,n,N;E.framerate=E.framerate||60,E.motionBlurFrames=2*(E.motionBlurFrames||1),k=E.verbose||!1,L=E.display||!1,E.step=1e3/E.framerate,E.timeLimit=E.timeLimit||0,E.frameLimit=E.frameLimit||0,E.startTime=E.startTime||0;var B=document.createElement('div');B.style.position='absolute',B.style.left=B.style.top=0,B.style.backgroundColor='black',B.style.fontFamily='monospace',B.style.fontSize='11px',B.style.padding='5px',B.style.color='red',B.style.zIndex=1e5,E.display&&document.body.appendChild(B);var F=document.createElement('canvas'),z=F.getContext('2d'),U,V;f('Step is set to '+E.step+'ms');var H={gif:h,webm:p,ffmpegserver:g,png:c,jpg:u,"webm-mediarecorder":m},_=H[E.format];if(!_)throw'Error: Incorrect or missing format: Valid formats are '+Object.keys(H).join(', ');if(N=new _(E),N.step=n,N.on('process',b),N.on('progress',function(e){v('progress',e)}),!1=='performance'in window&&(window.performance={}),Date.now=Date.now||function(){return new Date().getTime()},!1=='now'in window.performance){var G=Date.now();performance.timing&&performance.timing.navigationStart&&(G=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-G}}var W=window.setTimeout,q=window.setInterval,Y=window.clearInterval,Z=window.clearTimeout,K=window.requestAnimationFrame,Q=window.Date.now,X=window.performance.now,J=window.Date.prototype.getTime,$=[];return{start:function(){t(),N.start(),I=!0},capture:function(e){I&&(2<E.motionBlurFrames?(s(e),l(e),T>=.5*E.motionBlurFrames?d():n()):(N.add(e),A++,f('Full Frame! '+A)))},stop:i,save:y,on:function(e,t){w[e]=t}}}var y={function:!0,object:!0},f=parseFloat,v=parseInt,E=y[typeof t]&&t&&!t.nodeType?t:void 0,x=y[typeof e]&&e&&!e.nodeType?e:void 0,S=x&&x.exports===E?E:void 0,C=o(E&&x&&'object'==typeof a&&a),A=o(y[typeof self]&&self),T=o(y[typeof window]&&window),D=o(y[typeof this]&&this),I=C||T!==(D&&D.window)&&T||A||D||Function('return this')();'gc'in window||(window.gc=function(){}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,'toBlob',{value:function(e,t,a){for(var n=atob(this.toDataURL(t,a).split(',')[1]),o=n.length,r=new Uint8Array(o),s=0;s<o;s++)r[s]=n.charCodeAt(s);e(new Blob([r],{type:t||'image/png'}))}}),function(){if(!1=='performance'in window&&(window.performance={}),Date.now=Date.now||function(){return new Date().getTime()},!1=='now'in window.performance){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}}();var j=window.Date.now();l.prototype.start=function(){},l.prototype.stop=function(){},l.prototype.add=function(){},l.prototype.save=function(){},l.prototype.dispose=function(){},l.prototype.safeToProceed=function(){return!0},l.prototype.step=function(){console.log('Step not set!')},d.prototype=Object.create(l.prototype),d.prototype.start=function(){this.dispose()},d.prototype.add=function(e){var t=new FileReader;t.onload=function(){this.tape.append(r(this.count)+this.fileExtension,new Uint8Array(t.result)),0<this.settings.autoSaveTime&&this.frames/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(e){this.filename=this.baseFilename+'-part-'+r(this.part),download(e,this.filename+this.extension,this.mimeType);var t=this.count;this.dispose(),this.count=t+1,this.part++,this.filename=this.baseFilename+'-part-'+r(this.part),this.frames=0,this.step()}.bind(this)):(this.count++,this.frames++,this.step())}.bind(this),t.readAsArrayBuffer(e)},d.prototype.save=function(e){e(this.tape.save())},d.prototype.dispose=function(){this.tape=new Tar,this.count=0},c.prototype=Object.create(d.prototype),c.prototype.add=function(e){e.toBlob(function(e){d.prototype.add.call(this,e)}.bind(this),this.type)},u.prototype=Object.create(d.prototype),u.prototype.add=function(e){e.toBlob(function(e){d.prototype.add.call(this,e)}.bind(this),this.type,this.quality)},p.prototype=Object.create(l.prototype),p.prototype.start=function(){this.dispose()},p.prototype.add=function(e){this.videoWriter.addFrame(e),0<this.settings.autoSaveTime&&this.frames/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(e){this.filename=this.baseFilename+'-part-'+r(this.part),download(e,this.filename+this.extension,this.mimeType),this.dispose(),this.part++,this.filename=this.baseFilename+'-part-'+r(this.part),this.step()}.bind(this)):(this.frames++,this.step())},p.prototype.save=function(e){this.videoWriter.complete().then(e)},p.prototype.dispose=function(){this.frames=0,this.videoWriter=new WebMWriter({quality:this.quality,fileWriter:null,fd:null,frameRate:this.framerate})},g.prototype=Object.create(l.prototype),g.prototype.start=function(){this.encoder.start(this.settings)},g.prototype.add=function(e){this.encoder.add(e)},g.prototype.save=function(e){this.callback=e,this.encoder.end()},g.prototype.safeToProceed=function(){return this.encoder.safeToProceed()},m.prototype=Object.create(l.prototype),m.prototype.add=function(e){this.stream||(this.stream=e.captureStream(this.framerate),this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=function(t){this.chunks.push(t.data)}.bind(this)),this.step()},m.prototype.save=function(e){this.mediaRecorder.onstop=function(){var t=new Blob(this.chunks,{type:'video/webm'});this.chunks=[],e(t)}.bind(this),this.mediaRecorder.stop()},h.prototype=Object.create(l.prototype),h.prototype.add=function(e){this.sizeSet||(this.encoder.setOption('width',e.width),this.encoder.setOption('height',e.height),this.sizeSet=!0),this.canvas.width=e.width,this.canvas.height=e.height,this.ctx.drawImage(e,0,0),this.encoder.addFrame(this.ctx,{copy:!0,delay:this.settings.step}),this.step()},h.prototype.save=function(e){this.callback=e,this.encoder.render()},(T||A||{}).CCapture=b,(n=function(){return b}.call(t,i,t,e),!(n!==void 0&&(e.exports=n)))})()}).call(t,i(203)(e),i(202))},function(e){e.exports=function(e,t,i){function n(e,t){if('download'in c)return c.href=e,c.setAttribute('download',p),c.innerHTML='downloading...',c.style.display='none',d.body.appendChild(c),setTimeout(function(){c.click(),d.body.removeChild(c),!0===t&&setTimeout(function(){o.URL.revokeObjectURL(c.href)},250)},66),!0;var i=d.createElement('iframe');d.body.appendChild(i),t||(e='data:'+e.replace(/^data:([\w\/\-\+]+)/,r)),i.src=e,setTimeout(function(){d.body.removeChild(i)},333)}var o=window,r='application/octet-stream',s=i||r,l=e,d=document,c=d.createElement('a'),a=function(e){return e+''},g=o.Blob||o.MozBlob||o.WebKitBlob||a,u=o.MSBlobBuilder||o.WebKitBlobBuilder||o.BlobBuilder,p=t||'download',h,y,b;if('true'===this+''&&(l=[l,s],s=l[0],l=l[1]),(l+'').match(/^data\:[\w+\-]+\/[\w+\-]+[,;]/))return navigator.msSaveBlob?navigator.msSaveBlob(function(e){var a=e.split(/[:;,]/),n=a[1],o='base64'==a[2]?atob:decodeURIComponent,r=o(a.pop()),s=r.length,l=0,i=new Uint8Array(s);for(l;l<s;++l)i[l]=r.charCodeAt(l);return new g([i],{type:n})}(l),p):n(l);try{h=l instanceof g?l:new g([l],{type:s})}catch(e){u&&(y=new u,y.append([l]),h=y.getBlob(s))}if(navigator.msSaveBlob)return navigator.msSaveBlob(h,p);if(o.URL)n(o.URL.createObjectURL(h),!0);else{if('string'==typeof h||h.constructor===a)try{return n('data:'+s+';base64,'+o.btoa(h))}catch(e){return n('data:'+s+','+encodeURIComponent(h))}b=new FileReader,b.onload=function(){n(this.result)},b.readAsDataURL(h)}return!0}},function(){(function(e){function t(i,n){if({}.hasOwnProperty.call(t.cache,i))return t.cache[i];var o=t.resolve(i);if(!o)throw new Error('Failed to resolve module '+i);var r={id:i,require:t,filename:i,exports:{},loaded:!1,parent:n,children:[]};n&&n.children.push(r);var s=i.slice(0,i.lastIndexOf('/')+1);return t.cache[i]=r.exports,o.call(r.exports,r,r.exports,s,i),r.loaded=!0,t.cache[i]=r.exports}t.modules={},t.cache={},t.resolve=function(e){return{}.hasOwnProperty.call(t.modules,e)?t.modules[e]:void 0},t.define=function(e,i){t.modules[e]=i};var i=function(t){return t='/',{title:'browser',version:'v0.10.26',browser:!0,env:{},argv:[],nextTick:e.setImmediate||function(e){setTimeout(e,0)},cwd:function(){return t},chdir:function(e){t=e}}}();t.define('/gif.coffee',function(a){function n(e,t){return{}.hasOwnProperty.call(e,t)}function o(e,t){for(var i=0,a=t.length;i<a;++i)if(i in t&&t[i]===e)return!0;return!1}function r(e,t){function i(){this.constructor=e}for(var a in t)n(t,a)&&(e[a]=t[a]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e}var i,s,l,u,d;l=t('events',a).EventEmitter,i=t('/browser.coffee',a),d=function(e){function t(e){var t,i;for(t in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(e),s)i=s[t],null==this.options[t]?this.options[t]=i:this.options[t]}return r(t,e),s={workerScript:'gif.worker.js',workers:2,repeat:0,background:'#fff',quality:10,width:null,height:null,transparent:null},u={delay:500,copy:!1},t.prototype.setOption=function(e,t){return this.options[e]=t,null!=this._canvas&&('width'===e||'height'===e)?this._canvas[e]=t:void 0},t.prototype.setOptions=function(e){var t,i;return function(a){for(t in e)n(e,t)&&(i=e[t],a.push(this.setOption(t,i)));return a}.call(this,[])},t.prototype.addFrame=function(t,i){var a,n;for(n in null==i&&(i={}),a={},a.transparent=this.options.transparent,u)a[n]=i[n]||u[n];if(null!=this.options.width||this.setOption('width',t.width),null!=this.options.height||this.setOption('height',t.height),'undefined'!=typeof ImageData&&null!=ImageData&&t instanceof ImageData)a.data=t.data;else if('undefined'!=typeof CanvasRenderingContext2D&&null!=CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||'undefined'!=typeof WebGLRenderingContext&&null!=WebGLRenderingContext&&t instanceof WebGLRenderingContext)i.copy?a.data=this.getContextData(t):a.context=t;else if(null!=t.childNodes)i.copy?a.data=this.getImageData(t):a.image=t;else throw new Error('Invalid image');return this.frames.push(a)},t.prototype.render=function(){var t,i;if(this.running)throw new Error('Already running');if(null==this.options.width||null==this.options.height)throw new Error('Width and height must be set prior to rendering');this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(i){for(var n=function(){var e=[];for(var t=0;0<=this.frames.length?t<this.frames.length:t>this.frames.length;0<=this.frames.length?++t:--t)e.push(t);return e}.apply(this,arguments),o=0,a=n.length;o<a;++o)t=n[o],i.push(null);return i}.call(this,[]),i=this.spawnWorkers();for(var a=function(){var e=[];for(var t=0;0<=i?t<i:t>i;0<=i?++t:--t)e.push(t);return e}.apply(this,arguments),n=0,o=a.length;n<o;++n)t=a[n],this.renderNextFrame();return this.emit('start'),this.emit('progress',0)},t.prototype.abort=function(){for(var e;!0&&!(e=this.activeWorkers.shift(),null==e);)console.log('killing active worker'),e.terminate();return this.running=!1,this.emit('abort')},t.prototype.spawnWorkers=function(){var e;return e=Math.min(this.options.workers,this.frames.length),function(){var t=[];for(var i=this.freeWorkers.length;this.freeWorkers.length<=e?i<e:i>e;this.freeWorkers.length<=e?++i:--i)t.push(i);return t}.apply(this,arguments).forEach(function(e){return function(t){var i;return console.log('spawning worker '+t),i=new Worker(e.options.workerScript),i.onmessage=function(e){return function(t){return e.activeWorkers.splice(e.activeWorkers.indexOf(i),1),e.freeWorkers.push(i),e.frameFinished(t.data)}}(e),e.freeWorkers.push(i)}}(this)),e},t.prototype.frameFinished=function(e){return console.log('frame '+e.index+' finished - '+this.activeWorkers.length+' active'),this.finishedFrames++,this.emit('progress',this.finishedFrames/this.frames.length),this.imageParts[e.index]=e,o(null,this.imageParts)?this.renderNextFrame():this.finishRendering()},t.prototype.finishRendering=function(){var t,e,a,n,o,r,s;o=0;for(var d=0,u=this.imageParts.length;d<u;++d)e=this.imageParts[d],o+=(e.data.length-1)*e.pageSize+e.cursor;o+=e.pageSize-e.cursor,console.log('rendering finished - filesize '+Math.round(o/1e3)+'kb'),t=new Uint8Array(o),r=0;for(var p=0,g=this.imageParts.length;p<g;++p){e=this.imageParts[p];for(var l=0,c=e.data.length;l<c;++l)s=e.data[l],a=l,t.set(s,r),r+=a===e.data.length-1?e.cursor:e.pageSize}return n=new Blob([t],{type:'image/gif'}),this.emit('finished',n,t)},t.prototype.renderNextFrame=function(){var e,t,i;if(0===this.freeWorkers.length)throw new Error('No free workers');return this.nextFrame>=this.frames.length?void 0:(e=this.frames[this.nextFrame++],i=this.freeWorkers.shift(),t=this.getTask(e),console.log('starting frame '+(t.index+1)+' of '+this.frames.length),this.activeWorkers.push(i),i.postMessage(t))},t.prototype.getContextData=function(e){return e.getImageData(0,0,this.options.width,this.options.height).data},t.prototype.getImageData=function(e){var t;return null!=this._canvas||(this._canvas=document.createElement('canvas'),this._canvas.width=this.options.width,this._canvas.height=this.options.height),t=this._canvas.getContext('2d'),t.setFill=this.options.background,t.fillRect(0,0,this.options.width,this.options.height),t.drawImage(e,0,0),this.getContextData(t)},t.prototype.getTask=function(e){var t,a;if(t=this.frames.indexOf(e),a={index:t,last:t===this.frames.length-1,delay:e.delay,transparent:e.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,repeat:this.options.repeat,canTransfer:'chrome'===i.name},null!=e.data)a.data=e.data;else if(null!=e.context)a.data=this.getContextData(e.context);else if(null!=e.image)a.data=this.getImageData(e.image);else throw new Error('Invalid frame');return a},t}(l),a.exports=d}),t.define('/browser.coffee',function(t){var i,a,n,e,o;e=navigator.userAgent.toLowerCase(),n=navigator.platform.toLowerCase(),o=e.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,'unknown',0],a='ie'===o[1]&&document.documentMode,i={name:'version'===o[1]?o[3]:o[1],version:a||parseFloat('opera'===o[1]&&o[4]?o[4]:o[2]),platform:{name:e.match(/ip(?:ad|od|hone)/)?'ios':(e.match(/(?:webos|android)/)||n.match(/mac|win|linux/)||['other'])[0]}},i[i.name]=!0,i[i.name+parseInt(i.version,10)]=!0,i.platform[i.platform.name]=!0,t.exports=i}),t.define('events',function(t,n){i.EventEmitter||(i.EventEmitter=function(){});var e=n.EventEmitter=i.EventEmitter,o='function'==typeof Array.isArray?Array.isArray:function(e){return'[object Array]'===Object.prototype.toString.call(e)};e.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},e.prototype.emit=function(t){if('error'===t&&(!(this._events&&this._events.error)||o(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error('Uncaught, unspecified \'error\' event.');if(!this._events)return!1;var i=this._events[t];if(!i)return!1;if('function'!=typeof i){if(o(i)){for(var n=Array.prototype.slice.call(arguments,1),r=i.slice(),e=0,s=r.length;e<s;e++)r[e].apply(this,n);return!0}return!1}switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);i.apply(this,n);}return!0},e.prototype.addListener=function(t,i){if('function'!=typeof i)throw new Error('addListener only takes instances of Function');if(this._events||(this._events={}),this.emit('newListener',t,i),!this._events[t])this._events[t]=i;else if(o(this._events[t])){if(!this._events[t].warned){var a;a=void 0===this._events.maxListeners?10:this._events.maxListeners,a&&0<a&&this._events[t].length>a&&(this._events[t].warned=!0,console.error('(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.',this._events[t].length),console.trace())}this._events[t].push(i)}else this._events[t]=[this._events[t],i];return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(e,t){var i=this;return i.on(e,function a(){i.removeListener(e,a),t.apply(this,arguments)}),this},e.prototype.removeListener=function(t,i){if('function'!=typeof i)throw new Error('removeListener only takes instances of Function');if(!(this._events&&this._events[t]))return this;var a=this._events[t];if(o(a)){var n=a.indexOf(i);if(0>n)return this;a.splice(n,1),0==a.length&&delete this._events[t]}else this._events[t]===i&&delete this._events[t];return this},e.prototype.removeAllListeners=function(e){return e&&this._events&&this._events[e]&&(this._events[e]=null),this},e.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),o(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}),e.GIF=t('/gif.coffee')}).call(this,this)},function(e,t,i){function a(e,t,i,a){return function(n,o){const r=this,s=e||n,l=t?document.querySelector(t):this.el;if(!l)return void console.warn('Couldn\'t subscribe '+this.name+'.'+n+' to '+s+' on '+t+' because querySelector returned undefined.');const d=i||'init',c=a||'remove',u=this[d],p=this[c],g=o.bind(this);return this[d]=function(){void 0!==u&&u.apply(r,arguments),l.addEventListener(s,g)},this[c]=function(){void 0!==p&&p.apply(r,arguments),l.removeEventListener(s,g)},o}}const n=i(11).decorate;e.exports.bindEvent=function(e,t){if('function'==typeof e)return n(e,a());if('object'==typeof e&&'function'==typeof t)return n(t,a(e.event,e.target,e.listenIn,e.removeIn));throw new Error('bindEvent must take: (function), or a ([object], function)')},e.exports.bindEventPlayPause=function(e,t){if('function'==typeof e)return n(e,a(void 0,void 0,'play','pause'));if('object'==typeof e&&'function'==typeof t)return n(t,a(e.event,e.target,'play','pause'));throw new Error('bindEventPlayPause must take: (function), or a ([object], function)')}},function(e){function i(e,i,n,a){return e+i*a+0.5*n*a*a}e.exports=function(e,n,o,a,t){return t.x=i(e.x,n.x,o.x,a),t.y=i(e.y,n.y,o.y,a),t.z=i(e.z,n.z,o.z,a),t}},function(e){var t=function(e,t){this.geometry=new THREE.BufferGeometry,this.vertices=new Float32Array(2*(3*e)),this.uvs=new Float32Array(2*(2*e)),this.width=t,this.geometry.addAttribute('position',new THREE.BufferAttribute(this.vertices,3).setDynamic(!0)),this.material=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:16711680}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.drawMode=THREE.TriangleStripDrawMode,this.mesh.frustumCulled=!1,this.mesh.vertices=this.vertices,this.direction=new THREE.Vector3,this.numPoints=e};t.prototype={setDirection:function(e){var t=new THREE.Vector3(0,1,0);this.direction.copy(e).cross(t).normalize().multiplyScalar(this.width/2)},setWidth:function(e){this.width=e},setPoint:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(a,i){e.copy(i).add(this.direction),t.copy(i).sub(this.direction);var n=6*a;this.vertices[n++]=e.x,this.vertices[n++]=e.y,this.vertices[n++]=e.z,this.vertices[n++]=t.x,this.vertices[n++]=t.y,this.vertices[n++]=t.z,this.geometry.attributes.position.needsUpdate=!0}}()},e.exports=t},function(e){e.exports='url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAQCAYAAADXnxW3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAADJJREFUeNpEx7ENgDAAAzArK0JA6f8X9oewlcWStU1wBGdwB08wgjeYm79jc2nbYH0DAC/+CORJxO5fAAAAAElFTkSuQmCC)'},function(e,t,i){function a(e,t){function a(){n++,n===e.children.length&&t()}var n=0,o;for(o=0;o<e.children.length;o++){if(e.children[o].hasLoaded){n++;continue}e.children[o].addEventListener('loaded',a)}}var n=i(7);i(14),i(27),i(26),i(28),i(29);var o=new THREE.FileLoader;AFRAME.registerComponent('supercraft-loader',{schema:{includeEnvironment:{default:!0},includeShadows:{default:!0},name:{type:'string'},src:{type:'asset'}},init:function(){this.onLoad=this.onLoad.bind(this)},update:function(){var e=this.data,t=this.el,i;(e.src||e.name)&&(e.includeShadows&&t.setAttribute('shadow',''),i=e.name?'https://supercraftsite.s3-us-west-2.amazonaws.com/'+e.name:e.src,t.setAttribute('geometry-merger','isParentMerger',!0),t.setAttribute('super-material',''),o.load(i,(e)=>{this.generate(JSON.parse(e)),a(t,this.onLoad)}))},generate:function(e){var t=this.el,i,a,o,r;for(r in this.data.includeEnvironment&&(i=e.environment?e.environment.presetColor||e.environment.preset:'teal',t.setAttribute('super-environment-updater',{preset:i})),e.entities)a=e.entities[r],o=n.createThing(a),t.appendChild(o)},onLoad:function(){this.el.emit('supercraftloaderloaded')}}),AFRAME.registerComponent('supercraft-visualizer',{schema:{autoplay:{default:!1},deprioritizeThings:{type:'array'},dur:{default:2e3},name:{type:'string'},prioritizeThings:{type:'array'},src:{type:'asset'}},init:function(){this.queueThing=this.queueThing.bind(this),this.currentIndex=0,this.entityIndex={},this.isPlaying=!1,this.isLoaded=!1,this.shapes=[],this.start=!1,this.thingEls={},this.thingIds=[],this.time=void 0,this.el.addEventListener('supercraftvisualizerstart',()=>{this.reset(),this.start=!0})},update:function(e){var t=this.data,i=this.el,a;this.sData&&e.dur!==t.dur&&this.setData(this.sData);(t.src||t.name)&&(i.setAttribute('shadow',''),a=t.name?'https://supercraftsite.s3-us-west-2.amazonaws.com/'+t.name:t.src,o.load(a,(e)=>{var t=JSON.parse(e);this.createEnvironment(t),this.setData(t)}))},createEnvironment:function(e){var t;t=e.environment?e.environment.presetColor||e.environment.preset:'teal',this.el.sceneEl.setAttribute('super-environment-updater',{preset:t})},setData:function(e){var t,i;for(t in this.sData=e,e.entities)for(i in this.entityIndex[t]=e.entities[t],e.entities[t].shapes)this.entityIndex[i]=e.entities[t].shapes[i];for(t in e.entities)-1===this.data.deprioritizeThings.indexOf(t)&&this.thingIds.push(t);this.thingIds.sort((e,t)=>e<t?-1:e===t?0:e>t?1:void 0),this.data.prioritizeThings.forEach(this.queueThing),this.thingIds.forEach(this.queueThing),this.data.deprioritizeThings.forEach(this.queueThing),this.offset=this.data.dur/this.shapes.length,this.data.autoplay&&(this.start=!0),this.isLoaded=!0},queueThing:function(e){var t,i;for(t in i=this.entityIndex[e],i.shapes)-1===this.shapes.indexOf(i.shapes[t])&&this.shapes.push(this.entityIndex[t])},renderShape:function(e){var t,i;t=this.shapes[e],i=this.thingEls[t.parentId],i||(i=n.createEntity(this.entityIndex[t.parentId].attributes),this.thingEls[t.parentId]=i,this.el.appendChild(i)),i.appendChild(n.createEntity(t.attributes))},reset:function(){this.currentIndex=0,this.el.innerHTML='',this.thingEls={},this.time=void 0},tick:function(e,t){if(this.start&&this.isLoaded)return this.isPlaying=!0,this.start=!1,void(this.time=0);if(this.isPlaying)for(this.time+=t;this.time>this.currentIndex*this.offset;){if(this.currentIndex>=this.shapes.length)return void(this.isPlaying=!1);this.renderShape(this.currentIndex),this.currentIndex++}}})},function(e){e.exports=[{title:'Blank',image:'assets/img/templates/blank.jpg',name:'blank'},{title:'Castle',image:'assets/img/templates/castle.jpg',name:'icky-snake'},{title:'Blimps',image:'assets/img/templates/blimps.jpg',name:'fierce-talk'},{title:'Moment',image:'assets/img/templates/moment.jpg',name:'better-reaction'},{title:'Dragon',image:'assets/img/templates/dragon.jpg',name:'bawdy-wealth'},{title:'Office',image:'assets/img/templates/office.jpg',name:'deafening-chair'},{title:'Artist',image:'assets/img/templates/artist.jpg',name:'lamentable-net'},{title:'Forest',image:'assets/img/templates/forest.jpg',name:'pleasant-waste'},{title:'Midnight Thoughts',image:'assets/img/templates/midnightthoughts.jpg',name:'changeable-pail'},{title:'Mecha',image:'assets/img/templates/mecha.jpg',name:'cooperative-potato'},{title:'Toy Mountain',image:'assets/img/templates/toymountain.jpg',name:'shocking-hose'},{title:'Cave',image:'assets/img/templates/cave.jpg',name:'wealthy-doc'},{title:'Homer',image:'assets/img/templates/homer.jpg',name:'dangerous-cars'},{title:'Danger',image:'assets/img/templates/danger.jpg',name:'onerous-chalk'},{title:'Powerpuff',image:'assets/img/templates/powerpuff.jpg',name:'previous-acoustics'},{title:'Canyon',image:'assets/img/templates/canyon.jpg',name:'optimal-marble'},{title:'Incredibles',image:'assets/img/templates/incredibles.jpg',name:'cumbersome-police'}]},function(e){e.exports=[{image:'assets/img/tutorial/overview.jpg',title:'Overview',text:'Supercraft lets you build VR worlds with your hands, then instantly share them via the Web to be viewed on any device!'},{image:'assets/img/tutorial/starting.jpg',title:'Starting a Site',text:'Click *Create New Site*. Your site will be given a random name for now. From the Site menu, you can publish your site. To create a Thing, click the Shapes icon to start crafting a Thing.'},{image:'assets/img/tutorial/addingshapes.jpg',title:'Adding Shapes',text:'Point at a Shape, and hold down the trigger to drag it into the Site. Let go to place the Shape in the Site. You can continue to add Shapes and grab them to move them around.'},{image:'assets/img/tutorial/resizing.jpg',title:'Drag Resizing',text:'To change the size of a Shape, hover your controller over the Shape to select it. Then drag the blue diamond on the box around the shape to resize it. Use the trigger to resize freely, or use the thumbpad to resize while maintaining proportions.'},{image:'assets/img/tutorial/airscaling.jpg',title:'Air Resizing',text:'Another way to resize is to hold down both triggers and use your hands to stretch or squeeze the object. Air resizing makes it easier to scale in a direction or if object is small, large, or far away.'},{image:'assets/img/tutorial/zoom.jpg',title:'Zoom + Pan',text:'Zoom out or make yourself bigger by holding down both grips and moving your arms together (similar to pinching). And vice-versa for zooming in or making yourself bigger. The grips can also be used to drag or rotate yourself.'},{image:'assets/img/tutorial/coloring.jpg',title:'Coloring Shapes',text:'Click the palette icon to color your shapes. Point at a color and click the trigger to select a color. Then point at a Shape and click the trigger to color the Shape.'},{image:'assets/img/tutorial/cloning.jpg',title:'Cloning',text:'Hover over a Shape and hold down the Clone icon on the thumb. Then move the cloned Shape to the desired position.'},{image:'assets/img/tutorial/delete.jpg',title:'Deleting',text:'Hold down the Delete icon on the thumb. Then hover over the Shape you want to delete. The Shape will highlight red. Let go to confirm deletion.'},{image:'assets/img/tutorial/grid.jpg',title:'Grid Snap',text:'To toggle Grid mode, press the Grid icon on the thumb. This will snap Shape positions and rotations to a grid for easy alignment. '},{image:'assets/img/tutorial/things.jpg',title:'Things / Groups',text:'While we were manipulating Shapes, Things are groups of Shapes that can be manipulated in the same manner. Create a bunch of Shapes, then go back to the Site menu. From there you can modify the group of Shapes (i.e, a Thing) a a group.'},{image:'assets/img/tutorial/publish.jpg',title:'Publish + Share',text:'To publish your Site, click on Publish button from the Site menu. The same button is used to update the Site. Your Site is then accessible to other Supermedium + Supercraft users and from any browser via the URL (i.e., supermedium.com/craft/my-site).'},{image:'assets/img/tutorial/load.jpg',title:'Save + Load',text:'You can work on multiple Sites at once. Sites autosave. Whenever you wish to work on a new Site, click New in the Main menu. To switch between previous Sites, click on Load and select based on the Site name (currently randomly assigned).'}]},function(e,t,i){e.exports=function(){return i(204)('(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.i=function(a){return a},b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a[\'default\']}:function(){return a};return b.d(c,\'a\',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p=\'\',b(b.s=0)})([function(){self.addEventListener(\'message\',function(a){self.postMessage(JSON.parse(a.data)),self.close()},!1)}]);',i.p+'5948fc7c3c2c8169dd30.worker.js')}},function(e,t,i){var a=Math.abs,n=Math.round,o=Math.max,r=i(8);AFRAME.registerComponent('air-scaler',{schema:{cameraScaleFactor:{default:1},entityId:{type:'string'},gridTransform:{default:!1}},init:function(){this.activeEl=null,this.airScaleEventDetail={},this.handEl=null,this.isScaling=!1,this.isScalingAfterAxisDetection=!1,this.isUniformScaling=!1,this.originalCenter=new THREE.Vector3,this.secondaryHandEl=null,this.scaleStart=!1},tick:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Box3;return function(a){var n=this.activeEl;this.isScaling&&(this.isUniformScaling?this.scaleUniform():this.scaleAxis(a),n.classList.contains('thing')&&(i.setFromObject(n.object3D),t.copy(i.min).add(i.max).divideScalar(2),e.copy(t).sub(this.originalCenter),n.object3D.position.sub(e)))}}(),scaleAxis:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3;return function(){var c=this.activeEl,u=this.handEl,p,g;return this.isScaling?this.scaleStart?(l.copy(c.object3D.position),d.copy(c.object3D.scale),this.originalHandDistance=this.getHandDistance(),u.object3D.getWorldPosition(s),void(this.scaleStart=!1)):void(c.object3D.scale.copy(d),c.object3D.position.copy(l),c.object3D.updateMatrixWorld(),u.object3D.getWorldPosition(t),c.object3D.worldToLocal(t),n.copy(s),c.object3D.worldToLocal(n),i.copy(t).sub(n),!this.axis&&(this.secondaryHandEl.object3D.getWorldPosition(e),c.object3D.worldToLocal(e),e.sub(t).normalize(),this.axis='x',a(e.y)>a(e[this.axis])&&(this.axis='y'),a(e.z)>a(e[this.axis])&&(this.axis='z')),p=this.getHandDistance(),g=p-this.originalHandDistance,c.object3D.scale.copy(d),c.object3D.scale[this.axis]+=g*20,this.data.gridTransform&&r.snapScale(c.object3D.scale,this.data.cameraScaleFactor),c.object3D.scale[this.axis]=o(c.object3D.scale[this.axis],1e-3)):void 0}}(),scaleUniform:function(){var e=new THREE.Vector3,t;return function(){var i=this.activeEl,a,n;return this.scaleStart?(e.copy(i.object3D.scale),t=this.getHandDistance(),void(this.scaleStart=!1)):void(a=this.getHandDistance(),n=a-t,i.object3D.scale.copy(e).multiplyScalar(1+n),this.data.gridTransform&&r.snapScale(i.object3D.scale,this.data.cameraScaleFactor),i.object3D.scale.x=o(i.object3D.scale.x,1e-3),i.object3D.scale.y=o(i.object3D.scale.y,1e-3),i.object3D.scale.z=o(i.object3D.scale.z,1e-3))}}(),startAirScaling:function(){var e=new THREE.Box3;return function(t){var i=this.activeEl;this.isScaling=!0,this.isUniformScaling=t,this.scaleStart=!0,this.scaleStartTime=this.el.time,-1!==i.classList.contains('thing')&&(e.setFromObject(i.object3D),this.originalCenter.copy(e.min).add(e.max).divideScalar(2)),this.el.emit('airscalestart'),t&&this.el.emit('uniformscalestart')}}(),stopAirScaling:function(){var e=this.activeEl;this.isScaling&&(this.isScaling=!1,this.isScalingAfterAxisDetection=!1,this.airScaleEventDetail.id=e.getAttribute('id'),this.airScaleEventDetail.scale=e.getAttribute('scale'),this.airScaleEventDetail.position=e.getAttribute('position'),this.el.emit('airscaleend',this.airScaleEventDetail),this.isUniformScaling&&this.el.emit('uniformscaleend'),this.axis='',this.originalHandDistance=void 0)},getHandDistance:function(){var e=new THREE.Vector3;return function(){return e.copy(this.handEl.object3D.position).sub(this.secondaryHandEl.object3D.position).length()}}(),applyGrid:function(e){var t;t=GRID_SNAP*o(n(this.data.cameraScaleFactor),1),e.set(n(e.x/t)*t,n(e.y/t)*t,n(e.z/t)*t)},activateAirScaling:function(){this.data.entityId&&(this.activeEl=document.getElementById(this.data.entityId),this.activeEl&&(this.isAirScalingActive=!0,this.el.emit('airscaleactivate')))},deactivateAirScaling:function(){this.isAirScalingActive&&(this.isAirScalingActive=!1,this.el.emit('airscaledeactivate'))},registerHand:function(e){this.handEl=e},registerSecondaryHand:function(e){this.secondaryHandEl=e}}),AFRAME.registerComponent('air-scaler-activator',{schema:{enabled:{default:!1}},init:function(){var e=this.el,t=this,i;return i=e.sceneEl.components['air-scaler'],i?void(i.registerSecondaryHand(e),this.isAirScaleActive=!1,e.addEventListener('triggerdown',()=>{this.data.enabled&&(i.activateAirScaling(),this.isAirScaleActive=!0)}),e.addEventListener('triggerup',()=>{this.isAirScaleActive&&(i.deactivateAirScaling(),this.isAirScaleActive=!1)})):void e.sceneEl.addEventListener('componentinitialized',function i(a){'air-scaler'!==a.detail.name||(t.init(),e.sceneEl.removeEventListener('componentinitialized',i))})}}),AFRAME.registerComponent('air-scaler-starter',{dependencies:['tracked-controls'],schema:{enabled:{default:!1}},init:function(){var e=this.el,t=this,i;return this.iScaling=!1,i=e.sceneEl.components['air-scaler'],i?void(i.registerHand(e),e.addEventListener('triggerdown',()=>{this.data.enabled&&(i.startAirScaling(),this.isAirScaling=!0)}),e.addEventListener('triggerup',()=>{this.isAirScaling&&i.stopAirScaling()}),e.addEventListener('thumbstart',()=>{this.data.enabled&&(i.startAirScaling(!0),this.isAirScaling=!0)}),e.addEventListener('thumbend',()=>{this.isAirScaling&&i.stopAirScaling()})):void e.sceneEl.addEventListener('componentinitialized',function i(a){'air-scaler'!==a.detail.name||(t.init(),e.sceneEl.removeEventListener('componentinitialized',i))})}})},function(){AFRAME.registerComponent('background-audio',{schema:{song:{type:'asset'},volume:{default:0.5}},init:function(){var e;AFRAME.utils.getUrlParameter('debug')||(e=new Audio(this.data.song),e.volume=this.data.volume,e.loop=!0,e.play())}})},function(){var e={color:'#585858',isActive:!0};AFRAME.registerComponent('blur-things',{schema:{isBlurred:{default:!1}},update:function(e){return this.data.isBlurred?void setTimeout(()=>{this.blurThings()}):void(e.isBlurred&&!this.data.isBlurred&&this.unblurThings())},blurThings:function(){var t,i;for(i=this.el.querySelectorAll('.thing:not([data-staged])'),t=0;t<i.length;t++)i[t].setAttribute('geometry-merger-temporary-color',e)},unblurThings:function(){var e,t;for(t=this.el.querySelectorAll('.thing'),e=0;e<t.length;e++)t[e].setAttribute('geometry-merger-temporary-color','isActive',!1)}})},function(){new THREE.Object3D;AFRAME.registerComponent('bounding-box',{schema:{color:{default:'blue'},enabled:{default:!1},entityId:{type:'string'},highlightColor:{default:'orange'},isHighlighted:{default:!1},siteName:{type:'string'}},init:function(){this.box=new THREE.Box3,this.boxHelper=new THREE.Box3Helper(this.box,2411263),this.el.sceneEl.object3D.add(this.boxHelper),this.minObject3D=new THREE.Object3D,this.maxObject3D=new THREE.Object3D,this.min=this.minObject3D.position,this.max=this.maxObject3D.position},update:function(e){e.entityId!==this.data.entityId&&(this.data.entityId?(this.boxHelper.visible=!1,this.targetEl=document.getElementById(this.data.entityId),this.tock(),this.isNewTarget=!0):(this.targetEl=null,this.boxHelper.visible=!1)),(e.isHighlighted!==this.data.isHighlighted||this.isNewTarget)&&this.boxHelper.material.color.set(this.data.isHighlighted?this.data.highlightColor:this.data.color),this.data.enabled||(this.boxHelper.visible=!1),e.enabled!==this.data.enabled&&this.data.enabled&&this.targetEl&&(this.boxHelper.visible=!0)},tock:function(){var e=new THREE.Euler,t=new THREE.Euler;return function(){var i=this.targetEl;i&&i.hasLoaded&&this.data.enabled&&(this.isNewTarget&&(this.boxHelper.visible=!0,this.isNewTarget=!1),e.copy(i.object3D.rotation),t.copy(i.object3D.parent.rotation),i.object3D.rotation.set(0,0,0),i.object3D.parent.rotation.set(0,0,0),i.object3D.updateMatrixWorld(),i.object3D.parent.updateMatrixWorld(),this.box.setFromObject(i.object3D),this.updateMinMaxHelpers(),this.boxHelper.onBeforeRender(),i.object3D.rotation.copy(e),i.object3D.parent.rotation.copy(t),i.object3D.parent.updateMatrixWorld(),i.object3D.updateMatrixWorld(),i.object3D.getWorldPosition(this.boxHelper.position),i.object3D.getWorldQuaternion(this.boxHelper.quaternion))}}(),updateMinMaxHelpers:function(){var e=this.minObject3D,t=this.maxObject3D,i=this.targetEl;i.object3D.updateMatrixWorld(),i.object3D.worldToLocal(e.position.copy(this.box.min)),i.object3D.worldToLocal(t.position.copy(this.box.max)),e.parent!==i.object3D&&(i.object3D.add(e),i.object3D.add(t))}})},function(){function e(e,t){var a,n;return a=e.angleTo(t),n=e.clone().cross(t),0>i.dot(n)&&(a=-a),a}var t=Math.atan2,i=new THREE.Vector3(0,1,0);AFRAME.registerComponent('camera-scaler',{schema:{enabled:{default:!1},cameraRigId:{default:'cameraRig'}},init:function(){this.cameraEl=document.getElementById(this.data.cameraId),this.cameraRigEl=document.getElementById(this.data.cameraRigId),this.currentDragCenter=new THREE.Vector3,this.panningController=null,this.controllers={left:{entity:null,dragging:!1,dragStartPoint:new THREE.Vector3},right:{entity:null,dragging:!1,dragStartPoint:new THREE.Vector3}},this.originalPosition=new THREE.Vector3,this.originalScale=new THREE.Vector3,this.originalRotation=new THREE.Vector3,this.leftGripDown=!1,this.rightGripDown=!1,this.cameraScaleEventDetail={cameraScaleFactor:1,originalPosition:new THREE.Vector3}},update:function(e){var t=this.cameraRigEl;!e.enabled&&this.data.enabled&&(this.originalPosition.copy(t.object3D.position),this.originalScale.copy(t.object3D.scale),this.originalRotation.copy(t.getAttribute('rotation'))),e.enabled&&!this.data.enabled&&(t.setAttribute('position',this.originalPosition),t.setAttribute('scale',this.originalScale),t.setAttribute('rotation',this.originalRotation.clone()))},tick:function(){this.data.enabled&&(this.isLeftGripDown||this.isRightGripDown)&&(this.isLeftGripDown&&this.isRightGripDown?this.twoHandInteraction():this.processPanning())},onGripDown:function(e){var t,i;this.cameraRigEl.object3D&&(i=e.target,t=i===this.leftHandEl,t?(this.isLeftGripDown=!0,this.panningController=this.controllers.left):(this.isRightGripDown=!0,this.panningController=this.controllers.right),this.panningController.entity.object3D.getWorldPosition(this.panningController.dragStartPoint),this.released=this.isLeftGripDown&&this.isRightGripDown)},onGripUp:function(e){var t,i;i=e.target,t=e.target===this.leftHandEl,t?(this.panningController=this.controllers.right,this.isLeftGripDown=!1):(this.panningController=this.controllers.left,this.isRightGripDown=!1),this.panningController.entity.object3D.getWorldPosition(this.panningController.dragStartPoint),this.isLeftGripDown||this.isRightGripDown||(this.cameraScaleEventDetail.cameraScaleFactor=this.cameraRigEl.object3D.scale.x,this.el.emit('camerascale',this.cameraScaleEventDetail)),this.released=!0},twoHandInteraction:function(){var i=new THREE.Vector3,a=new THREE.Line3,n=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Line3;return function(){var a,s,l,u,p;this.leftHandEl.object3D.getWorldPosition(o),this.rightHandEl.object3D.getWorldPosition(r),this.released&&(this.prevAngle=e(o,r),this.initAngle=this.prevAngle=t(o.x-r.x,o.z-r.z),d.copy(o).add(r).multiplyScalar(0.5),this.prevDistance=c.copy(o).sub(r).length(),this.released=!1),s=n.copy(o).sub(r).length(),u=this.prevDistance-s,i.copy(this.leftHandEl.object3D.position).add(this.rightHandEl.object3D.position).multiplyScalar(0.5),this.cameraRigEl.object3D.scale.x===this.originalScale.x&&this.cameraRigEl.object3D.scale.y===this.originalScale.y&&this.cameraRigEl.object3D.scale.z===this.originalScale.z&&this.el.sceneEl.camera.el.object3D.getWorldPosition(this.cameraScaleEventDetail.originalPosition),this.cameraRigEl.object3D.scale.addScalar(u),this.cameraRigEl.setAttribute('scale',this.cameraRigEl.object3D.scale),p=i.applyQuaternion(this.cameraRigEl.object3D.quaternion).multiplyScalar(u),this.cameraRigEl.object3D.position.sub(p),this.cameraRigEl.setAttribute('position',this.cameraRigEl.object3D.position),a=t(o.x-r.x,o.z-r.z),l=a-this.prevAngle,this.rotateScene(d,l),this.prevAngle=a-l}}(),rotateScene:function(){var e=new THREE.Vector3;return function(t,a){var n=this.cameraRigEl,o;e.copy(n.object3D.position).sub(t).applyAxisAngle(i,-a),n.object3D.position.copy(t).add(e),n.setAttribute('position',n.object3D.position),o=n.getAttribute('rotation'),o.y-=a*THREE.Math.RAD2DEG,n.setAttribute('rotation',o)}}(),processPanning:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){var i=this.panningController.dragStartPoint;this.panningController.entity.object3D.getWorldPosition(e),t.copy(i).sub(e),this.cameraRigEl.object3D.position.add(t),this.cameraRigEl.setAttribute('position',this.cameraRigEl.object3D.position)}}(),registerHand:function(e,t){this.controllers[t].entity=e,e.addEventListener('gripdown',this.onGripDown.bind(this)),e.addEventListener('gripup',this.onGripUp.bind(this)),'left'===t?this.leftHandEl=e:this.rightHandEl=e}}),AFRAME.registerComponent('camera-scaler-hand',{schema:{hand:{default:'right'}},play:function(){this.el.sceneEl.components['camera-scaler'].registerHand(this.el,this.data.hand)}})},function(){AFRAME.registerComponent('cloner',{schema:{enabled:{default:!1}},init:function(){this.isCloning=!1,this.el.addEventListener('thumbdownstart',this.cloneStart.bind(this)),this.el.addEventListener('thumbdownend',this.cloneEnd.bind(this))},cloneStart:function(){!this.data.enabled||this.isCloning||(this.isCloning=!0,this.el.sceneEl.emit('clonestart',null,!1))},cloneEnd:function(){this.isCloning&&(this.isCloning=!1,this.el.sceneEl.emit('cloneend',null,!1))}})},function(){AFRAME.registerComponent('collidable',{})},function(){AFRAME.registerComponent('collider-highlight',{schema:{enabled:{default:!1}},init:function(){var e=this.el;this.eventDetail={el:null},e.addEventListener('hitclosest',(t)=>{var i,a;if(this.data.enabled)return i=t.detail.el,a=!i.classList.contains('shape')&&!i.classList.contains('thing'),a||!SUPERCRAFT.utils.isEditable(i)?void e.sceneEl.emit('touchentityend',null,!1):void(this.eventDetail.id=i.getAttribute('id'),e.sceneEl.emit('touchentitystart',this.eventDetail,!1))}),e.addEventListener('hitclosestclear',()=>{this.data.enabled&&setTimeout(()=>{var t;t=e.components['aabb-collider'].intersectedEl,SUPERCRAFT.utils.isEditable(t)||e.sceneEl.emit('touchentityend',null,!1)})})}})},function(){AFRAME.registerComponent('colorer',{schema:{color:{default:'F75A34'},enabled:{default:!1}},init:function(){var e=this.el,t;this.intersectedEl=null,this.originalColor='',t={},this.superMaterialColoring={type:'faded'},this.superMaterialNormal={type:'phong'},e.addEventListener('mouseenter',(e)=>{e.detail&&this.data.enabled&&SUPERCRAFT.utils.isEditable(e.detail.intersectedEl)&&(this.intersectedEl=e.detail.intersectedEl,this.originalColor=this.intersectedEl.getAttribute('super-material').color,this.superMaterialColoring.color=this.data.color,this.intersectedEl.setAttribute('super-material',this.superMaterialColoring))}),e.addEventListener('mouseleave',this.onMouseLeave.bind(this)),e.addEventListener('click',()=>{this.intersectedEl&&this.data.enabled&&(this.superMaterialNormal.color=this.data.color,this.intersectedEl.setAttribute('super-material',this.superMaterialNormal),t.baseColor=this.data.color,t.id=this.intersectedEl.getAttribute('id'),this.originalColor=this.data.color,e.emit('colorentity',t))})},update:function(e){e.enabled&&!this.data.enabled&&this.onMouseLeave()},onMouseLeave:function(){this.intersectedEl&&(this.superMaterialNormal.color=this.originalColor,this.intersectedEl.setAttribute('super-material',this.superMaterialNormal),this.intersectedEl=null)}})},function(){AFRAME.registerComponent('console-shortcuts',{play:function(){window.$=(e)=>document.querySelector(e),window.$$=(e)=>document.querySelectorAll(e),window.$$$=(e)=>document.querySelector(`[${e}]`).getAttribute(e),window.$$$$=(e)=>document.querySelector(`[${e}]`).components[e],window.scene=this.el,window.state=this.el.systems.state.state}})},function(){AFRAME.registerComponent('controller-button-feedback',{init:function(){this.el.addEventListener('controllerrender',this.setupButtons.bind(this))},setupButtons:function(){var e,t;this.trigger=null,this.thumbstick=null,e=this.el.querySelector('.controllerTrigger'),e&&e.addEventListener('object3dset',()=>{this.trigger=e.getObject3D('mesh')}),t=this.el.querySelector('.controllerThumbstick'),t&&t.addEventListener('object3dset',()=>{this.thumbstick=t.getObject3D('mesh')})},tick:function(){var e=this.el,t=this.thumbstick,i=this.trigger,a;a=e.components['tracked-controls'];a&&(i&&a.buttonStates[1]&&(i.rotation.x=THREE.Math.lerp(0,-Math.PI/9,a.buttonStates[1].value)),t&&(t.rotation.z=0.4*-a.axis[0],t.rotation.x=0.4*a.axis[1]))}})},function(){function e(e){return'right'===e?'left':'right'}var t=Math.atan,a=Math.abs,i={right:{hand:'right',model:!1},left:{hand:'left',model:!1}},n='[data-hand="left"]',o='[data-hand="right"]',r='[data-controller="oculus-touch-controls"]',s='[data-controller="vive-controls"]',l=['controllerTipEraser','controllerTipMarker','controllerTipNormal'],d={controllerTipMarker:THREE.Math.degToRad(15),controllerTipNormal:THREE.Math.degToRad(5)};AFRAME.registerComponent('controller',{schema:{controllerType:{default:''},hand:{default:'right'},handPrimary:{default:'right'}},init:function(){this.config={"oculus-touch-controls":{collider:{primitive:'box',depth:0.18,width:0.1,height:0.1},grabPose:{addPosition:{x:0,y:-0.15,z:-0.125},addRotation:{x:THREE.Math.degToRad(-45),y:0,z:0}},menuRotation:THREE.Math.degToRad(-90),raycaster:{direction:new THREE.Vector3(0,-2,-1).normalize(),origin:{x:0,y:-0.027,z:-0.02}},teleporterDirection:{x:0,y:-1.25,z:-1},templates:{left:document.querySelector(`${n}${r}`).innerHTML,right:document.querySelector(`${o}${r}`).innerHTML},tipRotation:-1*1.1071487177940904+THREE.Math.degToRad(40)},"vive-controls":{collider:{primitive:'box',depth:0.1,width:0.04,height:0.04},grabPose:{addPosition:{x:0,y:0,z:-0.15},addRotation:{x:0,y:0,z:0}},menuRotation:THREE.Math.degToRad(-70),raycaster:{direction:new THREE.Vector3(0,-0.6,-1).normalize(),origin:{x:0,y:0,z:0.02}},teleporterDirection:{x:0,y:-0.25,z:-1},templates:{left:document.querySelector(`${n}${s}`).innerHTML,right:document.querySelector(`${o}${s}`).innerHTML},tipRotation:-1*0.5404195002705842}}},update:function(t){var a=this.data,n=this.el,o,r;t.hand!==a.hand&&(n.setAttribute('oculus-touch-controls',i[a.hand]),n.setAttribute('vive-controls',i[a.hand]),n.setAttribute('windows-motion-controls',i[a.hand])),a.controllerType&&!0&&(r=document.getElementById('mouseCursor'),r.setAttribute('raycaster','enabled',!1));a.controllerType&&(o=this.config[a.controllerType]||this.config['oculus-touch-controls'],n.querySelector('.controllerModel').innerHTML=o.templates['right'===a.handPrimary?a.hand:e(a.hand)],setTimeout(()=>{n.object3D.traverse((e)=>{e.frustumCulled=!1})},1e3),n.sceneEl.emit('shapemenuconfigure',o.shapeMenu,!1),this.configureCollider(o),this.configureGrabPose(o),this.configureMenuRotation(o),this.configureRaycasters(o),this.configureTeleporter(o),setTimeout(()=>{this.configureTips(o)}),setTimeout(()=>{n.emit('controllerrender',null,!1)}))},configureCollider:function(e){if(e.collider){const t=this.el.querySelector('.collider');t&&t.setAttribute('geometry',e.collider)}},configureRaycasters:function(e){var n=this.el,o,r,i;if(e.raycaster)for(i=n.querySelectorAll('.raycaster'),r=0;r<i.length;r++)(i[r].setAttribute('raycaster','direction',e.raycaster.direction),i[r].setAttribute('raycaster','origin',e.raycaster.origin),o=i[r].querySelector('.laser'),!!o)&&(o.object3D.position.copy(e.raycaster.origin),o.object3D.rotation.x=t(a(e.raycaster.direction.z)/a(e.raycaster.direction.y)))},configureTeleporter:function(e){var i=this.el,n;e.teleporterDirection&&(i.components['teleport-controls']||i.components['bind-teleport-controls'])&&(n=i.querySelector('#controllerTipTeleporter'),n&&(i.setAttribute('teleport-controls','direction',e.teleporterDirection),setTimeout(()=>{n.object3D.rotation.x-=t(a(e.teleporterDirection.y)/a(e.teleporterDirection.z))})))},configureTips:function(e){var t,i;for(t=0;t<l.length;t++)i=document.getElementById(l[t]),i.object3D.rotation.x=e.tipRotation+(d[l[t]]||0)},configureMenuRotation:function(e){e.menuRotation&&(document.getElementById('menuContainer').object3D.rotation.x=e.menuRotation)},configureGrabPose:function(e){this.el.sceneEl.emit('grabposeset',e.grabPose)}})},function(){AFRAME.registerComponent('debug-controller',{schema:{enabled:{default:!1}},init:function(){var e,t;(this.data.enabled||AFRAME.utils.getUrlParameter('debug'))&&(console.log('%c debug-controller enabled ','background: #111; color: red'),this.isCloning=!1,this.isDeleting=!1,this.isTriggerDown=!1,e=document.getElementById('primaryHand'),t=document.getElementById('secondaryHand'),'oculus'===AFRAME.utils.getUrlParameter('debug')?(this.el.sceneEl.emit('controllerconnected',{name:'oculus-touch-controls'}),e.setAttribute('controller','controllerType','oculus-touch-controls'),t.setAttribute('controller','controllerType','oculus-touch-controls')):(this.el.sceneEl.emit('controllerconnected',{name:'vive-controls'}),e.setAttribute('controller','controllerType','vive-controls'),t.setAttribute('controller','controllerType','vive-controls')),document.addEventListener('keydown',(i)=>{var a,n,o,r;return i.shiftKey?32===i.keyCode?void(this.isTriggerDown?(e.emit('triggerup'),this.isTriggerDown=!1):(e.emit('triggerdown'),this.isTriggerDown=!0)):void(67===i.keyCode&&(this.isCloning?(e.emit('thumbdownend'),this.isCloning=!1):(e.emit('thumbdownstart'),this.isCloning=!0)),88===i.keyCode&&(this.isDeleting?(e.emit('thumbrightend'),this.isDeleting=!1):(e.emit('thumbrightstart'),this.isDeleting=!0)),82===i.keyCode&&(this.isAirScalingActive?(t.emit('triggerup'),this.isAirScalingActive=!1):(t.emit('triggerdown'),this.isAirScalingActive=!0)),84===i.keyCode&&(this.isTeleporting?(t.emit('thumbupend'),this.isTeleporting=!1):(t.emit('thumbupstart'),this.isTeleporting=!0)),70===i.keyCode&&(this.isUniform?(e.emit('thumbend'),this.isUniform=!1):(e.emit('thumbstart'),this.isUniform=!0)),71===i.keyCode&&(e.emit('thumbupstart'),e.emit('thumbupend')),83===i.keyCode&&(this.selectActive?(e.emit('thumbupend'),this.selectActive=!1):(e.emit('thumbupstart'),this.selectActive=!0)),78===i.keyCode&&(this.secondaryGripDown?(t.emit('gripup'),this.secondaryGripDown=!1):(t.emit('gripdown'),this.secondaryGripDown=!0)),77===i.keyCode&&(this.primaryGripDown?(e.emit('gripup'),this.primaryGripDown=!1):(e.emit('gripdown'),this.primaryGripDown=!0)),85===i.keyCode&&(this.sThumbLeft?(t.emit('thumbleftend'),this.sThumbLeft=!1):(t.emit('thumbleftstart'),this.sThumbLeft=!0)),73===i.keyCode&&(this.sThumbDown?(t.emit('thumbdownend'),this.sThumbDown=!1):(t.emit('thumbdownstart'),this.sThumbDown=!0)),49===i.keyCode&&t.emit('menudown'),i.ctrlKey?(o=t.getAttribute('position'),72===i.keyCode&&(o.x-=0.01),74===i.keyCode&&(o.y-=0.01),75===i.keyCode&&(o.y+=0.01),76===i.keyCode&&(o.x+=0.01),(59===i.keyCode||186===i.keyCode)&&(o.z-=0.01),222===i.keyCode&&(o.z+=0.01),t.setAttribute('position',AFRAME.utils.clone(o))):(a=e.getAttribute('position'),72===i.keyCode&&(a.x-=0.01),74===i.keyCode&&(a.y-=0.01),75===i.keyCode&&(a.y+=0.01),76===i.keyCode&&(a.x+=0.01),(59===i.keyCode||186===i.keyCode)&&(a.z-=0.01),222===i.keyCode&&(a.z+=0.01),e.setAttribute('position',AFRAME.utils.clone(a))),i.ctrlKey?(r=t.getAttribute('rotation'),89===i.keyCode&&(r.x-=10),79===i.keyCode&&(r.x+=10),85===i.keyCode&&(r.y-=10),73===i.keyCode&&(r.y+=10),t.setAttribute('rotation',AFRAME.utils.clone(r))):(n=e.getAttribute('rotation'),89===i.keyCode&&(n.x-=10),79===i.keyCode&&(n.x+=10),85===i.keyCode&&(n.y-=10),73===i.keyCode&&(n.y+=10),e.setAttribute('rotation',AFRAME.utils.clone(n)))):void 0}))},play:function(){var e,t;(this.data.enabled||AFRAME.utils.getUrlParameter('debug'))&&(e=document.getElementById('primaryHand'),t=document.getElementById('secondaryHand'),e.object3D.matrixAutoUpdate=!0,t.object3D.matrixAutoUpdate=!0,t.object3D.position.set(-0.2,1.5,-0.5),e.object3D.position.set(0.2,1.5,-0.5),t.setAttribute('rotation',{x:35,y:0,z:0}),e.setAttribute('rotation',{x:35,y:0,z:0}),setTimeout(()=>{e.components['tracked-controls'].tick=function(){},t.components['tracked-controls'].tick=function(){},e.object3D.visible=!0,t.object3D.visible=!0},200))}})},function(){function e(e){return e.classList.contains('raycasterTarget')&&(e=e.parentNode),e.id||e.getAttribute('mixin')||e.getAttribute('class')}AFRAME.registerComponent('debug-cursor',{schema:{enabled:{default:!0}},init:function(){this.el.addEventListener('mouseenter',(t)=>{this.data.enabled&&(console.log(`%c[mouseenter]%c ${e(t.detail.intersectedEl)}`,'background: green; color: white'),document.getElementById('primaryHand').emit('mouseenter',t.detail,!1))}),this.el.addEventListener('mouseleave',(t)=>{this.data.enabled&&(console.log(`%c[mouseleave]%c ${e(t.detail.intersectedEl)}`,'background: blue; color: white'),document.getElementById('primaryHand').emit('mouseleave',t.detail,!1))}),this.el.addEventListener('click',(t)=>{this.data.enabled&&(console.log(`%c[click]%c ${e(t.detail.intersectedEl)}`,'background: red; color: white'),document.getElementById('primaryHand').emit('mousedown',t.detail,!1),document.getElementById('primaryHand').emit('click',t.detail,!1))})}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(1),n=i.n(a);AFRAME.registerComponent('debug-shapes',{schema:{addShape:{default:!0},enabled:{default:!1}},init:function(){var e;(this.data.enabled||AFRAME.utils.getUrlParameter('debug-shapes'))&&'false'!==AFRAME.utils.getUrlParameter('debug-shapes')&&(console.log('%c debug-shapes enabled ','background: #222; color: red'),e=document.getElementById('primaryHand'),setTimeout(()=>{this.el.emit('menubuttonclick',{id:'buildMenuCraft',menu:a.MENUS.CRAFT.SHAPE}),setTimeout(()=>{document.querySelector('#shapeMenu [data-shape-option="box"] .raycasterTarget').emit('mouseenter'),document.querySelector('#shapeMenu [data-shape-option="box"] .raycasterTarget').emit('mousedown'),setTimeout(()=>{setTimeout(()=>{e.setAttribute('position',{x:0.3,y:1.5,z:-0.6}),e.setAttribute('rotation',{x:10,y:45,z:30}),this.data.addShape&&setTimeout(()=>{e.emit('triggerup')},50)})})})}))}})},function(){var e='#DF2935',t={color:e,isActive:!0};AFRAME.registerComponent('deleter',{schema:{raycasterId:{default:'entityRaycaster'},enabled:{default:!1},sound:{default:'deleteSound'}},init:function(){var e=this.el,t;t=document.getElementById(this.data.sound),t.volume=0.1,this.cursor=document.getElementById(this.data.raycasterId).components.cursor,this.deleteEventDetail={},this.isDeleting=!1,this.originalColor='',this.previousTargetEl=null,this.targetEl=null,e.addEventListener('thumbrightstart',this.deleteStart.bind(this)),e.addEventListener('thumbrightend',this.deleteEnd.bind(this)),e.addEventListener('mouseenter',this.onMouseEnter.bind(this)),e.addEventListener('mouseleave',()=>{this.previousTargetEl&&this.restoreTargetColor(this.previousTargetEl),this.targetEl&&this.restoreTargetColor(this.targetEl),this.previousTargetEl=null,this.targetEl=null})},deleteStart:function(){this.data.enabled&&(this.isDeleting=!0,this.el.sceneEl.emit('deletestart',null,!1),this.onMouseEnter())},deleteEnd:function(){var e;return this.isDeleting?(this.isDeleting=!1,this.restoreTargetColor(this.previousTargetEl),e=this.cursor.intersectedEl,e&&SUPERCRAFT.utils.isEditable(e)?void(this.deleteEventDetail.id=e.getAttribute('id'),this.el.sceneEl.emit('deleteend',this.deleteEventDetail,!1),deleteSound.play(),this.previousTargetEl=null,this.targetEl=null):void this.el.sceneEl.emit('deletecancel',null,!1)):void(this.previousTargetEl&&this.restoreTargetColor(this.previousTargetEl))},onMouseEnter:function(){var e=this.cursor.intersectedEl;this.isDeleting&&e&&SUPERCRAFT.utils.isEditable(e)&&(this.targetEl&&(this.restoreTargetColor(this.previousTargetEl),this.previousTargetEl=this.targetEl),this.targetEl=e,this.originalColor=this.targetEl.getAttribute('super-material').color,this.highlightTargetColor(this.targetEl))},highlightTargetColor:function(i){i&&(i.classList.contains('shape')?i.setAttribute('super-material','color',e):i.setAttribute('geometry-merger-temporary-color',t))},restoreTargetColor:function(e){e&&(e.classList.contains('shape')?e.setAttribute('super-material','color',this.originalColor):e.setAttribute('geometry-merger-temporary-color','isActive',!1))}})},function(){AFRAME.registerComponent('entity-raycaster',{dependencies:['raycaster'],schema:{cameraScaleFactor:{default:1},craftMode:{default:!1},colorerEnabled:{default:!1},enabled:{default:!1}},init:function(){this.far=this.el.getAttribute('raycaster').far},update:function(){var e={recursive:!1};return function(){var t=this.el,i=this.data;e.enabled=i.enabled,i.colorerEnabled?(t.components.raycaster.clearAllIntersections(),e.far=i.cameraScaleFactor*0.125):e.far=i.cameraScaleFactor*this.far,e.objects=i.colorerEnabled?'[data-staged] .shape':i.craftMode?'[data-staged] .shape, #scalePoint[raycastable]':'.thing, #scalePoint[raycastable]',t.setAttribute('raycaster',e)}}()})},function(e){var t='boundingbox',a='worldorigin';e.exports.BOUNDING_BOX='boundingbox',e.exports.WORLD_ORIGIN='worldorigin';var n=function(){var e=new THREE.Box3,n=new THREE.Vector3;return function(o,r){var s;if(r===t)for(n.copy(o.object3D.position),e.setFromObject(o.object3D),e.getCenter(o.object3D.position),n.sub(o.object3D.position).multiplyScalar(-1),s=0;s<o.children.length;s++)o.children[s].object3D.position.sub(n);else if(r===a){for(s=0;s<o.children.length;s++)o.children[s].object3D.getWorldPosition(o.children[s].object3D.position),o.children[s].object3D.getWorldQuaternion(o.children[s].object3D.quaternion),o.children[s].object3D.getWorldScale(o.children[s].object3D.scale);o.object3D.position.set(0,0,0),o.object3D.rotation.set(0,0,0),o.object3D.scale.set(1,1,1)}}}();e.exports.recenterTo=n,AFRAME.registerComponent('entity-recenter',{schema:{craftMode:{default:!1},scriptMode:{default:!1},entityId:{default:''}},init:function(){this.eventDetail={ids:[],positions:[],rotations:[],scales:[],to:''},window.addEventListener('beforeunload',()=>{this.data.craftMode&&this.recenterTo(t)})},update:function(e){this.data;this.data.entityId&&((e.craftMode&&!this.data.craftMode||!e.scriptMode&&this.data.scriptMode)&&this.recenterTo(t),(!e.craftMode&&this.data.craftMode||e.scriptMode&&!this.data.scriptMode)&&this.recenterTo(a))},recenterTo:function(e){var t=this.eventDetail,a=this.el,o,r;for(o=document.getElementById(this.data.entityId),o.classList.contains('shape')&&(o=o.parentNode),n(o,e),t.ids.length=0,t.positions.length=0,t.rotations.length=0,t.scales.length=0,t.ids.push(o.getAttribute('id')),t.positions.push(o.object3D.position),t.rotations.push(o.object3D.rotation),t.scales.push(o.object3D.scale),r=0;r<o.children.length;r++)t.ids.push(o.children[r].getAttribute('id')),t.positions.push(o.children[r].object3D.position),t.rotations.push(o.children[r].object3D.rotation),t.scales.push(o.children[r].object3D.scale);t.to=e,a.emit('recenter',t)}})},function(){AFRAME.registerComponent('explore-site-navigate',{init:function(){this.handleLinkClick=this.handleLinkClick.bind(this),this.el.addEventListener('click',this.handleLinkClick),this.el.addEventListener('hitclosest',this.handleLinkClick),window.addEventListener('popstate',(e)=>{this.loadSite(e.state.name,e.state.url)}),history.pushState({name:document.body.dataset.siteName,url:document.body.dataset.siteSource},'')},handleLinkClick:function(e){this.loadSite(e.target.getAttribute('data-site-name'),e.target.getAttribute('data-site-source'))},loadSite:function(e,t){var i=this,a;a=new XMLHttpRequest,a.open('GET',t),a.addEventListener('load',function(){console.log(t,a.status),i.handleResponse(a.status,a.responseText,e,t)}),a.send()},handleResponse:function(e,t,i,a){200!==e||(this.el.sceneEl.emit('loadsite',{data:JSON.parse(t),siteName:i}),history.pushState({name:i,url:a},'',`/site/${i}`))}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(2),n=i.n(a),o=i(0),r=i.n(o);AFRAME.registerComponent('gallery-item',{init:function(){this.offset=Math.random(),this.item=this.el.querySelector('.galleryItemData'),this.item.querySelector('.galleryImage').addEventListener('materialtextureloaded',this.animate.bind(this)),this.loadingIcon=this.el.querySelector('.galleryLoading')},mouseenter:i.i(o.bindEvent)(function(){AFRAME.ANIME({targets:this.item.object3D.position,z:0.1,duration:300,easing:'easeOutBack'})}),mouseleave:i.i(o.bindEvent)(function(){AFRAME.ANIME({targets:this.item.object3D.position,z:0.01,duration:300,easing:'easeOutBack'})}),animate:function(){this.isLoaded=!0,this.loadingIcon.visible=!1,this.item.object3D.visible=!0,AFRAME.ANIME({targets:this.item.object3D.scale,duration:300,easing:'easeOutBack',x:1,y:1})},tick:function(e){this.isLoaded||(this.loadingIcon.object3D.position.y+=5e-3*Math.sin(this.offset+e/100))}})},function(){var e=Math.PI,t=e/2;AFRAME.registerComponent('gallery-layout',{schema:{active:{default:!1},radius:{default:2.1}},init:function(){this.update=AFRAME.utils.throttle(this.update.bind(this),20),this.el.addEventListener('child-attached',this.update),this.el.addEventListener('child-detached',this.update)},update:function(){var i,a,n,o,r,s,l,d,c;if(o=this.el.querySelectorAll('.galleryItem'),!!o.length)for(l=Math.floor(Math.sqrt(o.length)),n=Math.ceil(o.length/l),this.updateGalleryPosition(l),s=this.data.radius,a=s/4.4,i=-t-a*n/2,i+=a/2,d=0;d<n;d++){for(c=0;c<l&&!(n*c+d>=o.length);c++)(r=o[n*c+d].object3D,!!r)&&(r.position.set(Math.cos(i)*s,0.6*-c,Math.sin(i)*s),r.rotation.set(0,2*e-(t+i),0));i+=a}},updateGalleryPosition:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(){var a=this.el,n;n=a.sceneEl.camera,e.set(0,0,-1),a.object3D.position.copy(n.localToWorld(e)),n.getWorldPosition(i),a.object3D.position.y=Math.max(i.y,1),n.getWorldPosition(t),t.y=a.object3D.position.y,a.object3D.lookAt(t)}}()})},function(e,t,i){'use strict';function a(){var e;return new Promise((t)=>{e=new XMLHttpRequest,e.timeout=2500,e.onload=()=>{t(200===e.status?e.responseText:n())},e.ontimeout=e.onerror=()=>{t(n())},e.open('GET',`${r.a.SITE}/random-name`),e.send()})}function n(){var e;return e=new Date,`site-${e.getMonth()+1}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`}Object.defineProperty(t,'__esModule',{value:!0});var o=i(2),r=i.n(o),s=i(0),l=i.n(s);AFRAME.registerComponent('gallery',{schema:{enabled:{default:!1}},init:function(){this.isCreatingNewSite=!1,this.el.sceneEl.addEventListener('loadsite',this.remixViaSiteName.bind(this))},click:i.i(s.bindEvent)(function(e){var t=this.el;this.data.enabled&&(this.isCreatingNewSite=!0,'blank'===e.target.dataset.name?a().then((e)=>{t.sceneEl.emit('newblanksite',e),t.sceneEl.emit('newsitename',e),window.location.pathname.startsWith('/craft/')&&history.replaceState(null,null,`/craft/`)}).catch(console.error):(t.sceneEl.emit('gallerynewsite',null,!1),t.sceneEl.systems.saveload.loadSiteFromAPI(e.target.dataset.name)))}),remixViaSiteName:function(){var e=this.el;this.isCreatingNewSite&&a().then((t)=>{e.sceneEl.emit('newsitename',t),window.location.pathname.startsWith('/craft/')&&history.replaceState(null,null,`/craft/`)}).catch(console.error)}})},function(){var e={materialComponent:'super-material'};AFRAME.registerComponent('geometry-merger-init',{schema:{buildMode:{default:!1},playMode:{default:!1}},play:function(){(this.data.playMode||this.data.buildMode)&&setTimeout(()=>{this.el.setAttribute('geometry-merger',e),this.el.setAttribute('super-material','')},25),this.el.removeAttribute('bind__geometry-merger-init')}})},function(){AFRAME.registerComponent('geometry-merger-shape-active-color',{dependencies:['geometry-merger','super-material'],schema:{baseColor:{default:'#CCC'},highlightColor:{default:'#CCC'}},init:function(){var e=this.el;this.faceIndex=e.components['geometry-merger'].faceIndex,this.geometry=e.getObject3D('mesh').geometry,e.addEventListener('mouseenter',(e)=>{var t;t=e.target,t.classList.contains('raycasterTarget')&&(t=t.parentNode),this.setColor(t.object3D.uuid,this.data.highlightColor)}),e.addEventListener('mouseleave',(e)=>{var t;t=e.target,t.classList.contains('raycasterTarget')&&(t=t.parentNode),this.setColor(t.object3D.uuid,this.data.baseColor)})},setColor:function(e,t){var a=this.faceIndex,n=this.geometry,o;for(o=a[e][0];o<=a[e][1];o++)n.faces[o].color.set(`${t}`);n.colorsNeedUpdate=!0}})},function(){AFRAME.registerComponent('geometry-merger-temporary-color',{schema:{color:{default:'#585858'},isActive:{default:!1}},init:function(){this.faceColors=[]},update:function(){var e=this.data;e.isActive?(this.active=!0,this.storeFaceColors(),this.setBlurColor()):this.active&&(this.active=!1,this.restoreFaceColors())},storeFaceColors:function(){var e,t;for(e=this.el.getObject3D('mesh').geometry.faces,t=0;t<e.length;t++)this.faceColors[t]=this.faceColors[t]||new THREE.Color,this.faceColors[t].copy(e[t].color)},restoreFaceColors:function(){var e,t;if(this.el.removeAttribute('face-colors'),!!this.el.getObject3D('mesh')){for(t=this.el.getObject3D('mesh').geometry,e=0;e<this.faceColors.length;e++)t.faces[e].color.copy(this.faceColors[e]);t.colorsNeedUpdate=!0,this.faceColors.length=0}},setBlurColor:function(){this.el.setAttribute('face-colors','baseColor',this.data.color)}})},function(){AFRAME.registerComponent('geometry-merger-toggler',{schema:{enabled:{default:!1},stagedEntityId:{type:'string'}},init:function(){this.geometryMergerConfig={hideOriginalEntities:!0,materialComponent:'super-material'}},update:function(e){var t=this.data,i=this.el,a=this,n;e.enabled&&!t.enabled&&(n=document.getElementById(t.stagedEntityId),n&&n.hasAttribute('geometry-merger')&&(n.removeAttribute('geometry-merger'),n.removeAttribute('super-material'))),!e.enabled&&t.enabled&&i.sceneEl.addEventListener('recenter',function t(){e.stagedEntityId&&(n=document.getElementById(e.stagedEntityId),n.setAttribute('geometry-merger',a.geometryMergerConfig),n.setAttribute('super-material',''),i.sceneEl.removeEventListener('recenter',t))})}}),AFRAME.registerComponent('geometry-merger-toggler-container',{schema:{enabled:{default:!1}},update:function(e){var t=this.data;this.geometryMergerConfig={hideOriginalEntities:!0,ignoreWithComponent:'super-script',isParentMerger:!0,materialComponent:'super-material'},this.el.sceneEl.addEventListener('loadsitebutton',()=>{this.el.removeAttribute('geometry-merger'),this.el.removeAttribute('super-material')}),e.enabled&&!t.enabled&&(this.el.removeAttribute('geometry-merger'),this.el.removeAttribute('super-material')),!e.enabled&&t.enabled&&(this.el.setAttribute('geometry-merger',this.geometryMergerConfig),this.el.setAttribute('super-material',''))}})},function(e,t,i){i(63);var a={positionFrom:{x:10,y:3,z:10},positionTo:{x:-10,y:3,z:0},lookAt:{x:0,y:1.6,z:-5}};AFRAME.registerComponent('gif-studio',{schema:{active:{default:!1},gifStudio:{default:'gifStudio'},previewButton:{default:'gifPreviewButton'},recordButton:{default:'gifRecordButton'},siteName:{default:''}},init:function(){var e=this.el,t=this.data;this.handleProgress=this.handleProgress.bind(this),this.startPreview=this.startPreview.bind(this),this.startRecording=this.startRecording.bind(this),this.gifButtons=document.getElementById('gifButtons'),this.gifEncodingMessage=document.getElementById('gifEncodingMessage'),this.gifForm=document.getElementById('gifForm'),this.gifRecordingMessage=document.getElementById('gifRecordingMessage'),this.gifStudio=document.getElementById('gifStudio'),this.entities=document.getElementById('entities'),this.progress=document.getElementById('gifProgress'),this.previewButton=document.getElementById(t.previewButton),this.recordButton=document.getElementById(t.recordButton),this.visualizerEntity=null,this.el.sceneEl.camera.el.addEventListener('camerarecorderprogress',this.handleProgress),this.previewButton.addEventListener('click',this.startPreview),this.recordButton.addEventListener('click',this.startRecording),this.cameraRecorderData={dur:5e3,lookAt:{x:0,y:0,z:0},positionFrom:{x:0,y:0,z:0},positionTo:{x:0,y:0,z:0},quality:10,showControls:!1,workers:4,workerPath:'assets/js/'},this.initVisualizer(),this.initDefaultInputValues()},update:function(){var e=this.el,t=this.data,i;i=e.sceneEl.camera.el,this.cameraRecorderData.name=t.siteName,t.active?(i.setAttribute('camera-recorder',this.cameraRecorderData),i.components['camera-recorder'].capture.on('progress',this.handleProgress),this.visualizerEntity.object3D.visible=!0):(i.removeAttribute('camera-recorder'),this.entities.object3D.visible=!0,this.visualizerEntity.object3D.visible=!1)},startPreview:function(){this.updateCameraRecorderFromInputs(),this.el.sceneEl.camera.el.emit('camerarecorderdrystart'),document.getElementById('gifTimelapseEnabled').checked&&(this.visualizerEntity.emit('supercraftvisualizerstart'),this.entities.object3D.visible=!1)},startRecording:function(){this.updateCameraRecorderFromInputs(),this.el.sceneEl.camera.el.emit('camerarecorderstart'),document.getElementById('gifTimelapseEnabled').checked&&(this.visualizerEntity.emit('supercraftvisualizerstart'),this.entities.object3D.visible=!1),this.gifForm.style.display='none',this.gifRecordingMessage.style.display='block',this.gifButtons.style.display='none'},handleProgress:function(e){this.progress.style.display='block',this.gifEncodingMessage.style.display='block',this.gifRecordingMessage.style.display='none',this.progress.setAttribute('value',e.detail),1<=e.detail&&this.onComplete()},onComplete:function(){this.gifForm.style.display='block',this.gifEncodingMessage.style.display='none',this.gifButtons.style.display='block',this.progress.style.display='none'},initVisualizer:function(){var e;e=document.createElement('a-entity'),e.setAttribute('supercraft-visualizer',{dur:5e3}),this.el.sceneEl.appendChild(e),setTimeout(()=>{this.el.sceneEl.systems.saveload.updateSaveState(),e.components['supercraft-visualizer'].setData(this.el.sceneEl.systems.saveload.saveState)}),this.visualizerEntity=e},updateCameraRecorderFromInputs:function(){var e,t,i,a;for(e=1e3*parseFloat(document.getElementById('gifDuration').value||5),a=this.gifStudio.querySelectorAll('input[data-var][data-axis]'),t=0;t<a.length;t++)i=a[t],this.cameraRecorderData[i.dataset.var][i.dataset.axis]=parseFloat(i.value);this.cameraRecorderData.dur=e,this.el.sceneEl.camera.el.setAttribute('camera-recorder',this.cameraRecorderData),document.getElementById('gifTimelapseEnabled').checked&&this.visualizerEntity.setAttribute('supercraft-visualizer','dur',e)},initDefaultInputValues:function(){var e,t;for(t=this.gifStudio.querySelectorAll('input[data-var][data-axis]'),e=0;e<t.length;e++)input=t[e],0===input.value.trim().length&&(input.value=a[input.dataset.var][input.dataset.axis])}})},function(){AFRAME.registerComponent('go-to-state',{schema:{duration:{type:'number',default:1e3},state:{type:'string'}},multiple:!0,init:function(){this.positionDelta=new THREE.Vector3,this.positionSpeed=new THREE.Vector3},update:function(){var e=this.data,t=this.el,i,a;i=t.getAttribute('id'),a=t.sceneEl.systems.state.state.entityIndex[i].states[e.state],this.positionSpeed.copy(a.position).sub(t.object3D.position).divideScalar(e.duration),this.startTime=t.sceneEl.time},tick:function(e,t){return e>this.startTime+this.data.duration?(this.el.emit('gotostateend',{state:this.data.state}),void this.el.removeAttribute(this.attrName)):void(this.positionDelta.copy(this.positionSpeed).multiplyScalar(t),this.el.object3D.position.add(this.positionDelta))}})},function(e,t,i){var a=i(8);AFRAME.registerComponent('grabber',{schema:{cameraScaleFactor:{default:1},colliderId:{default:'collider'},entityId:{default:''},focusedEntityId:{default:''},gridTransform:{default:!1},isClonerActive:{default:!1},raycasterId:{default:'entityRaycaster'},triggerGrabEnabled:{default:!0}},init:function(){var e=this.el,t;t=this.collider=document.getElementById(this.data.colliderId),this.grabbedEl=null,this.grabEventDetail={},this.intersectedEl=null,this.ungrabEventDetail={},this.el.setObject3D('grabberdummy',new THREE.Object3D),e.addEventListener('triggerdown',()=>{var e=this.intersectedEl;this.data.triggerGrabEnabled&&e&&SUPERCRAFT.utils.isEditable(e)&&-1!==t.components['aabb-collider'].intersectedEls.indexOf(e)&&this.grab(e,!0)}),e.addEventListener('triggerup',()=>{this.ungrab()})},update:function(e){var t=this.data,i=this.el,a;return e.focusedEntityId!==t.focusedEntityId&&t.focusedEntityId&&(this.intersectedEl=document.getElementById(t.focusedEntityId)),!t.entityId&&this.grabbedEl?void this.ungrab():void(e.entityId!==t.entityId&&(e.entityId&&this.ungrab(),t.entityId&&(a=document.getElementById(t.entityId),a?this.grab(a,t.isClonerActive):i.sceneEl.addEventListener('child-attached',(e)=>{e.detail.el.getAttribute('id')!==t.entityId||(this.grab(e.detail.el,t.isClonerActive),i.sceneEl.removeEventListener('child-attached',grab))}))))},grab:function(){var e=new THREE.Quaternion,t=new THREE.Quaternion,i=new THREE.Matrix4;return function i(a,n){var o=this.el,r=this.el.sceneEl,s=this,l,d;return this.grabbedEl?void 0:a?a.hasLoaded?void(this.grabbedEl=a,l=a.object3D,d=o.getObject3D('grabberdummy'),o.object3D.worldToLocal(d.position.copy(l.position)),n&&(e.copy(o.parentNode.object3D.quaternion).inverse(),t.copy(o.object3D.quaternion).inverse(),d.quaternion.copy(t).multiply(e).multiply(l.quaternion)),d.rotation.order='YXZ',this.grabEventDetail.id=a.getAttribute('id'),o.emit('grab',null,!1),o.sceneEl.emit('grab',this.grabEventDetail,!1)):void a.addEventListener('loaded',function e(){i.call(s,a,n),a.removeEventListener('loaded',e)}):void 0}}(),ungrab:function(){new THREE.Vector3;return function(){var e=this.grabbedEl,t=this.el,i;e&&(this.grabbedEl=null,this.grabbedObject3D=null,i=e.object3D,this.ungrabEventDetail.id=e.getAttribute('id'),this.ungrabEventDetail.position=i.position,this.ungrabEventDetail.rotation=i.rotation,t.emit('grab',null,!1),t.sceneEl.emit('ungrab',this.ungrabEventDetail,!1),t.getObject3D('grabberdummy').rotation.set(0,0,0))}}(),tick:function(){var e=new THREE.Euler,t=new THREE.Quaternion;return function(){var e=this.data,t=this.grabbedEl,i=this.el,n;t&&(n=i.getObject3D('grabberdummy'),n.getWorldPosition(t.object3D.position),n.getWorldQuaternion(t.object3D.quaternion),e.gridTransform&&(a.snapPosition(t.object3D.position,e.cameraScaleFactor),a.snapRotation(t.object3D.rotation)))}}()})},function(){AFRAME.registerComponent('grid-transform-toggler',{schema:{enabled:{default:!1}},init:function(){this.el.addEventListener('thumbupstart',this.gridToggle.bind(this))},gridToggle:function(){this.data.enabled&&this.el.emit('gridtransformtoggle')}})},function(){AFRAME.registerComponent('handedness',{schema:{handPrimary:{default:'right'}},init:function(){this.el.addEventListener('click',()=>{var e,t;e=localStorage.getItem('handPrimary')||'right',t='right'===e?'left':'right',localStorage.setItem('handPrimary',t),window.location.reload()}),'left'===this.data.handPrimary&&(this.el.object3D.scale.x=-1)}})},function(){AFRAME.registerComponent('hit-emit',{schema:{event:{type:'string'}},init:function(){this.emit=this.emit.bind(this),this.el.addEventListener('click',this.emit),this.el.addEventListener('hitstartclosest',this.emit)},emit:function(){this.el.sceneEl.emit(this.data.event)}})},function(){AFRAME.registerComponent('human-scale-marker',{schema:{cameraScaleFactor:{default:1}},init:function(){var e=this.el,t;e.sceneEl.addEventListener('camerascale',(i)=>{var a;t||(a=new THREE.MeshPhongMaterial({color:'#24CAFF',transparent:!0,opacity:0.5}),e.addEventListener('model-loaded',()=>{e.getObject3D('mesh').traverse((e)=>{e.material=a})}),e.setAttribute('gltf-model','#humanScaleMarkerModel')),e.object3D.position.x=i.detail.originalPosition.x,e.object3D.position.z=i.detail.originalPosition.z})},update:function(){var e=this.el,t=this.data;e.object3D.visible=1!==t.cameraScaleFactor}})},function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function t(){return e()+e()+'-'+e()+'-'+e()+'-'+e()+'-'+e()+e()+e()}var i='inventory',a='site';AFRAME.registerSystem('indexeddb',{init:function(){var e;this.db=null,this.hasLoaded=!1,this.inventory=[],this.siteNames=[],e=indexedDB.open('supercraft',2),e.onerror=function(){console.error('Error opening IndexedDB.',e.error)},e.onupgradeneeded=(e)=>{var t=this.db=e.target.result,n,o;1>e.oldVersion&&(o=t.createObjectStore(a,{autoIncrement:!1}),o.createIndex('name','name',{unique:!0}),o.createIndex('created','created',{unique:!1})),2>e.oldVersion&&(n=t.createObjectStore(i,{autoIncrement:!1}),n.createIndex('id','id',{unique:!0}),n.createIndex('created','created',{unique:!1}))},e.onsuccess=(e)=>{this.db=e.target.result,this.hasLoaded=!0,this.sceneEl.emit('indexeddbinitialized')},this.getSiteNames().then((e)=>{this.sceneEl.emit('getsitenames',e)}),this.getInventoryUuids().then((e)=>{this.sceneEl.emit('getinventoryuuids',e)}),this.sceneEl.addEventListener('newsitename',(e)=>{this.addSite(e.detail)})},getSiteStore:function(){var e;return e=this.db.transaction([a],'readwrite'),e.objectStore(a)},clearSites:function(){return this.getSiteStore().clear()},refreshState:function(){this.getSiteNames().then(()=>{this.sceneEl.emit('getsitenames',this.siteNames)})},getSiteNames:function(){return this.siteNames.length=0,new Promise((e)=>{this.waitForDb(()=>{this.getSiteStore().openCursor().onsuccess=(t)=>{var i=t.target.result;return i?void(this.siteNames.push(i.key),i.continue()):void e(this.siteNames.sort())}})})},getSite:function(e){return new Promise((t)=>{this.waitForDb(()=>{this.getSiteStore().get(e).onsuccess=(e)=>{t(e.target.result)}})})},addSite:function(e){var t,i;return t={created:new Date().toString(),entities:{},name:e},i=this.getSiteStore().add(t,e),i.onsuccess=()=>{this.el.emit('indexeddbsiteadd',e,!1)},i},deleteSite:function(e){return this.getSiteStore().delete(e)},updateSite:function(e){this.getSite(e.name).then((t)=>t?this.getSiteStore().put(e,e.name):void 0)},getInventoryStore:function(){var e;return e=this.db.transaction([i],'readwrite'),e.objectStore(i)},getInventoryEntity:function(e){return new Promise((t)=>{this.waitForDb(()=>{this.getInventoryStore().get(e).onsuccess=(e)=>{t(e.target.result)}})})},getInventoryUuids:function(){return this.inventory.length=0,new Promise((e)=>{this.waitForDb(()=>{this.getInventoryStore().openCursor().onsuccess=(t)=>{var i=t.target.result;return i?void(this.inventory.push(i.key),i.continue()):void e(this.inventory)}})})},addToInventory:function(e,i){var a,n,o,r;return n=AFRAME.utils.clone(this.sceneEl.systems.state.state.entityIndex[e]),r=t(),n.attributes.id=r,a={boundingBoxSize:i,created:new Date().toString(),id:r,entity:n},new Promise((e)=>{o=this.getInventoryStore().add(a,r),o.onsuccess=()=>{this.sceneEl.emit('inventoryadd',r,!1),e(a)}}).catch(console.error)},clearInventory:function(){return this.getInventoryStore().clear()},waitForDb:function(e){return this.hasLoaded?void e():void this.sceneEl.addEventListener('indexeddbinitialized',e)}})},function(e,t,i){'use strict';function a(e,t){e.position.y=-1*t/2,e.position.z=-1*t/2-0.05}Object.defineProperty(t,'__esModule',{value:!0});var n=i(3),o=i.n(n),r=0.25;AFRAME.registerComponent('inventory-dropper',{schema:{colliderId:{default:'collider'},enabled:{default:!1},focusedEntityId:{default:''},raycasterId:{default:'entityRaycaster'}},init:function(){var e=this.data,t=this.el;this.grabbedObjectContainer=new THREE.Object3D,a(this.grabbedObjectContainer,r),t.setObject3D('inventorydroppercontainer',this.grabbedObjectContainer),this.collider=document.getElementById(e.colliderId),this.menuBoundingBox=document.getElementById('menuBoundingBox'),this.raycaster=document.getElementById(e.raycasterId),t.addEventListener('triggerdown',()=>{var e=this.data;e.enabled&&e.focusedEntityId&&this.grab(document.getElementById(e.focusedEntityId))}),t.addEventListener('triggerup',()=>{var e;this.data.enabled&&this.grabbedEl&&(e=this.collider.components['aabb-collider'].intersectedEls,-1!==e.indexOf(this.menuBoundingBox)&&this.storeToInventory(this.grabbedEl.getAttribute('id')),this.ungrab())})},tick:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){var o,s;this.grabbedEl&&(this.el.object3D.getWorldPosition(e),this.menuBoundingBox.object3D.getWorldPosition(t),o=e.sub(t).length(),s=Math.min(THREE.Math.lerp(0.05,r,Math.max(o-0.125,0)/r),r),i.i(n.scaleToBox)(this.grabbedMesh,s),a(this.grabbedObjectContainer,s))}}(),grab:function(){var e=new THREE.Vector3,t=new THREE.Quaternion,a=new THREE.Quaternion;return function(e){var o=this.el;this.grabbedEl=e,this.grabbedMesh=e.getObject3D('mesh').clone(),t.copy(o.parentNode.object3D.quaternion).inverse(),a.copy(o.object3D.quaternion).inverse(),this.grabbedMesh.quaternion.copy(a).multiply(t).multiply(e.object3D.quaternion),this.grabbedMesh.rotation.order='YXZ',i.i(n.scaleToBox)(this.grabbedMesh,r),this.grabbedObjectContainer.add(this.grabbedMesh),o.sceneEl.emit('toinventorygrabstart')}}(),ungrab:function(){var e=this.el;this.grabbedObjectContainer.remove(this.grabbedMesh),this.grabbedEl=null,this.grabbedMesh=null,e.sceneEl.emit('toinventorygrabend'),a(this.grabbedObjectContainer,r)},storeToInventory:function(){var e=new THREE.Box3,t=new THREE.Vector3;return function(i){e.setFromObject(document.getElementById(i).object3D),e.getSize(t),this.el.sceneEl.systems.indexeddb.addToInventory(i,{x:t.x,y:t.y,z:t.z})}}()})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(0),n=i.n(a),o=i(7),r=i.n(o);AFRAME.registerComponent('inventory-grabber',{schema:{cameraScaleFactor:{default:1},enabled:{default:!1},grabPosition:{type:'vec3'},grabRotation:{type:'vec3',default:{x:0,y:0,z:0}}},init:function(){var e=this.el,t=this.data;this.grabInventoryItem=this.grabInventoryItem.bind(this),this.eventDetail={entity:null,position:new THREE.Vector3,rotation:new THREE.Euler}},mousedown:i.i(a.bindEvent)(function(e){var t=this.data,i=this.el,a,n;t.enabled&&e.detail.intersectedEl&&(a=e.detail.intersectedEl.closest('.inventoryItem'),console.log(a),a&&(n=i.sceneEl.systems.indexeddb,n.getInventoryEntity(a.dataset.uuid).then(this.grabInventoryItem).catch(console.error)))}),grabInventoryItem:function(e){var t=this.data,i=this.el,a=this.eventDetail,n;a.entity=e.entity,i.object3D.updateMatrixWorld(),a.position.copy(t.grabPosition),a.position.z-=e.boundingBoxSize.z/t.cameraScaleFactor/2,a.position.z-=0.1,i.object3D.localToWorld(a.position),a.rotation.set(t.grabRotation.x,t.grabRotation.y,t.grabRotation.z),n=i.getObject3D('grabberdummy'),n.rotation.set(t.grabRotation.x,t.grabRotation.y,t.grabRotation.z),i.sceneEl.emit('inventorygrab',a,!1)}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(7),n=i.n(a),o=i(3),r=i.n(o),s={depth:0.05,height:0.05,useBoxTarget:!0,width:0.05};AFRAME.registerComponent('inventory-item-system',{schema:{inventoryOpen:{default:!1},page:{default:0}},init:function(){this.activeQueue=[],this.backlog=[]},update:function(){var e=this.data;e.inventoryOpen&&setTimeout(()=>{this.computeQueue()})},computeQueue:function(){var e=this.data,t;for(t=0;t<this.backlog.length;t++)this.backlog[t]&&this.backlog[t].el.hasAttribute('data-paginator-active')&&(this.activeQueue.push(this.backlog[t]),this.backlog[t]=null);this.activeQueue.length&&this.runQueue()},runQueue:function(){this.activeQueue[0].load().then(()=>{this.activeQueue.splice(0,1),this.activeQueue.length&&this.runQueue()})},queueItem:function(e,t,i){this.backlog.push({el:e,load:()=>new Promise((e)=>{this.el.systems.indexeddb.getInventoryEntity(t).then((t)=>{i(t).then(e).catch(console.error)}).catch(console.error)})})}}),AFRAME.registerComponent('inventory-item',{schema:{uuid:{type:'string'}},init:function(){this.loadThing=this.loadThing.bind(this)},update:function(){var e=this.el,t=this.data;t.uuid&&(e.dataset.uuid=t.uuid,e.setAttribute('raycaster-target',s),e.sceneEl.components['inventory-item-system']?this.queue():e.sceneEl.addEventListener('loaded',()=>{this.queue()}))},play:function(){this.el.parentNode.components.paginator.updatePagination()},queue:function(){var e=this.data,t=this.el;t.sceneEl.components['inventory-item-system'].queueItem(t,e.uuid,this.loadThing)},loadThing:function(e){var t=this.el,n=this.data,r;return r=i.i(a.createThing)(e.entity,!0),r.classList.add('inventoryThing'),r.dataset.uuid=n.uuid,r.object3D.position.set(0,0,0),t.object3D.visible=!1,r.object3D.visible=!1,new Promise((e)=>{r.addEventListener('initialmerge',()=>{t.parentNode.components.paginator.updatePagination(),setTimeout(()=>{i.i(o.scaleToBox)(r.object3D,0.05),r.object3D.visible=!0,t.hasAttribute('data-paginator-active')&&(t.object3D.visible=!0),e()})}),t.appendChild(r)})}})},function(){AFRAME.registerComponent('inventory',{schema:{page:{default:0},isFocused:{default:!1}},init:function(){this.activeInventoryThing=null},update:function(e){var t=this.el,i=this.data;'isFocused'in e&&e.isFocused!==i.isFocused&&(i.isFocused?t.emit('inventoryfocusfeedbackstart',null,!1):(t.emit('inventoryfocusfeedbackend',null,!1),t.querySelector('#inventoryPlane').getObject3D('mesh').material.color.set('#111'))),t.addEventListener('mouseenter',(e)=>{var t,i;(t=e.target.closest('.inventoryItem'),!!t)&&(i=t.querySelector('.inventoryThing'),i&&(this.activeInventoryThing=i,this.activeInventoryThing.setAttribute('super-material','type','faded')))}),t.addEventListener('mouseleave',()=>{this.activeInventoryThing&&(this.activeInventoryThing.setAttribute('super-material','type','phong'),this.activeInventoryThing=null)})}})},function(e,t,i){AFRAME.registerComponent('laser',{schema:{cameraScaleFactor:{default:1},resetLength:{default:0}},init:function(){var e=this.el,t,i;this.currentLength=void 0,t=new THREE.Box3,i=new THREE.Vector3,t.setFromObject(e.children[0].getObject3D('mesh')),t.getSize(i),e.children[0].object3D.position.y=-0.5*i.y,this.currentLength=i.y},tick:function(){var e=this.el,t,i;if(void 0!==this.currentLength){if(t=e.parentNode.components.cursor,(!t||!t.intersectedEl)&&this.data.resetLength)return void this.setLength(this.data.resetLength);i=e.parentNode.components.raycaster.intersections[0],distance=i?i.distance:e.parentNode.components.raycaster.data.far,0===distance||this.setLength(distance)}},setLength:function(e){var t=this.el,i;i=e/this.currentLength/this.data.cameraScaleFactor,t.children[0].object3D.position.y*=i,t.children[0].object3D.scale.y*=i,t.children[0].components.material&&'laser'===t.children[0].components.material.data.shader&&(t.children[0].getObject3D('mesh').material.uniforms.length.value=e/this.data.cameraScaleFactor),this.currentLength=t.children[0].object3D.scale.y}}),AFRAME.registerShader('laser',{schema:{color:{type:'color',is:'uniform'},length:{default:1,is:'uniform'}},vertexShader:i(201),fragmentShader:i(200)})},function(){AFRAME.registerComponent('layout-text',{init:function(){this.layout()},layout:function(){var e=0,t,a;for(a=0;a<this.el.children.length;a++)t=this.el.children[a],t.object3D.position.x+=e,e+=0.0058*(t.getAttribute('text').value.length+1.4)}}),AFRAME.registerComponent('slice9-width-text',{dependencies:['slice9','text'],init:function(){this.originalX=this.el.getObject3D('mesh').position.x,this.setWidth(),this.el.addEventListener('componentchanged',(e)=>{'text'!==e.detail.name||this.setWidth()})},setWidth:function(){var e,t,i;this.el.getObject3D('mesh').position.x=this.originalX,t=this.el.getAttribute('text'),t?(e=t.width/t.wrapCount,i=(t.value.length+1)*e,this.el.getObject3D('mesh').position.x+=(i-e/2)/2):i=0,this.el.setAttribute('slice9','width',i)}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(0),n=i.n(a);AFRAME.registerComponent('load-menu-refresh',{click:i.i(a.bindEvent)(function(){this.el.sceneEl.systems.indexeddb.refreshState()})})},function(){AFRAME.registerComponent('loading-splash',{schema:{isSiteLoading:{default:!1}},init:function(){var e=this.el;this.dummy=new THREE.Object3D,this.dummy.position.set(0,0,-4),e.sceneEl.camera?e.sceneEl.camera.add(this.dummy):e.sceneEl.addEventListener('camerasetactive',()=>{e.sceneEl.camera.add(this.dummy)})},update:function(){var e=this.el,t=this.data;e.object3D.visible=t.isSiteLoading,t.isSiteLoading?e.emit('loadingsplashstart',null,!1):e.emit('loadingsplashpause',null,!1),this.updateLoadingPosition()},play:function(){setTimeout(()=>{this.updateLoadingPosition()})},updateLoadingPosition:function(){var e=this.el;return e.sceneEl.camera?this.dummy.parent?void(this.dummy.updateMatrixWorld(!0),this.dummy.parent.updateMatrixWorld(!0),this.dummy.getWorldPosition(e.object3D.position),e.object3D.position.y=1.6,e.object3D.lookAt(e.sceneEl.camera.getWorldPosition(new THREE.Vector3))):void setTimeout(()=>{this.updateLoadingPosition()}):void e.sceneEl.addEventListener('camerasetactive',this.updateLoadingPosition.bind(this))}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(1),n=i.n(a);AFRAME.registerComponent('menu-button-switcher',{init:function(){var e=this.el;this.switchMenu=this.switchMenu.bind(this),e.addEventListener('menudown',this.switchMenu),e.addEventListener('ybuttondown',this.switchMenu),this.eventDetail={menu:''}},switchMenu:function(){var e,t,i;(e=this.el.sceneEl.systems.state.state.activeMenu,t=this.el.sceneEl.systems.state.state.activeMenuSection,!!a.MENU_ORDER[t])&&(i=a.MENU_ORDER[t].indexOf(e),-1===i||(i>=a.MENU_ORDER[t].length-1?i=0:i++,this.eventDetail.menu=a.MENU_ORDER[t][i],this.el.sceneEl.emit('menubuttonclick',this.eventDetail)))}})},function(){AFRAME.registerComponent('menu-container-click-listener',{init:function(){this.evtDetail={},this.onClick=this.onClick.bind(this),this.primaryHand=document.getElementById('primaryHand')},play:function(){this.el.addEventListener('click',this.onClick)},pause:function(){this.el.removeEventListener('click',this.onClick)},remove:function(){this.el.removeEventListener('click',this.onClick)},onClick:function(e){var t,i,a;if(t=e.target,t.classList.contains('raycasterTarget')&&(t=t.parentNode),i=t.getAttribute('mixin'),i&&(-1!==i.indexOf('menuButton')||-1!==i.indexOf('menuIcon'))){for(a=t.parentNode;!a.components.menu&&!a.components['menu-section'];)if(a=a.parentNode,!a.isEntity)return;this.evtDetail.id=t.getAttribute('id'),this.evtDetail.menu=t.dataset.menu||t.dataset.menuSection,this.el.emit('menubuttonclick',this.evtDetail),this.primaryHand.emit('menubuttonclick',void 0,!1)}}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(1),n=i.n(a);AFRAME.registerComponent('menu-edit-button',{schema:{activeMenu:{type:'string'},siteName:{type:'string'}},init:function(){var e=this.el;e.sceneEl.addEventListener('indexeddbsiteadd',()=>{e.sceneEl.systems.indexeddb.getSite(this.data.siteName).then((t)=>{e.object3D.visible=!!t})})},update:function(){var e=this.el,t=this.data;return t.activeMenu===a.MENUS.MAIN.BUILD_OPTIONS?t.siteName?void e.sceneEl.systems.indexeddb.getSite(t.siteName).then((t)=>{e.object3D.visible=!!t}):void(e.object3D.visible=!1):void 0}})},function(){AFRAME.registerComponent('menu-environment',{schema:{enabled:{default:'string'}},init:function(){var e=this.el;this.activeSlice=e.querySelector('#envColorActiveSlice'),this.hoverSlice=e.querySelector('#envColorHoverSlice'),this.selectColorEventDetail={},e.addEventListener('click',(e)=>{this.selectColor(e.target)}),e.addEventListener('mouseenter',this.onColorMouseEnter.bind(this)),e.addEventListener('mouseleave',this.onColorMouseLeave.bind(this))},selectColor:function(e){e.classList.contains('color')&&(this.selectColorEventDetail.color=e.dataset.color,this.selectColorEventDetail.colorName=e.dataset.colorName,this.el.sceneEl.emit('selectenvironmentcolor',this.selectColorEventDetail),this.activeSlice.object3D.position.copy(e.object3D.position))},onColorMouseEnter:function(e){e.target.classList.contains('color')&&this.data.enabled&&(this.hoverSlice.object3D.position.copy(e.target.object3D.position),this.hoverSlice.object3D.visible=!0)},onColorMouseLeave:function(e){e.target.classList.contains('color')&&this.data.enabled&&(this.hoverSlice.object3D.visible=!1)}})},function(){AFRAME.registerComponent('menu-handedness',{schema:{hand:{default:'left'},leftPositionX:{default:0.155},rightPositionX:{default:-0.155}},update:function(){var e=this.el,t=this.data;e.object3D.position.x='left'===t.hand?t.leftPositionX:t.rightPositionX}})},function(){AFRAME.registerComponent('menu-hover-color',{schema:{hoverColor:{default:'#DADADA'}},init:function(){var e=this.el,t,i;t='material'in e.components?'material':'super-material',e.addEventListener('mouseenter',()=>{i=e.getAttribute(t).color,e.setAttribute(t,'color',this.data.hoverColor)}),e.addEventListener('mouseleave',()=>{e.getAttribute(t).color!==this.data.hoverColor||e.setAttribute(t,'color',i)})}})},function(){var e={back:[1,8],settings:[2,8],object:[3,8],image:[4,8],parameters:[5,8],save:[6,8],user:[7,8],share:[8,8],shapes:[1,7],material:[2,7],vertex:[3,7],load:[4,7],export:[5,7],blackrect:[6,7],blackrectfilled:[7,7],logo:[8,7],rect:[1,6],edit:[2,6],hand:[3,6],logocolor:[4,6],help:[5,6],play:[6,6],rewind:[7,6],close:[8,6],pause:[1,5],logoborder:[2,5]};AFRAME.registerComponent('menu-icon',{schema:{active:{default:!1},type:{type:'string'}},init:function(){this.planeGridUvs={totalColumns:8,totalRows:8}},update:function(){var t=this.data,i=this.planeGridUvs;i.column=e[t.type][0],i.row=e[t.type][1],t.active&&(i.row-=4),this.el.setAttribute('plane-grid-uvs',this.planeGridUvs)}})},function(){AFRAME.registerComponent('menu-load-button',{init:function(){var e=this.el,t,i;t=document.getElementById('entities'),i=e.sceneEl.systems.indexeddb,e.addEventListener('click',(i)=>{if(i.target.dataset.siteName){for(;t.firstChild;)t.removeChild(t.firstChild);e.sceneEl.systems.saveload.loadSiteFromIDB(i.target.dataset.siteName).then(()=>{e.sceneEl.emit('loadsitebutton',null,!1)})}})}})},function(){AFRAME.registerComponent('menu-material',{schema:{enabled:{default:!1}},init:function(){var e=this.el;this.activeSlice=e.querySelector('#colorActiveSlice'),this.hoverSlice=e.querySelector('#colorHoverSlice'),this.selectColorEventDetail={},e.addEventListener('click',(e)=>{this.selectColor(e.target)}),e.addEventListener('mouseenter',this.onColorMouseEnter.bind(this)),e.addEventListener('mouseleave',this.onColorMouseLeave.bind(this))},play:function(){this.selectColor(this.el.querySelector('[data-color-name="orangered"]'))},selectColor:function(e){e.classList.contains('color')&&(this.selectColorEventDetail.color=e.getAttribute('data-color'),this.el.sceneEl.emit('selectcolor',this.selectColorEventDetail),this.activeSlice.object3D.position.copy(e.object3D.position))},onColorMouseEnter:function(e){e.target.classList.contains('color')&&this.data.enabled&&(this.hoverSlice.object3D.position.copy(e.target.object3D.position),this.hoverSlice.object3D.visible=!0)},onColorMouseLeave:function(e){e.target.classList.contains('color')&&this.data.enabled&&(this.hoverSlice.object3D.visible=!1)}})},function(){AFRAME.registerComponent('menu-raycaster',{schema:{cameraScaleFactor:{default:1},enabled:{default:!1},laser:{default:'#laser'}},init:function(){var e=this.el;this.laser=e.querySelector(this.data.laser),this.initDetectNear(),e.addEventListener('mouseenter',(t)=>{this.data.enabled&&(this.laser.object3D.visible=!!t.detail.intersectedEl.closest('#menuContainer'),e.sceneEl.emit('menufocus',null,!1))}),e.addEventListener('mouseleave',()=>{setTimeout(()=>{e.components.cursor.intersectedEl||(this.laser.object3D.visible=!1,e.sceneEl.emit('menublur',null,!1))})})},update:function(e){this.updateRaycaster(e)},play:function(){setTimeout(()=>{this.manualBoundingBoxCheck(),this.isNearMenu&&(this.laser.object3D.visible=!0,this.updateRaycaster())},500)},manualBoundingBoxCheck:function(){var e,t;e=document.getElementById('collider'),t=document.getElementById('menuBoundingBox'),-1!==e.components['aabb-collider'].intersectedEls.indexOf(t)&&(this.isNearMenu=!0)},updateRaycaster:function(e){var t=this.data,i=this.el;return e&&!e.enabled&&t.enabled?void setTimeout(()=>{this.manualBoundingBoxCheck(),this.updateRaycaster()}):void(this.isNearMenu&&t.enabled?(i.setAttribute('raycaster','enabled',!0),i.setAttribute('raycaster','far',0.5*t.cameraScaleFactor)):(this.laser.object3D.visible=!1,i.sceneEl.emit('menublur',null,!1),i.setAttribute('raycaster','far',0),setTimeout(()=>{i.setAttribute('raycaster','enabled',!1)})))},initDetectNear:function(){var e=this.el,t;t=document.getElementById('menuBoundingBox'),t.addEventListener('hitstart',()=>{this.isNearMenu=!0,this.updateRaycaster(),e.sceneEl.emit('menuboundingboxhitstart',null,!1)}),t.addEventListener('hitend',()=>{this.isNearMenu=!1,this.updateRaycaster(),e.sceneEl.emit('menuboundingboxhitend',null,!1)})}})},function(e,t,i){'use strict';function a(){var e=new Date;return`site-${e.getMonth()+1}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`}Object.defineProperty(t,'__esModule',{value:!0});var n=i(2),o=i.n(n);AFRAME.registerComponent('menu-remix-button',{init:function(){var e=this.el;e.addEventListener('click',()=>{e.sceneEl.emit('remixsite',null,!1),this.getRandomSiteName().then((t)=>{e.sceneEl.emit('newsitename',t),window.location.pathname.startsWith('/craft/')&&history.replaceState(null,null,`/craft/`)})})},getRandomSiteName:function(){var e;return new Promise((t)=>{e=new XMLHttpRequest,e.timeout=2500,e.onload=()=>{t(200===e.status?e.responseText:a())},e.ontimeout=e.onerror=()=>{t(a())},e.open('GET',`${o.a.SITE}/random-name`),e.send()})}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(3),n=i.n(a);AFRAME.registerComponent('menu-selected-thing',{schema:{cameraScaleFactor:{default:1},enabled:{default:!1},thingId:{default:''}},init:function(){this.currentFactor=void 0,this.mesh=new THREE.Mesh,this.el.setObject3D('mesh',this.mesh),this.mesh.castShadow=!0},update:function(){var e=this.el,t=this.data,i;if(t.enabled)return t.thingId?(i=document.getElementById(t.thingId),i?void(e.object3D.visible=!0,this.setMesh(i)):void(e.object3D.visible=!1)):void(e.object3D.visible=!1)},setMesh:function(e){var t=this;return e.getObject3D('mesh')?void(this.mesh.scale.set(1,1,1),this.mesh.geometry=e.getObject3D('mesh').geometry,this.mesh.material=e.getObject3D('mesh').material,i.i(a.scaleToBox)(this.mesh,0.04*this.data.cameraScaleFactor)):void e.addEventListener('initialmerge',function i(){t.setMesh(e),e.removeEventListener('initialmerge',i)})}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(32),n=i.n(a);AFRAME.registerComponent('menu-shape',{schema:{addPosition:{type:'vec3',default:{x:0,y:0,z:-0.15}},addRotation:{type:'vec3',default:{x:0,y:0,z:0}}},init:function(){var e=this.el;this.handEl=document.getElementById('primaryHand'),this.handEl.setObject3D('shapemenudummy',new THREE.Object3D),this.hasSelectedShape=!1,this.hitTarget=null,this.addShapeEventDetail={},e.addEventListener('mousedown',(e)=>{this.addShape(e.target.parentNode.dataset.shapeOption)})},addShape:function(){var e=new THREE.Euler,t=new THREE.Quaternion,i=new THREE.Vector3,n=new THREE.Euler,o=new THREE.Quaternion;return function(r){var s=this.addShapeEventDetail,l=this.el,d=this.data,c=this.handEl,u,p;r&&(c.object3D.updateMatrixWorld(),i.copy(this.data.addPosition),c.object3D.localToWorld(i),s.position=i,e.set(d.addRotation.x,d.addRotation.y,d.addRotation.z),u=c.getObject3D('grabberdummy'),a.SHAPE_ROTATIONS[r]?(t.setFromEuler(e),p=c.getObject3D('shapemenudummy'),p.rotation.copy(a.SHAPE_ROTATIONS[r]),p.quaternion.multiply(t),p.getWorldQuaternion(o),n.setFromQuaternion(o),s.rotation=n,u.rotation.copy(a.SHAPE_ROTATIONS[r]),u.quaternion.multiply(t)):(u.rotation.copy(e),s.rotation=this.data.addRotation),s.shapeType=r,l.sceneEl.emit('addshape',s,!1))}}()})},function(){AFRAME.registerComponent('menu-toggler',{init:function(){var e=document.getElementById('#menu');this.el.addEventListener('menubuttondown',()=>{e.setAttribute('visible',!e.getAttribute('visible'))})}})},function(){AFRAME.registerComponent('menu-tooltip',{init:function(){var e=this.el,t={};e.addEventListener('mouseenter',(i)=>{var a;a=i.detail.intersectedEl,a.classList.contains('raycasterTarget')&&(a=a.parentNode),t.tooltip=a.dataset.title,e.sceneEl.emit('menutooltiphover',t)}),e.addEventListener('mouseleave',()=>{setTimeout(()=>{e.components.cursor.intersectedEl||(t.tooltip='',e.sceneEl.emit('menutooltiphover',t))})})}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(1),n=i.n(a);AFRAME.registerComponent('menu',{init:function(){var e=this.el;this.activeStateCondition=`activeMenu === '${e.dataset.menu}'`,e.setAttribute('bind__visible',this.activeStateCondition),e.addEventListener('child-attached',(e)=>{setTimeout(()=>{e.detail.el.hasAttribute('data-raycastable')&&this.setRaycastableToggle(e.detail.el)})})},play:function(){var e=this.el,t,i;for(i=e.querySelectorAll('[data-raycastable]'),t=0;t<i.length;t++)this.setRaycastableToggle(i[t])},setRaycastableToggle:function(e){e.hasAttribute('bind-toggle__raycastable')||e.setAttribute('bind-toggle__raycastable',this.activeStateCondition)}}),AFRAME.registerComponent('menu-section',{init:function(){var e=this.el;this.activeStateCondition=`activeMenuSection === '${e.dataset.menuSection}'`,e.setAttribute('bind__visible',this.activeStateCondition)},play:function(){var e=this.el,t,i;for(i=e.querySelectorAll('[data-raycastable]'),t=0;t<i.length;t++)i[t].closest('[menu]')||this.setRaycastableToggle(i[t])},setRaycastableToggle:function(e){e.hasAttribute('bind-toggle__raycastable')||e.setAttribute('bind-toggle__raycastable',this.activeStateCondition)}})},function(){AFRAME.registerComponent('mobile-shadow-toggle',{play:function(){this.el.sceneEl.isMobile&&this.el.setAttribute('light','castShadow',!1)}})},function(e,t,i){i(158),AFRAME.registerComponent('orbit-controls',{dependencies:['camera'],schema:{autoRotate:{type:'boolean'},autoRotateSpeed:{default:2},dampingFactor:{default:0.1},enabled:{default:!0},enableDamping:{default:!0},enableKeys:{default:!0},enablePan:{default:!0},enableRotate:{default:!0},enableZoom:{default:!0},initialPosition:{type:'vec3'},keyPanSpeed:{default:7},minAzimuthAngle:{type:'number',default:Infinity},maxAzimuthAngle:{type:'number',default:Infinity},maxDistance:{default:1e3},maxPolarAngle:{default:AFRAME.utils.device.isMobile()?90:105},minDistance:{default:1},minPolarAngle:{default:0},minZoom:{default:0},panSpeed:{default:1},rotateSpeed:{default:0.05},screenSpacePanning:{default:!1},target:{type:'vec3'},zoomSpeed:{default:0.5}},init:function(){var e=this.el,t;this.controls=new THREE.OrbitControls(e.getObject3D('camera'),e.sceneEl.renderer.domElement),t=new THREE.Vector3,e.sceneEl.addEventListener('enter-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!1,e.hasAttribute('look-controls')&&(e.setAttribute('look-controls','enabled',!0),t.copy(e.getObject3D('camera').position),e.getObject3D('camera').position.set(0,0,0)))}),e.sceneEl.addEventListener('exit-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!0,e.getObject3D('camera').position.copy(t),e.hasAttribute('look-controls')&&e.setAttribute('look-controls','enabled',!1))}),this.target=new THREE.Vector3,e.getObject3D('camera').position.copy(this.data.initialPosition)},update:function(){var e=this.controls,t=this.data;e.target=this.target.copy(t.target),e.autoRotate=t.autoRotate,e.autoRotateSpeed=t.autoRotateSpeed,e.dampingFactor=t.dampingFactor,e.enabled=t.enabled,e.enableDamping=t.enableDamping,e.enableKeys=t.enableKeys,e.enablePan=t.enablePan,e.enableRotate=t.enableRotate,e.enableZoom=t.enableZoom,e.keyPanSpeed=t.keyPanSpeed,e.maxPolarAngle=THREE.Math.degToRad(t.maxPolarAngle),e.maxDistance=t.maxDistance,e.minDistance=t.minDistance,e.minPolarAngle=THREE.Math.degToRad(t.minPolarAngle),e.minZoom=t.minZoom,e.panSpeed=t.panSpeed,e.rotateSpeed=t.rotateSpeed,e.screenSpacePanning=t.screenSpacePanning,e.zoomSpeed=t.zoomSpeed},tick:function(){var e=this.controls,t=this.data;!t.enabled||e.enabled&&(e.enableDamping||e.autoRotate)&&this.controls.update()}})},function(){AFRAME.registerComponent('paginator',{schema:{active:{default:!1},numPerPage:{default:10},page:{default:0},pagePositionOffset:{default:0.075},pagePositionShift:{default:0.1}},init:function(){this.updatePagination=AFRAME.utils.throttle(this.updatePagination.bind(this),250)},update:function(){var e=this.data,t=this.el;t.object3D.position.y=e.pagePositionShift*e.page+e.pagePositionOffset,this.updatePagination()},updatePagination:function(){var e=this.el,t=this.data,a,n,i,o;for(a=0,n=0;n<e.children.length;n++)e.children[n].isEntity&&a++;for(i=0,n=0;n<e.children.length;n++){if(!e.children[n].isEntity){i++;continue}if(t.active||(o=e.children[n].querySelector('.raycasterTarget'),o&&o.removeAttribute('raycastable')),n-i<t.page*t.numPerPage||n-i>t.page*t.numPerPage+t.numPerPage-1){e.children[n].object3D.visible=!1,e.children[n].removeAttribute('data-paginator-active'),o=e.children[n].querySelector('.raycasterTarget'),o&&o.removeAttribute('raycastable');continue}e.children[n].object3D.visible=!0,e.children[n].setAttribute('data-paginator-active',''),t.active&&(o=e.children[n].querySelector('.raycasterTarget'),o&&o.setAttribute('raycastable',''))}}})},function(){var e=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];AFRAME.registerComponent('plane-grid-uvs',{dependencies:['geometry'],schema:{totalColumns:{type:'int'},totalRows:{type:'int'},column:{type:'int'},row:{type:'int'}},init:function(){this.setFaceVertexUvs(),this.el.addEventListener('componentchanged',(e)=>{'geometry'!==e.detail.name||this.setFaceVertexUvs()})},setFaceVertexUvs:function(t){var i=this.data,a=1e-3,n,o,t,r,s;t=this.el.getObject3D('mesh').geometry;t.faceVertexUvs&&(t.faceVertexUvs[0][0]=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],t.faceVertexUvs[0][1]=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],n=i.column-1,r=i.row-1,o=1/i.totalRows,s=1/i.totalColumns,e[0].set(o*n+a,s*r+s-a),e[1].set(o*n+a,s*r+a),e[2].set(o*n+o-a,s*r+a),e[3].set(o*n+o-a,s*r+s-a),t=this.el.getObject3D('mesh').geometry,t.faceVertexUvs[0][0][0].copy(e[0]),t.faceVertexUvs[0][0][1].copy(e[1]),t.faceVertexUvs[0][0][2].copy(e[3]),t.faceVertexUvs[0][1][0].copy(e[1]),t.faceVertexUvs[0][1][1].copy(e[2]),t.faceVertexUvs[0][1][2].copy(e[3]),t.uvsNeedUpdate=!0)}})},function(e,t,i){var a=i(160);AFRAME.registerSystem('play-sound',{init:function(){this.lastSoundPlayed='',this.lastSoundPlayedTime=0,this.pools={}},createPool:function(e,t){this.pools[e]||(this.pools[e]=new a(e,t))},playSound:function(e,t){-1!==e.indexOf('menuhover.mp3')&&-1!==this.lastSoundPlayed.indexOf('menuclick.mp3')&&this.el.time<this.lastSoundTime+250||(this.createPool(e,t),this.pools[e].play(),this.lastSoundPlayed=e,this.lastSoundTime=this.el.time)}}),AFRAME.registerComponent('play-sound',{schema:{enabled:{default:!0},event:{type:'string'},sound:{type:'string'},volume:{type:'number',default:1}},multiple:!0,init:function(){this.el.addEventListener(this.data.event,()=>{this.data.enabled&&this.system.playSound(this.data.sound,this.data.volume)})}})},function(){AFRAME.registerComponent('preloader',{init:function(){this.textures=[],setTimeout(()=>{this.preloadFont(),this.preloadMenuIcons()})},preloadFont:function(){var e;e=document.querySelector('[mixin="text"]'),e.addEventListener('textfontset',()=>{this.preloadTexture(e.components.text.texture,0)})},preloadMenuIcons:function(){var e,t;for(e in t=this.el.systems['super-material'].materials,t)t[e].map&&this.preloadTexture(t[e].map)},preloadTexture:function(e){this.textures.push(e),this.el.renderer.setTexture2D(e,0)},showCanvas:function(e){e.style.left=0,e.style.position='fixed',e.style.top=0,e.style.zIndex=1e3,document.body.appendChild(e)}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(2),n=i.n(a),o=new Audio('assets/audio/success.mp3');o.volume=0.5,AFRAME.registerComponent('publish-site',{schema:{isSitePublished:{default:!1},siteName:{default:''}},init:function(){this.publishSite=this.publishSite.bind(this),this.el.addEventListener('click',this.publishSite),this.el.addEventListener('hitclosest',this.publishSite)},publishSite:function(){var e=this.el.sceneEl,t,i,a;e.emit('sitepublishstart'),e.systems.saveload.updateSaveState(),t=e.systems.saveload.saveState;t&&(t.userToken=e.systems.user.userToken,i=n.a.SITE,this.data.isSitePublished&&(i=`${n.a.SITE}/${this.data.siteName}`),a=new XMLHttpRequest,a.open('POST',i),a.setRequestHeader('Content-Type','application/json;charset=UTF-8'),a.addEventListener('load',()=>{this.handleResponse(a.status,a.responseText)}),a.addEventListener('error',(e)=>{console.error(e),this.el.sceneEl.emit('sitepublishfail')}),a.send(JSON.stringify({data:t,name:this.data.siteName,userToken:e.systems.user.userToken})))},handleResponse:function(e,t){var i;return 200===e?void(i=JSON.parse(t),console.log(e,i),this.el.sceneEl.emit('sitepublishsuccess',i),o.play(),window.location.pathname.startsWith('/craft/')?history.replaceState(null,null,`/craft/${i.name}/`):history.replaceState(null,null,`/${i.name}/`)):void this.el.sceneEl.emit('sitepublishfail')}})},function(){AFRAME.registerComponent('published-site-text-color',{dependencies:['text'],schema:{isSitePublished:{default:!1}},update:function(){this.el.setAttribute('text','color',this.data.isSitePublished?'#48BAEA':'#444')}})},function(){AFRAME.registerComponent('data-raycastable',{}),AFRAME.registerComponent('raycastable',{})},function(){AFRAME.registerComponent('raycaster-target',{schema:{bindToggle:{default:''},depth:{type:'number'},height:{type:'number'},position:{type:'vec3',default:{x:0,y:0,z:0}},rotation:{type:'vec3',default:{x:0,y:0,z:0}},useBoxTarget:{default:!1},width:{type:'number'}},init:function(){var e={primitive:'box'},t={primitive:'plane'};return function(){var i=this.data,a=this.el,n,o;o=document.createElement('a-entity'),o.classList.add('raycasterTarget'),i.bindToggle?o.setAttribute('bind-toggle__raycastable',i.bindToggle):o.setAttribute('data-raycastable',''),i.useBoxTarget?(n=e,n.depth=i.depth,n.height=i.height,n.width=i.width):(n=t,n.height=i.height,n.width=i.width),o.setAttribute('geometry',n),o.object3D.visible=!1,o.object3D.position.copy(i.position),o.object3D.rotation.x=THREE.Math.degToRad(i.rotation.x),o.object3D.rotation.y=THREE.Math.degToRad(i.rotation.y),o.object3D.rotation.z=THREE.Math.degToRad(i.rotation.z),a.appendChild(o)}}()})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(0),n=i.n(a),o=localStorage.getItem('supercraftReferenceImage')||'',r=0.35,s=0.35;AFRAME.registerComponent('reference-image',{dependencies:['material'],init:function(){o&&this.el.setAttribute('material','src',o)},play:function(){var e=this.el;e.sceneEl.canvas.addEventListener('drop',this.onDrop.bind(this)),e.sceneEl.canvas.addEventListener('dragover',function(e){e.preventDefault()})},onDrop:function(e){var t=this.el,i,a;if(e.preventDefault(),a=e.dataTransfer.items[0],a&&'file'===a.kind)return i=e.dataTransfer.items[0].getAsFile(),-1===a.type.indexOf('image')?void('.obj'===i.name.substr(i.name.length-4).toLowerCase()&&this.loadObj(i)):void this.loadImage(i)},loadImage:function(e){var t;t=new FileReader,t.addEventListener('load',()=>{o=t.result,localStorage.setItem('supercraftReferenceImage',o),this.el.setAttribute('material','src',t.result)},!1),t.readAsDataURL(e)},loadObj:function(e){var t,a;t=document.getElementById('referenceObject'),a=new FileReader,a.addEventListener('load',()=>{var e,n,o,r;for(o=new AFRAME.THREE.OBJLoader,n=o.parse(a.result),r=0;r<n.children.length;r++)e=n.children[r],e.material.color.set('#777');t.setObject3D('mesh',n)},!1),a.readAsText(e)},materialtextureloaded:i.i(a.bindEvent)(function(){var e=this.el,t;t=e.components.material.material.map.image,e.object3D.position.x=s/2-0.085,t.width>t.height?e.setAttribute('geometry',{width:s,height:s/t.width*t.height}):e.setAttribute('geometry',{width:r/t.height*t.width,height:r}),this.el.emit('referenceimageloaded')})}),AFRAME.registerComponent('reference-image-toggler',{thumbrightend:i.i(a.bindEvent)(function(){o&&this.el.emit('referenceimageclose')}),thumbrightstart:i.i(a.bindEvent)(function(){o&&this.el.emit('referenceimageopen')})})},function(){function e(e,i){for(var a in i){if(-1!==t.indexOf(a)){'rotation'===a?(e.object3D[a].x=i[a].x,e.object3D[a].y=i[a].y,e.object3D[a].z=i[a].z):e.object3D[a].copy(i[a]);continue}e.setAttribute(a,i[a])}}var t=['position','rotation','scale'],a='shape',n='thing';AFRAME.registerComponent('render-entities',{schema:{dirtyIds:{type:'array'}},update:function(){var t=this.el,o,r,s,l,d,c,i,u;if(i=t.sceneEl.systems.state.state,i.clearEntities){for(;t.firstChild;)t.removeChild(t.firstChild);i.clearEntities=!1}for(c=0;c<this.data.dirtyIds.length;c++){if(o=this.data.dirtyIds[c],r=i.entityIndex[o],s=document.getElementById(o),!r){s&&s.parentNode.removeChild(s);continue}if(s){e(s,r.attributes);continue}if(s=document.createElement('a-entity'),e(s,r.attributes),s.setAttribute('mixin',n),-1===r.attributes.id.indexOf(a)){for(d in s.setAttribute('class',n),s.setAttribute('collidable',''),t.appendChild(s),u=0,r.shapes){const t=r.shapes[d],i=document.createElement('a-entity');e(i,t.attributes),i.setAttribute('class',a),i.setAttribute('mixin',a),s.appendChild(i),u++}s.dataset.geometryMergerChildCount=u;continue}(l=t.querySelector(`#${r.parentId}`),!!l)&&(l.appendChild(s),s.setAttribute('class',a),s.setAttribute('mixin',a),i.grabbedEntityId!==r.attributes.id||r.attributes['data-cloned-from']||s.setAttribute('shape-add-effect',''))}this.data.dirtyIds.length=0}})},function(){AFRAME.registerComponent('renderer-pixel-ratio',{play:function(){this.el.renderer.setPixelRatio(1)}})},function(e,t,i){function a(e,t,i){i=i||'application/json';const a=new Blob([e],{type:i}),n=document.createElement('a');n.href=URL.createObjectURL(a),n.setAttribute('download',t),n.style.display='none',document.body.appendChild(n),setTimeout(function(){n.click(),document.body.removeChild(n)})}var n=i(2),o=i(159),r=i(157),s=new THREE.GLTFExporter;AFRAME.registerSystem('saveload',{schema:{downloadGltfButton:{default:'downloadGltfButton'},downloadGltfWithGroundButton:{default:'downloadGltfWithGroundButton'},downloadJsonButton:{default:'downloadJsonButton'}},init:function(){var e=this.el,t=this.data;return this.el.systems.state?void(this.saveState={},this.save=this.save.bind(this),siteName=window.location.pathname.replace('craft/',''),siteName=siteName.replace('/',''),AFRAME.utils.getUrlParameter('scene')?this.loadSiteFromQueryParam(AFRAME.utils.getUrlParameter('scene')):siteName?this.loadSiteFromAPI(siteName):this.loadSiteFromIDB(),setInterval(()=>{this.save()},15000),this.el.addEventListener('saveloadsave',this.save),this.el.addEventListener('sitepublishsuccess',()=>{setTimeout(()=>{this.save()})}),window.addEventListener('beforeunload',this.save),this.el.addEventListener('loaded',()=>{this.initDownloadGltfButton(document.getElementById(t.downloadGltfButton)),this.initDownloadGltfWithGroundButton(document.getElementById(t.downloadGltfWithGroundButton)),this.initDownloadJsonButton(document.getElementById(t.downloadJsonButton))})):void setTimeout(()=>{this.init()},50)},updateSaveState:function(){var e;e=this.el.sceneEl.systems.state.state,this.saveState.entities=e.entities,this.saveState.entityId=e.entityId,this.saveState.environment=e.environment,this.saveState.isSitePublished=e.isSitePublished,this.saveState.name=e.siteName,this.saveState.shapeId=e.shapeId},save:function(){var e=this.el,t;return t=e.systems.state.state,new Promise((i)=>{e.systems.indexeddb.getSite(t.siteName).then(()=>{this.updateSaveState(),e.systems.indexeddb.updateSite(this.saveState),localStorage.setItem('supercraftLastSiteName',t.siteName),i(this.saveState)})})},load:function(e,t){document.title=`Supercraft | ${e.name}`,t!==void 0&&(e.isSitePublished=t),this.el.sceneEl.emit('loadsite',{data:e,name:e.name})},loadSiteFromIDB:function(e){var t=this.el,e;return e=e||localStorage.getItem('supercraftLastSiteName'),e?new Promise((i)=>{t.sceneEl.systems.indexeddb.getSite(e).then((e)=>{e&&(this.load(e),i())})}):void 0},loadSiteFromAPI:function(e){var t;t=new XMLHttpRequest,t.onload=()=>{o.parse(t.responseText).then((e)=>{this.load(e,!0)})},this.isLoadingFromAPI=!0,this.el.emit('siteloadstart',null,!1),t.open('GET',`https://supercraftsite.s3.amazonaws.com/${e}`),t.send()},loadSiteFromQueryParam:function(e){var t;t=new XMLHttpRequest,t.onload=()=>{o.parse(t.responseText).then((e)=>{e.isSitePublished=!1,this.load(e)})},t.open('GET',e),t.send()},initDownloadJsonButton:function(e){e.addEventListener('click',()=>{this.updateSaveState(),a(JSON.stringify(this.saveState),`${this.saveState.name}.json`)})},initDownloadGltfButton:function(e){e.addEventListener('click',()=>{s.parse(document.getElementById('entities').object3D,(e)=>{this.updateSaveState(),a(e,`${this.saveState.name}.glb`,'application/octet-stream')},{binary:!0,forceIndices:!0})})},initDownloadGltfWithGroundButton:function(e){e.addEventListener('click',()=>{s.parse([document.getElementById('entities').object3D,document.querySelector('.environmentGround').object3D],(e)=>{this.updateSaveState(),a(e,`${this.saveState.name}.glb`,'application/octet-stream')},{binary:!0,forceIndices:!0})})}})},function(e,t,i){function a(e){return 1<e?(e-=1,e/=2,e+=1,e):(e=1-e,e/=2,e=1-e,e)}var n=Math.max,o=i(8);AFRAME.registerComponent('scaler',{schema:{cameraScaleFactor:{default:1},enabled:{default:!0},entityId:{type:'string'},gridTransform:{default:!1}},init:function(){var e=this.el;this.isScaling=!1,this.initialHandPosOffset=new THREE.Vector3,this.originalCenter=new THREE.Vector3,this.originalMax=new THREE.Vector3,this.originalMaxLocal=new THREE.Vector3,this.originalMaxNormalized=new THREE.Vector3,this.originalMin=new THREE.Vector3,this.originalMinLocal=new THREE.Vector3,this.originalPosition=new THREE.Vector3,this.originalScale=new THREE.Vector3,this.scaleEndEventDetail={},this.scalePointPosition=new THREE.Vector3,this.targetEl=null,this.isUniformScaling=!1,this.isTooZoomedOut=!1,this.scalePoint=this.createScalePoint(),this.scalePoint.addEventListener('mouseenter',()=>{!this.data.enabled||this.isScaling||this.isTooZoomedOut||(this.scalePointHit=!0,this.scalePoint.children[0].setAttribute('material','color','#FFF'),e.sceneEl.emit('uniformscaleenable'),e.sceneEl.emit('scalepointhitstart'))}),this.scalePoint.addEventListener('mouseleave',()=>{this.scalePointHit=!1;this.isScaling||(this.scalePoint.children[0].setAttribute('material','color','#24CAFF'),e.sceneEl.emit('uniformscaledisable'),e.sceneEl.emit('scalepointhitend'))}),e.addEventListener('thumbstart',()=>{this.scalePointHit&&this.scaleStart(!0)}),e.addEventListener('thumbend',()=>{this.scaleEnd(),this.scalePoint.children[0].setAttribute('material','color','#24CAFF')}),e.addEventListener('triggerdown',()=>{this.scalePointHit&&this.scaleStart(!1)}),e.addEventListener('triggerup',()=>{this.scaleEnd()})},update:function(e){var t=this.data;e.entityId!==t.entityId&&(t.entityId?this.targetEl=document.getElementById(t.entityId):this.targetEl=null),this.scalePoint.object3D.scale.set(t.cameraScaleFactor,t.cameraScaleFactor,t.cameraScaleFactor),setTimeout(()=>{this.scalePoint.object3D.visible=!!t.entityId&&!!this.targetEl&&t.enabled}),t.cameraScaleFactor!==e.cameraScaleFactor&&setTimeout(()=>{this.disableIfTooZoomedOut(this.scalePoint.object3D.visible)})},disableIfTooZoomedOut:function(){var e=new THREE.Vector3;return function(t){var i;this.targetEl&&(this.el.sceneEl.components['bounding-box'].box.getSize(e),i=n(e.x,e.y,e.z),this.isTooZoomedOut=i<0.04*this.data.cameraScaleFactor,this.isTooZoomedOut?this.scalePoint.removeAttribute('raycastable'):this.scalePoint.setAttribute('raycastable',''),t&&(this.scalePoint.object3D.visible=!this.isTooZoomedOut))}}(),scaleStart:function(e){var t=this.el,i=this.targetEl,a;this.scalePointHit&&i&&(this.isUniformScaling=e,this.isUniformScaling?t.sceneEl.emit('uniformscalestart'):t.sceneEl.emit('uniformscaledisable'),a=this.el.sceneEl.components['bounding-box'],i.object3D.updateMatrixWorld(),this.isScaling=!0,this.originalScale.copy(i.object3D.scale),this.originalPosition.copy(i.object3D.position),a.maxObject3D.getWorldPosition(this.originalMax),i.object3D.worldToLocal(this.originalMaxLocal.copy(this.originalMax)),a.minObject3D.getWorldPosition(this.originalMin),i.object3D.worldToLocal(this.originalMinLocal.copy(this.originalMin)),this.el.object3D.getWorldPosition(this.initialHandPosOffset),this.initialHandPosOffset.sub(this.originalMax),t.sceneEl.emit('scalestart'))},scaleEnd:function(){var e=this.el,t=this.targetEl;this.isScaling&&(this.isScaling=!1,this.isUniformScaling&&e.sceneEl.emit('uniformscaleend'),!this.scalePointHit&&e.sceneEl.emit('scalepointhitend'),this.isUniformScaling&&!this.scalePointHit&&e.sceneEl.emit('uniformscaledisable'),!this.isUniformScaling&&this.scalePointHit&&e.sceneEl.emit('uniformscaleenable'),this.scaleEndEventDetail.id=t.getAttribute('id'),this.scaleEndEventDetail.position=t.getAttribute('position'),this.scaleEndEventDetail.scale=t.getAttribute('scale'),e.sceneEl.emit('scaleend',this.scaleEndEventDetail),this.disableIfTooZoomedOut(!0))},createScalePoint:function(){var e,t;return e=document.createElement('a-entity'),e.setAttribute('id','scalePoint'),e.setAttribute('geometry',{primitive:'box',width:0.04,depth:0.04,height:0.04}),e.setAttribute('material',{shader:'flat',visible:!1}),e.setAttribute('mixin','uiSoundsCollider'),e.object3D.visible=!1,t=document.createElement('a-entity'),t.setAttribute('id','scalePointMesh'),t.setAttribute('geometry',{primitive:'octahedron',radius:0.015}),t.setAttribute('material',{color:'#24CAFF'}),t.object3D.visible=!0,e.appendChild(t),this.el.sceneEl.appendChild(e),e},tick:function(){var e=new THREE.Object3D,t=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3;return function(){var s=this.data,l=this.el,d=this.originalScale,c=this.targetEl,u=this.scalePoint,p=this.scalePointPosition,g,m,h,b;(e.parent||this.el.sceneEl.object3D.add(e),!!c)&&(m=this.el.sceneEl.components['bounding-box'],c.object3D.updateMatrixWorld(),m.maxObject3D.getWorldPosition(u.object3D.position),this.isScaling&&(b=c.object3D.scale,this.el.object3D.getWorldPosition(t).sub(this.initialHandPosOffset),c.object3D.scale.copy(d),c.object3D.position.copy(this.originalPosition),c.object3D.updateMatrixWorld(),c.object3D.worldToLocal(t),this.originalMaxLocal.z=n(this.originalMaxLocal.z,1e-3),h=t.divide(this.originalMaxLocal),this.isUniformScaling?(g=(h.x+h.y+h.z)/3,b.set(a(g)*d.x,a(g)*d.y,a(g)*d.z)):b.set(a(h.x)*d.x,a(h.y)*d.y,a(h.z)*d.z),s.gridTransform&&o.snapScale(b,this.data.cameraScaleFactor),b.set(n(b.x,1e-3),n(b.y,1e-3),n(b.z,1e-3)),c.object3D.updateMatrixWorld(),m.minObject3D.getWorldPosition(i),c.object3D.position.add(r.copy(this.originalMin).sub(i))))}}()})},function(){AFRAME.registerComponent('selector',{schema:{enabled:{default:!1},playMode:{default:!1},raycasterId:{default:'entityRaycaster'}},init:function(){var e=this.el;this.eventDetail={},this.raycaster=null,this.selectedEntity=null,this.raycasterEl=document.getElementById(this.data.raycasterId),this.cursor=this.raycasterEl.components.cursor,this.raycasterEl.addEventListener('mouseenter',(e)=>{this.select(e.detail.intersectedEl)}),this.raycasterEl.addEventListener('mouseleave',()=>{this.data.playMode&&e.emit('unfocusentity')})},update:function(e){!e.enabled&&this.data.enabled&&this.cursor.intersectedEl&&this.select(this.cursor.intersectedEl)},select:function(e){this.data.enabled&&SUPERCRAFT.utils.isSelectable(e)&&(this.selectedEntity&&this.selectedEntity.removeAttribute('data-focused-entity'),e.setAttribute('data-focused-entity',''),this.selectedEntity=e,this.eventDetail.id=e.getAttribute('id'),this.el.emit('focusentity',this.eventDetail))}})},function(){function e(){return /(OculusBrowser)|(SamsungBrowser)|(Mobile VR)/i.test(window.navigator.userAgent)}AFRAME.registerSystem('shadow-type',{init:function(){AFRAME.utils.device.isMobile()||e()?this.el.setAttribute('shadow','type','pcf'):this.el.setAttribute('shadow','type','pcfsoft')}})},function(){var e=100;AFRAME.registerComponent('shape-add-effect',{init:function(){var t=this.el,i;i=new THREE.Vector3,i.copy(t.object3D.scale),t.object3D.scale.multiplyScalar(0.2),t.setAttribute('animation__shapeaddeffectscale',{property:'scale',easing:'easeInOutCubic',to:`${i.x} ${i.y} ${i.z}`,dur:e}),setTimeout(()=>{this.el.sceneEl.querySelector('[scaler]').components.scaler.disableIfTooZoomedOut(!0)},e+50)}})},function(){AFRAME.registerComponent('staged-entity',{schema:{scriptMode:{default:!1},stagedEntityId:{type:'string'}},update:function(e){return!e.scriptMode&&this.data.scriptMode?void this.setDataStagedChildren(this.data.stagedEntityId,!1):e.scriptMode&&!this.data.scriptMode?void this.setDataStagedChildren(this.data.stagedEntityId,!0):void(this.setDataStaged(e.stagedEntityId,!1),this.setDataStaged(this.data.stagedEntityId,!0))},setDataStaged:function(e,t){var i;e&&(i=document.getElementById(e),i&&(t?i.setAttribute('data-staged',''):i.removeAttribute('data-staged'),this.setDataStagedChildren(e,t)))},setDataStagedChildren:function(e,t){var a,n;for(a=document.getElementById(e),n=0;n<a.children.length;n++)t?a.children[n].setAttribute('data-staged',''):a.children[n].removeAttribute('data-staged')}})},function(){AFRAME.registerComponent('sub-object',{schema:{from:{default:'',type:'selector'},name:{default:''}},init:function(){var e=this.el,t=this.data;t.from.addEventListener('model-loaded',(i)=>{var a,n;a=i.detail.model,n=a.getObjectByName(t.name),e.setObject3D('mesh',n.clone()),e.emit('subobjectloaded')})}})},function(){AFRAME.registerComponent('super-material-active-color',{schema:{active:{default:!1},activeColor:{default:'#EFEFEF'}},init:function(){var e=this.el,t=this;this.el.getAttribute('super-material')?this.originalColor=this.el.getAttribute('super-material').color:e.addEventListener('componentinitialized',function i(a){'super-material'!==a.detail.name||(t.originalColor=e.getAttribute('super-material').color,e.removeEventListener('componentinitialized',i))})},update:function(){var e=this.data.active?this.data.activeColor:this.originalColor;this.el.setAttribute('super-material','color',e)}})},function(){AFRAME.registerComponent('teleport-listener',{dependencies:['teleport-controls'],init:function(){var e=this.el,t,i,a,n;this.currentIntersection=null,i=e.components['teleport-controls'].intersections,n=document.getElementById('teleportFader'),this.el.addEventListener('teleported',()=>{var t;i.length&&(document.getElementById('cameraRig').object3D.updateMatrixWorld(),e.sceneEl.camera.updateMatrixWorld(),e.sceneEl.camera.getWorldPosition(n.object3D.position),n.object3D.visible=!0,t=setTimeout(()=>{n.object3D.visible=!1},160))}),t=this.hitEntity=e.components['teleport-controls'].hitEntity,t.setAttribute('shadow',{cast:!0,receive:!1}),t.setAttribute('material','opacity',0.5),t.setAttribute('animation__scale',{property:'scale',from:'1 1 1',to:'1.2 1.2 1.4',easing:'easeInOutCubic',dir:'alternate',dur:1200,loop:!0}),a=e.components['teleport-controls'].teleportEntity,a.getObject3D('mesh').material.opacity=0.5,a.getObject3D('mesh').material.transparent=!0,a.setAttribute('shadow',{cast:!0,receive:!1})}})},function(){AFRAME.registerComponent('teleport-refresh',{schema:{isLoadingSite:{default:!1},playMode:{default:!1}},update:function(){this.refresh()},play:function(){this.refresh()},refresh:function(){var e,t;setTimeout(()=>{for(t=document.querySelectorAll('a-entity[teleport-controls]'),e=0;e<t.length;e++)t[e].components['teleport-controls'].refreshMeshes()},500)}})},function(){AFRAME.registerComponent('teleporter',{schema:{enabled:{default:!0}},init:function(){this.isTeleporting=!1,this.el.addEventListener('thumbupstart',this.beginTeleport.bind(this)),this.el.addEventListener('thumbupend',this.commitTeleport.bind(this))},beginTeleport:function(){this.isTeleporting||(this.isTeleporting=!0,this.el.emit('teleporterstart'))},commitTeleport:function(){this.isTeleporting&&(this.isTeleporting=!1,this.el.emit('teleporterend'))}})},function(){var e='PAD',t='STICK',a=[0,90,180,270],n=['right','up','left','down'],i={NULL:{START:'thumbstart',END:'thumbend'}};n.forEach((e)=>{i[e]={},i[e].START='thumb'+e+'start',i[e].END='thumb'+e+'end'});var o=240;AFRAME.registerComponent('thumb-controls',{dependencies:['tracked-controls'],schema:{thresholdAngle:{default:89.5},thresholdPad:{default:0.05},thresholdStick:{default:0.75}},init:function(){var i=this.el;this.onTrackpadDown=this.onTrackpadDown.bind(this),this.onTrackpadUp=this.onTrackpadUp.bind(this),this.directionStick='',this.directionTrackpad='',this.type=t,i.addEventListener('controllerconnected',(i)=>'oculus-touch-controls'===i.detail.name||'windows-motion-controls'===i.detail.name?void(this.type=t):void(this.type=e)),this.axis=i.components['tracked-controls'].axis},play:function(){var e=this.el;e.addEventListener('trackpaddown',this.onTrackpadDown),e.addEventListener('trackpadup',this.onTrackpadUp)},pause:function(){var e=this.el;e.removeEventListener('trackpaddown',this.onTrackpadDown),e.removeEventListener('trackpadup',this.onTrackpadUp)},onTrackpadDown:function(){var e=this.el,t;this.getDistance()<this.data.thresholdPad||(t=this.getDirection(),t&&(this.directionTrackpad=t,e.emit(i.NULL.START,null,!1),e.emit(i[this.directionTrackpad].START,null,!1)))},onTrackpadUp:function(){var e=this.el;this.directionTrackpad&&(e.emit(i.NULL.END,null,!1),e.emit(i[this.directionTrackpad].END,null,!1),this.directionTrackpad='')},tick:function(){var t=this.el,a;return this.type===e?void 0:!this.directionStick&&this.getDistance()>this.data.thresholdStick?(a=this.getDirection(),!a)?void 0:(this.directionStick=a,t.emit(i.NULL.START,null,!1),void t.emit(i[this.directionStick].START,null,!1)):void(this.directionStick&&this.getDistance()<this.data.thresholdStick&&(t.emit(i.NULL.END,null,!1),t.emit(i[this.directionStick].END,null,!1),this.directionStick=''))},getDistance:function(){var e=this.axis;return Math.sqrt(e[1]*e[1]+e[0]*e[0])},getDirection:function(){var e,t,o,i,r;for(e=this.getAngle(),i=this.data.thresholdAngle/2,o=0;o<a.length;o++){if(r=a[o]+i,360<r&&(r-=360),t=a[o]-i,0>t&&(e>=360+t&&360>=e||0<=e&&e<=r))return n[o];if(e>=t&&e<=r)return n[o]}},getAngle:function(){var e=this.axis,i,a;return a=this.type===t?-1:1,i=Math.atan2(e[1]*a,e[0]),0>i&&(i=2*Math.PI+i),THREE.Math.radToDeg(i)}}),AFRAME.registerComponent('thumb-controls-debug',{dependencies:['tracked-controls'],schema:{controllerType:{type:'string'},hand:{type:'string'},enabled:{default:!1}},init:function(){var e=this.el,t=this.data,i,a,n,r;(t.enabled||AFRAME.utils.getUrlParameter('debug-thumb'))&&(console.log('%c debug-thumb','background: #111; color: red'),e.components['tracked-controls'].handleAxes=()=>{},a=[0,0,0],n={axis:a},e.components['tracked-controls'].axis=a,r=this.createCanvas(),r.addEventListener('click',()=>{'vive-controls'===this.data.controllerType?i?e.emit('trackpadup'):e.emit('trackpaddown'):i&&(a[0]=0,a[1]=0,e.emit('axismove',n,!1)),i=!i}),r.addEventListener('mousemove',(t)=>{var s;i&&(s=r.getBoundingClientRect(),a[0]=2*((t.clientX-s.left)/o)-1,a[1]=2*((t.clientY-s.top)/o)-1,e.emit('axismove',n,!1))}),r.addEventListener('mouseleave',()=>{i&&(a[0]=0,a[1]=0,e.emit('axismove',n,!1))}))},createCanvas:function(){var e,t;return e=document.createElement('canvas'),e.classList.add('debugThumb'),e.height=o,e.width=o,e.style.bottom=0,e.style.borderRadius='250px',e.style.opacity=0.5,e.style.position='fixed',e.style.zIndex=999999999,'left'===this.data.hand?e.style.left=0:e.style.right=0,t=e.getContext('2d'),t.fillStyle='#333',t.fillRect(0,0,o,o),document.body.appendChild(e),e}})},function(){AFRAME.registerComponent('tip-normal',{dependencies:['super-material'],schema:{highlightColor:{default:'blue'},isFocusedEntityTouched:{default:!1}},init:function(){this.defaultColor=this.el.getAttribute('super-material').color},update:function(){this.el.setAttribute('super-material','color',this.data.isFocusedEntityTouched?this.data.highlightColor:this.defaultColor)}})},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=i(0),n=i.n(a);AFRAME.registerComponent('tutorial-cursor',{dependencies:['cursor'],schema:{enabled:{default:!1}},init:function(){this.cursor=this.el.components.cursor,this.raycaster=this.el.components.raycaster,this.camera=this.el.sceneEl.camera,this.pauseButtonPos=document.getElementById('videoTutorialPause').object3D.position,this.playButtonPos=document.getElementById('videoTutorialPlay').object3D.position,this.video=document.getElementById('tutorialVideo'),this.videoGroup=document.getElementById('videoTutorialGroup').object3D},update:function(){var e=new THREE.Vector3;return function(t){this.data.enabled===t.enabled||(this.data.enabled?(this.camera.getWorldDirection(e),e.y=0,e.normalize(),this.videoGroup.position.x=3.5*-e.x,this.videoGroup.position.z=3.5*-e.z,this.videoGroup.lookAt(this.camera.position)):this.video.pause())}}(),triggerdown:i.i(a.bindEvent)(function(){var e;if(this.data.enabled&&(e=this.cursor.intersectedEl,!!e))switch(e.parentNode.id){case'videoTutorialPlay':{this.video.play(),this.playButtonPos.z=-0.01,this.pauseButtonPos.z=0.01;break}case'videoTutorialPause':{this.video.pause(),this.playButtonPos.z=0.01,this.pauseButtonPos.z=-0.01;break}case'videoTutorialRewind':{this.video.currentTime-=10;break}case'videoTutorialForward':{this.video.currentTime+=10;break}}})})},function(e,t,i){'use strict';function a(e){e.parentNode.removeChild(e)}Object.defineProperty(t,'__esModule',{value:!0});var n=i(0),o=i.n(n);AFRAME.registerComponent('ui',{schema:{isSitePublished:{default:''},siteName:{default:''}},init:function(){this.actions=document.getElementById('actions'),this.actionsMenu=document.getElementById('actionsMenu'),this.actionsMenuClose=document.getElementById('actionsMenuClose'),this.actionsToggle=document.getElementById('actionsToggle'),this.gifClose=document.getElementById('gifClose'),this.gifStudio=document.getElementById('gifStudio'),this.gifStudioToggle=document.getElementById('gifStudioToggle'),this.logo=document.getElementById('logo'),this.ui=document.getElementById('ui'),this.url=document.getElementById('url'),this.vrButton=document.getElementById('vrButton'),AFRAME.utils.device.isMobile()?this.url=null:(this.url.style.display='block',this.actionsToggle.style.display='block'),this.actionsToggle.addEventListener('click',()=>{this.actionsMenu.classList.add('actionMenuActive')}),this.actionsMenuClose.addEventListener('click',()=>{this.actionsMenu.classList.remove('actionMenuActive')}),this.gifStudioToggle.addEventListener('click',()=>{this.actionsMenu.classList.remove('actionMenuActive'),this.gifStudio.classList.add('actionMenuActive'),this.el.sceneEl.camera.el.setAttribute('gif-studio',{active:!0,siteName:this.data.siteName}),this.actions.classList.add('gifStudioActive')}),this.gifClose.addEventListener('click',()=>{this.gifStudio.classList.remove('actionMenuActive'),this.el.sceneEl.camera.el.setAttribute('gif-studio','active',!1),this.actions.classList.remove('gifStudioActive')})},update:function(){this.updateURL()},updateURL:function(){var e=this.data;this.url&&(e.siteName&&!AFRAME.utils.device.isMobile()?(this.url.innerText=e.isSitePublished?`supermedium.com/craft/${e.siteName}`:'(not yet published)',e.isSitePublished?this.url.classList.add('urlPublished'):this.url.classList.remove('urlPublished'),this.actions.classList.add('actionsActive')):(this.url.innerText='',this.actions.classList.remove('actionsActive')))},play:function(){AFRAME.utils.getUrlParameter('hideui')&&a(this.ui)},"enter-vr":i.i(n.bindEvent)(function(){AFRAME.utils.device.isMobile()&&(this.logo.style.display='none')}),"exit-vr":i.i(n.bindEvent)(function(){AFRAME.utils.device.isMobile()&&(this.logo.style.display='block')})})},function(){AFRAME.registerComponent('undo-icon',{init:function(){var e=this.el;e.closest('[thumb-controls]').addEventListener('thumbleftstart',()=>{e.setAttribute('super-material-active-color','active',!0)}),e.closest('[thumb-controls]').addEventListener('thumbleftend',()=>{e.setAttribute('super-material-active-color','active',!1)})}})},function(){AFRAME.registerSystem('user',{init:function(){var e;e=localStorage.getItem('userToken'),e||(e=THREE.Math.generateUUID(),localStorage.setItem('userToken',e)),this.userToken=e}})},function(e){e.exports.PALETTE={blue:'#48BAEA',lightblue:'#8CEEFF',gray:'#717171',yellow:'#e0cb49',green:'#65b731',orange:'#F85333',white:'#DADADA'},e.exports.COLORS=[['black','#111','Black'],['gray','#666','Gray'],['lightgray','#B4AEAA','Light Gray'],['white','#F2EDED','White'],['darkbrown','#2b2118','Dark Brown'],['brown','#8D4126','Brown'],['orange','#EF893B','Orange'],['yellow','#DAD45E','Yellow'],['darkred','#392534','Dark Red'],['red','#A32118','Red'],['maroon','#D04648','Maroon'],['pink','#EDA78A','Pink'],['blue','#1E3C60','Blue'],['green','#416132','Green'],['teal','#00b295','Teal'],['lightblue','#57C8EF','Light Blue'],['darkpurple','#5B464F','Dark Purple'],['purple','#6B3869','Purple'],['lightpurple','#915CB9','Light Purple'],['orangered','#F75A34','Orange Red']]},function(e,t,i){'use strict';function a(e){e.keys().forEach(e)}function n(){const e=document.querySelector('form');if(!e)return;const t=e.querySelector('.submit'),i=e.querySelector('input[type="email"]'),a=document.querySelector('#subscribeForm > h2');let n='';a&&(n=a.innerHTML),e.addEventListener('submit',(e)=>{e.preventDefault();const i=new XMLHttpRequest;let n='http://localhost:5000/mail/subscribe';return n='https://supermedium.com/mail/subscribe',i.open('POST',n),i.addEventListener('load',()=>{200!==parseInt(i.status,10)&&(window.location.href='https://supermedium/subscribe/'),t&&(t.disabled=!0,t.innerHTML='Subscribed!'),a&&(a.innerHTML='Successfully subscribed, thank you!')}),i.setRequestHeader('Content-Type','application/json;charset=UTF-8'),i.send(JSON.stringify({email:document.querySelector('[name="email"]').value,source:'supercraft'})),!1}),t&&i.addEventListener('keydown',()=>{t.hasAttribute('disabled')&&(t.innerHTML='Subscribe',t.removeAttribute('disabled')),a&&n&&(a.innerHTML=n)})}Object.defineProperty(t,'__esModule',{value:!0});var o=i(41),r=i.n(o),s=i(42),l=i.n(s),d=i(43),c=i.n(d),u=i(44),p=i.n(u),g=i(46),m=i.n(g),h=i(47),b=i.n(h),y=i(45),f=i.n(y),v=i(48),E=i.n(v),x=i(49),S=i.n(x),C=i(50),A=i.n(C),T=i(51),D=i.n(T),I=i(3),j=i.n(I),w=i(52),k=i.n(w);window.log=function(){console.log.apply(console,arguments)},window.addEventListener('unhandledrejection',()=>{console.error('Unhandled rejection (promise: ',event.promise,', reason: ',event.reason)}),a(i(53)),a(i(54)),a(i(55)),document.addEventListener('DOMContentLoaded',()=>{n()})},function(){var e=Math.min,t=Math.max,n={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987},i={1003:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,1006:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,1008:n.LINEAR_MIPMAP_LINEAR},a={scale:'scale',position:'translation',quaternion:'rotation',morphTargetInfluences:'weights'};THREE.GLTFExporter=function(){},THREE.GLTFExporter.prototype={constructor:THREE.GLTFExporter,parse:function(o,r,s){function d(e,t){return e.length===t.length&&e.every(function(e,i){return e===t[i]})}function l(e){if(window.TextEncoder!==void 0)return new TextEncoder().encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),a=0,i=e.length,n;a<i;a++)n=e.charCodeAt(a),t[a]=255<n?32:n;return t.buffer}function c(n,o,r){for(var s={min:Array(n.itemSize).fill(Number.POSITIVE_INFINITY),max:Array(n.itemSize).fill(Number.NEGATIVE_INFINITY)},l=o;l<o+r;l++)for(var i=0,a;i<n.itemSize;i++)a=n.array[l*n.itemSize+i],s.min[i]=e(s.min[i],a),s.max[i]=t(s.max[i],a);return s}function u(e){return THREE.Math.isPowerOfTwo(e.width)&&THREE.Math.isPowerOfTwo(e.height)}function p(e){if(F.attributes.has(e))return!1;for(var t=new THREE.Vector3,a=0,i=e.count;a<i;a++)if(5e-4<Math.abs(t.fromArray(e.array,3*a).length()-1))return!1;return!0}function g(e){if(F.attributes.has(e))return F.textures.get(e);for(var t=e.clone(),a=new THREE.Vector3,n=0,i=t.count;n<i;n++)a.fromArray(t.array,3*n),0===a.x&&0===a.y&&0===a.z?a.setX(1):a.normalize(),a.toArray(t.array,3*n);return F.attributes.set(e,t),t}function m(e){return 4*Math.ceil(e/4)}function h(e,t){t=t||0;var a=m(e.byteLength);if(a!==e.byteLength){var n=new Uint8Array(a);if(n.set(new Uint8Array(e)),0!==t)for(var o=e.byteLength;o<a;o++)n[o]=t;return n.buffer}return e}function b(e){return L.buffers||(L.buffers=[{byteLength:0}]),P.push(e),0}function y(e,t,o,r,s){L.bufferViews||(L.bufferViews=[]);var l=t===n.UNSIGNED_BYTE?1:t===n.UNSIGNED_SHORT?2:4;for(var d=m(r*e.itemSize*l),c=new DataView(new ArrayBuffer(d)),u=0,p=o;p<o+r;p++)for(var i=0,a;i<e.itemSize;i++)a=e.array[p*e.itemSize+i],t===n.FLOAT?c.setFloat32(u,a,!0):t===n.UNSIGNED_INT?c.setUint32(u,a,!0):t===n.UNSIGNED_SHORT?c.setUint16(u,a,!0):t===n.UNSIGNED_BYTE&&c.setUint8(u,a),u+=l;var g={buffer:b(c.buffer),byteOffset:M,byteLength:d};s!==void 0&&(g.target=s),s===n.ARRAY_BUFFER&&(g.byteStride=e.itemSize*l),M+=d,L.bufferViews.push(g);var h={id:L.bufferViews.length-1,byteLength:0};return h}function f(e){return L.bufferViews||(L.bufferViews=[]),new Promise(function(t){var i=new window.FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){var e=h(i.result),a={buffer:b(e),byteOffset:M,byteLength:e.byteLength};M+=e.byteLength,L.bufferViews.push(a),t(L.bufferViews.length-1)}})}function v(i,a,o,r){var l;if(i.array.constructor===Float32Array)l=n.FLOAT;else if(i.array.constructor===Uint32Array)l=n.UNSIGNED_INT;else if(i.array.constructor===Uint16Array)l=n.UNSIGNED_SHORT;else if(i.array.constructor===Uint8Array)l=n.UNSIGNED_BYTE;else throw new Error('THREE.GLTFExporter: Unsupported bufferAttribute component type.');if(void 0===o&&(o=0),void 0===r&&(r=i.count),s.truncateDrawRange&&void 0!==a&&null===a.index){var d=o+r,u=a.drawRange.count===Infinity?i.count:a.drawRange.start+a.drawRange.count;o=t(o,a.drawRange.start),r=e(d,u)-o,0>r&&(r=0)}if(0===r)return null;var p=c(i,o,r),g;void 0!==a&&(g=i===a.index?n.ELEMENT_ARRAY_BUFFER:n.ARRAY_BUFFER);var m=y(i,l,o,r,g),h={bufferView:m.id,byteOffset:m.byteOffset,componentType:l,count:r,max:p.max,min:p.min,type:{1:'SCALAR',2:'VEC2',3:'VEC3',4:'VEC4',16:'MAT4'}[i.itemSize]};return L.accessors||(L.accessors=[]),L.accessors.push(h),L.accessors.length-1}function E(e){L.images||(L.images=[]);var t=e.format===THREE.RGBAFormat?'image/png':'image/jpeg',i={mimeType:t};if(s.embedImages){var a=z=z||document.createElement('canvas');a.width=e.image.width,a.height=e.image.height,s.forcePowerOfTwoTextures&&!u(e.image)&&(console.warn('GLTFExporter: Resized non-power-of-two image.',e.image),a.width=THREE.Math.floorPowerOfTwo(a.width),a.height=THREE.Math.floorPowerOfTwo(a.height));var n=a.getContext('2d');!0===e.flipY&&(n.translate(0,a.height),n.scale(1,-1)),n.drawImage(e.image,0,0,a.width,a.height),!0===s.binary?R.push(new Promise(function(e){a.toBlob(function(t){f(t).then(function(t){i.bufferView=t,e()})},t)})):i.uri=a.toDataURL(t)}else i.uri=e.image.src;return L.images.push(i),L.images.length-1}function x(e){L.samplers||(L.samplers=[]);var t={magFilter:i[e.magFilter],minFilter:i[e.minFilter],wrapS:i[e.wrapS],wrapT:i[e.wrapT]};return L.samplers.push(t),L.samplers.length-1}function S(e){if(F.textures.has(e))return F.textures.get(e);L.textures||(L.textures=[]);var t={sampler:x(e),source:E(e)};L.textures.push(t);var i=L.textures.length-1;return F.textures.set(e,i),i}function C(e){if(F.materials.has(e))return F.materials.get(e);if(L.materials||(L.materials=[]),e.isShaderMaterial)return console.warn('GLTFExporter: THREE.ShaderMaterial not supported.'),null;var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},B.KHR_materials_unlit=!0):!e.isMeshStandardMaterial&&console.warn('GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.');var i=e.color.toArray().concat([e.opacity]);if(d(i,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=i),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=0.9):(t.pbrMetallicRoughness.metallicFactor=0.5,t.pbrMetallicRoughness.roughnessFactor=0.5),(e.metalnessMap||e.roughnessMap)&&(e.metalnessMap===e.roughnessMap?t.pbrMetallicRoughness.metallicRoughnessTexture={index:S(e.metalnessMap)}:console.warn('THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.')),e.map&&(t.pbrMetallicRoughness.baseColorTexture={index:S(e.map)}),e.isMeshBasicMaterial||e.isLineBasicMaterial||e.isPointsMaterial);else{var a=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();d(a,[0,0,0])||(t.emissiveFactor=a),e.emissiveMap&&(t.emissiveTexture={index:S(e.emissiveMap)})}e.normalMap&&(t.normalTexture={index:S(e.normalMap)},-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn('THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X.'),t.normalTexture.scale=e.normalScale.x)),e.aoMap&&(t.occlusionTexture={index:S(e.aoMap)},1!==e.aoMapIntensity&&(t.occlusionTexture.strength=e.aoMapIntensity)),(e.transparent||0<e.alphaTest)&&(t.alphaMode=1>e.opacity?'BLEND':'MASK',0<e.alphaTest&&0.5!==e.alphaTest&&(t.alphaCutoff=e.alphaTest)),e.side===THREE.DoubleSide&&(t.doubleSided=!0),''!==e.name&&(t.name=e.name),L.materials.push(t);var n=L.materials.length-1;return F.materials.set(e,n),n}function A(e){var t=e.geometry,a;if(e.isLineSegments)a=n.LINES;else if(e.isLineLoop)a=n.LINE_LOOP;else if(e.isLine)a=n.LINE_STRIP;else if(e.isPoints)a=n.POINTS;else{if(!t.isBufferGeometry){var o=new THREE.BufferGeometry;o.fromGeometry(t),t=o}e.drawMode===THREE.TriangleFanDrawMode?(console.warn('GLTFExporter: TriangleFanDrawMode and wireframe incompatible.'),a=n.TRIANGLE_FAN):e.drawMode===THREE.TriangleStripDrawMode?a=e.material.wireframe?n.LINE_STRIP:n.TRIANGLE_STRIP:a=e.material.wireframe?n.LINES:n.TRIANGLES}var r={},l={},d=[],c=[],u={uv:'TEXCOORD_0',uv2:'TEXCOORD_1',color:'COLOR_0',skinWeight:'WEIGHTS_0',skinIndex:'JOINTS_0'},m=t.getAttribute('normal');for(var h in void 0===m||p(m)||(console.warn('THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one.'),t.addAttribute('normal',g(m))),t.attributes){var b=t.attributes[h];h=u[h]||h.toUpperCase();var y=b.array;if('JOINTS_0'!==h||y instanceof Uint16Array||y instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),b=new THREE.BufferAttribute(new Uint16Array(y),b.itemSize,b.normalized)),'MORPH'!==h.substr(0,5)){var f=v(b,t);null!==f&&(l[h]=f)}}if(void 0!==m&&t.addAttribute('normal',m),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&0<e.morphTargetInfluences.length){var E=[],x=[],S={};if(void 0!==e.morphTargetDictionary)for(var A in e.morphTargetDictionary)S[e.morphTargetDictionary[A]]=A;for(var T=0;T<e.morphTargetInfluences.length;++T){var i={},D=!1;for(var h in t.morphAttributes){if('position'!==h&&'normal'!==h){D||(console.warn('GLTFExporter: Only POSITION and NORMAL morph are supported.'),D=!0);continue}for(var b=t.morphAttributes[h][T],I=t.attributes[h],w=b.clone(),k=0,j=b.count;k<j;k++)w.setXYZ(k,b.getX(k)-I.getX(k),b.getY(k)-I.getY(k),b.getZ(k)-I.getZ(k));i[h.toUpperCase()]=v(w,t)}c.push(i),E.push(e.morphTargetInfluences[T]),void 0!==e.morphTargetDictionary&&x.push(S[T])}r.weights=E,0<x.length&&(r.extras={},r.extras.targetNames=x)}var M=s.forceIndices,P=Array.isArray(e.material);if(P&&0===e.geometry.groups.length)return null;!M&&null===t.index&&P&&(console.warn('THREE.GLTFExporter: Creating index for non-indexed multi-material mesh.'),M=!0);var R=!1;if(null===t.index&&M){for(var O=[],T=0,N=t.attributes.position.count;T<N;T++)O[T]=T;t.setIndex(O),R=!0}for(var B=P?e.material:[e.material],F=P?e.geometry.groups:[{materialIndex:0,start:void 0,count:void 0}],T=0,N=F.length,z;T<N;T++){z={mode:a,attributes:l},0<c.length&&(z.targets=c),null!==t.index&&(z.indices=v(t.index,t,F[T].start,F[T].count));var U=C(B[F[T].materialIndex]);null!==U&&(z.material=U),d.push(z)}return R&&t.setIndex(null),r.primitives=d,L.meshes||(L.meshes=[]),L.meshes.push(r),L.meshes.length-1}function T(e){L.cameras||(L.cameras=[]);var t=e.isOrthographicCamera,i={type:t?'orthographic':'perspective'};return t?i.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:0>=e.far?1e-3:e.far,znear:0>e.near?0:e.near}:i.perspective={aspectRatio:e.aspect,yfov:THREE.Math.degToRad(e.fov)/e.aspect,zfar:0>=e.far?1e-3:e.far,znear:0>e.near?0:e.near},''!==e.name&&(i.name=e.type),L.cameras.push(i),L.cameras.length-1}function D(e,t){L.animations||(L.animations=[]);for(var n=[],o=[],r=0;r<e.tracks.length;++r){var i=e.tracks[r],s=THREE.PropertyBinding.parseTrackName(i.name),l=THREE.PropertyBinding.findNode(t,s.nodeName),d=a[s.propertyName];if('bones'===s.objectName&&(!0===l.isSkinnedMesh?l=l.skeleton.getBoneByName(s.objectIndex):l=void 0),!l||!d)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',i.name),null;var c=i.values.length/i.times.length;d===a.morphTargetInfluences&&(c/=l.morphTargetInfluences.length);var u;!0===i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(u='CUBICSPLINE',c/=3):i.getInterpolation()===THREE.InterpolateDiscrete?u='STEP':u='LINEAR',o.push({input:v(new THREE.BufferAttribute(i.times,1)),output:v(new THREE.BufferAttribute(i.values,c)),interpolation:u}),n.push({sampler:o.length-1,target:{node:O.get(l),path:d}})}return L.animations.push({name:e.name||'clip_'+L.animations.length,samplers:o,channels:n}),L.animations.length-1}function I(e){var t=L.nodes[O.get(e)],a=e.skeleton,n=e.skeleton.bones[0];if(n===void 0)return null;for(var o=[],r=new Float32Array(16*a.bones.length),s=0;s<a.bones.length;++s)o.push(O.get(a.bones[s])),a.boneInverses[s].toArray(r,16*s);L.skins===void 0&&(L.skins=[]),L.skins.push({inverseBindMatrices:v(new THREE.BufferAttribute(r,16)),joints:o,skeleton:O.get(n)});var i=t.skin=L.skins.length-1;return i}function j(e){if(e.isLight)return console.warn('GLTFExporter: Unsupported node type:',e.constructor.name),null;L.nodes||(L.nodes=[]);var t={};if(s.trs){var a=e.quaternion.toArray(),n=e.position.toArray(),o=e.scale.toArray();d(a,[0,0,0,1])||(t.rotation=a),d(n,[0,0,0])||(t.translation=n),d(o,[1,1,1])||(t.scale=o)}else e.updateMatrix(),d(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(''!==e.name&&(t.name=e.name+''),e.userData&&0<Object.keys(e.userData).length)try{t.extras=JSON.parse(JSON.stringify(e.userData))}catch(t){throw new Error('THREE.GLTFExporter: userData can\'t be serialized')}if(e.isMesh||e.isLine||e.isPoints){var r=A(e);null!==r&&(t.mesh=r)}else e.isCamera&&(t.camera=T(e));if(e.isSkinnedMesh&&N.push(e),0<e.children.length){for(var c=[],u=0,i=e.children.length,l;u<i;u++)if(l=e.children[u],l.visible||!1===s.onlyVisible){var p=j(l);null!==p&&c.push(p)}0<c.length&&(t.children=c)}L.nodes.push(t);var g=L.nodes.length-1;return O.set(e,g),g}function w(e){L.scenes||(L.scenes=[],L.scene=0);var t={nodes:[]};''!==e.name&&(t.name=e.name),L.scenes.push(t);for(var a=[],n=0,i=e.children.length,o;n<i;n++)if(o=e.children[n],o.visible||!1===s.onlyVisible){var r=j(o);null!==r&&a.push(r)}0<a.length&&(t.nodes=a)}function k(e){var t=new THREE.Scene;t.name='AuxScene';for(var a=0;a<e.length;a++)t.children.push(e[a]);w(t)}s=Object.assign({},{trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1},s),0<s.animations.length&&(s.trs=!0);var L={asset:{version:'2.0',generator:'THREE.GLTFExporter'}},M=0,P=[],R=[],O=new Map,N=[],B={},F={attributes:new Map,materials:new Map,textures:new Map},z;(function(e){e=e instanceof Array?e:[e];for(var t=[],a=0;a<e.length;a++)e[a]instanceof THREE.Scene?w(e[a]):t.push(e[a]);0<t.length&&k(t);for(var a=0;a<N.length;++a)I(N[a]);for(var a=0;a<s.animations.length;++a)D(s.animations[a],e[0])})(o),Promise.all(R).then(function(){var e=new Blob(P,{type:'application/octet-stream'}),t=Object.keys(B);if(0<t.length&&(L.extensionsUsed=t),L.buffers&&0<L.buffers.length){L.buffers[0].byteLength=e.size;var i=new window.FileReader;if(!0===s.binary){var a=12,n=8;i.readAsArrayBuffer(e),i.onloadend=function(){var e=h(i.result),t=new DataView(new ArrayBuffer(n));t.setUint32(0,e.byteLength,!0),t.setUint32(4,5130562,!0);var o=h(l(JSON.stringify(L)),32),s=new DataView(new ArrayBuffer(n));s.setUint32(0,o.byteLength,!0),s.setUint32(4,1313821514,!0);var d=new ArrayBuffer(a),c=new DataView(d);c.setUint32(0,1179937895,!0),c.setUint32(4,2,!0);var u=a+s.byteLength+o.byteLength+t.byteLength+e.byteLength;c.setUint32(8,u,!0);var p=new Blob([d,s,o,t,e],{type:'application/octet-stream'}),g=new window.FileReader;g.readAsArrayBuffer(p),g.onloadend=function(){r(g.result)}}}else i.readAsDataURL(e),i.onloadend=function(){var e=i.result;L.buffers[0].uri=e,r(L)}}else r(L)})}}},function(){var e=Math.sqrt,t=Math.min,i=Math.PI,a=Math.max;THREE.OrbitControls=function(n,o){function r(){return 2*i/60/60*B.autoRotateSpeed}function s(){return Math.pow(0.95,B.zoomSpeed)}function l(e){W.theta-=e}function d(e){W.phi-=e}function c(e){B.object.isPerspectiveCamera?q/=e:B.object.isOrthographicCamera?(B.object.zoom=a(B.minZoom,t(B.maxZoom,B.object.zoom*e)),B.object.updateProjectionMatrix(),Z=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),B.enableZoom=!1)}function u(e){B.object.isPerspectiveCamera?q*=e:B.object.isOrthographicCamera?(B.object.zoom=a(B.minZoom,t(B.maxZoom,B.object.zoom/e)),B.object.updateProjectionMatrix(),Z=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),B.enableZoom=!1)}function p(e){K.set(e.clientX,e.clientY)}function g(e){te.set(e.clientX,e.clientY)}function m(e){J.set(e.clientX,e.clientY)}function h(e){Q.set(e.clientX,e.clientY),X.subVectors(Q,K);var t=B.domElement===document?B.domElement.body:B.domElement;l(2*i*X.x/t.clientWidth*B.rotateSpeed),d(2*i*X.y/t.clientHeight*B.rotateSpeed),K.copy(Q),B.update()}function b(e){ie.set(e.clientX,e.clientY),ae.subVectors(ie,te),0<ae.y?c(s()):0>ae.y&&u(s()),te.copy(ie),B.update()}function y(e){$.set(e.clientX,e.clientY),ee.subVectors($,J),re(ee.x,ee.y),J.copy($),B.update()}function f(){}function v(e){0>e.deltaY?u(s()):0<e.deltaY&&c(s()),B.update()}function E(e){switch(e.keyCode){case B.keys.UP:re(0,B.keyPanSpeed),B.update();break;case B.keys.BOTTOM:re(0,-B.keyPanSpeed),B.update();break;case B.keys.LEFT:re(B.keyPanSpeed,0),B.update();break;case B.keys.RIGHT:re(-B.keyPanSpeed,0),B.update();}}function x(e){K.set(e.touches[0].pageX,e.touches[0].pageY)}function S(t){var i=t.touches[0].pageX-t.touches[1].pageX,a=t.touches[0].pageY-t.touches[1].pageY,n=e(i*i+a*a);te.set(0,n)}function C(e){J.set(e.touches[0].pageX,e.touches[0].pageY)}function A(e){Q.set(e.touches[0].pageX,e.touches[0].pageY),X.subVectors(Q,K);var t=B.domElement===document?B.domElement.body:B.domElement;l(2*i*X.x/t.clientWidth*B.rotateSpeed),d(2*i*X.y/t.clientHeight*B.rotateSpeed),K.copy(Q),B.update()}function T(t){var i=t.touches[0].pageX-t.touches[1].pageX,a=t.touches[0].pageY-t.touches[1].pageY,n=e(i*i+a*a);ie.set(0,n),ae.subVectors(ie,te),0<ae.y?u(s()):0>ae.y&&c(s()),te.copy(ie),B.update()}function D(e){$.set(e.touches[0].pageX,e.touches[0].pageY),ee.subVectors($,J),re(ee.x,ee.y),J.copy($),B.update()}function I(){}function j(e){if(!1!==B.enabled){switch(e.preventDefault(),e.button){case B.mouseButtons.ORBIT:if(!1===B.enableRotate)return;p(e),H=V.ROTATE;break;case B.mouseButtons.ZOOM:if(!1===B.enableZoom)return;g(e),H=V.DOLLY;break;case B.mouseButtons.PAN:if(!1===B.enablePan)return;m(e),H=V.PAN;}H!==V.NONE&&(document.addEventListener('mousemove',w,!1),document.addEventListener('mouseup',k,!1),B.dispatchEvent(z))}}function w(e){if(!1!==B.enabled)switch(e.preventDefault(),H){case V.ROTATE:if(!1===B.enableRotate)return;h(e);break;case V.DOLLY:if(!1===B.enableZoom)return;b(e);break;case V.PAN:if(!1===B.enablePan)return;y(e);}}function k(e){!1===B.enabled||(f(e),document.removeEventListener('mousemove',w,!1),document.removeEventListener('mouseup',k,!1),B.dispatchEvent(U),H=V.NONE)}function L(e){!1===B.enabled||!1===B.enableZoom||H!==V.NONE&&H!==V.ROTATE||(e.preventDefault(),e.stopPropagation(),B.dispatchEvent(z),v(e),B.dispatchEvent(U))}function M(e){!1===B.enabled||!1===B.enableKeys||!1===B.enablePan||E(e)}function P(e){if(!1!==B.enabled){switch(e.touches.length){case 1:if(!1===B.enableRotate)return;x(e),H=V.TOUCH_ROTATE;break;case 2:if(!1===B.enableZoom)return;S(e),H=V.TOUCH_DOLLY;break;case 3:if(!1===B.enablePan)return;C(e),H=V.TOUCH_PAN;break;default:H=V.NONE;}H!==V.NONE&&B.dispatchEvent(z)}}function R(e){if(!1!==B.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===B.enableRotate)return;if(H!==V.TOUCH_ROTATE)return;A(e);break;case 2:if(!1===B.enableZoom)return;if(H!==V.TOUCH_DOLLY)return;T(e);break;case 3:if(!1===B.enablePan)return;if(H!==V.TOUCH_PAN)return;D(e);break;default:H=V.NONE;}}function O(e){!1===B.enabled||(I(e),B.dispatchEvent(U),H=V.NONE)}function N(e){!1===B.enabled||e.preventDefault()}this.object=n,this.domElement=o===void 0?document:o,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=i,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=0.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return G.phi},this.getAzimuthalAngle=function(){return G.theta},this.saveState=function(){B.target0.copy(B.target),B.position0.copy(B.object.position),B.zoom0=B.object.zoom},this.reset=function(){B.target.copy(B.target0),B.object.position.copy(B.position0),B.object.zoom=B.zoom0,B.object.updateProjectionMatrix(),B.dispatchEvent(F),B.update(),H=V.NONE},this.update=function(){var e=new THREE.Vector3,i=new THREE.Quaternion().setFromUnitVectors(n.up,new THREE.Vector3(0,1,0)),o=i.clone().inverse(),s=new THREE.Vector3,d=new THREE.Quaternion;return function(){var n=B.object.position;return e.copy(n).sub(B.target),e.applyQuaternion(i),G.setFromVector3(e),B.autoRotate&&H===V.NONE&&l(r()),G.theta+=W.theta,G.phi+=W.phi,G.theta=a(B.minAzimuthAngle,t(B.maxAzimuthAngle,G.theta)),G.phi=a(B.minPolarAngle,t(B.maxPolarAngle,G.phi)),G.makeSafe(),G.radius*=q,G.radius=a(B.minDistance,t(B.maxDistance,G.radius)),B.target.add(Y),e.setFromSpherical(G),e.applyQuaternion(o),n.copy(B.target).add(e),B.object.lookAt(B.target),!0===B.enableDamping?(W.theta*=1-B.dampingFactor,W.phi*=1-B.dampingFactor):W.set(0,0,0),q=1,Y.set(0,0,0),(Z||s.distanceToSquared(B.object.position)>_||8*(1-d.dot(B.object.quaternion))>_)&&(B.dispatchEvent(F),s.copy(B.object.position),d.copy(B.object.quaternion),Z=!1,!0)}}(),this.dispose=function(){B.domElement.removeEventListener('contextmenu',N,!1),B.domElement.removeEventListener('mousedown',j,!1),B.domElement.removeEventListener('wheel',L,!1),B.domElement.removeEventListener('touchstart',P,!1),B.domElement.removeEventListener('touchend',O,!1),B.domElement.removeEventListener('touchmove',R,!1),document.removeEventListener('mousemove',w,!1),document.removeEventListener('mouseup',k,!1),window.removeEventListener('keydown',M,!1)};var B=this,F={type:'change'},z={type:'start'},U={type:'end'},V={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},H=V.NONE,_=1e-6,G=new THREE.Spherical,W=new THREE.Spherical,q=1,Y=new THREE.Vector3,Z=!1,K=new THREE.Vector2,Q=new THREE.Vector2,X=new THREE.Vector2,J=new THREE.Vector2,$=new THREE.Vector2,ee=new THREE.Vector2,te=new THREE.Vector2,ie=new THREE.Vector2,ae=new THREE.Vector2,ne=function(){var e=new THREE.Vector3;return function(t,i){e.setFromMatrixColumn(i,0),e.multiplyScalar(-t),Y.add(e)}}(),oe=function(){var e=new THREE.Vector3;return function(t,i){e.setFromMatrixColumn(i,1),e.multiplyScalar(t),Y.add(e)}}(),re=function(){var e=new THREE.Vector3;return function(t,a){var n=B.domElement===document?B.domElement.body:B.domElement;if(B.object.isPerspectiveCamera){var o=B.object.position;e.copy(o).sub(B.target);var r=e.length();r*=Math.tan(B.object.fov/2*i/180),ne(2*t*r/n.clientHeight,B.object.matrix),oe(2*a*r/n.clientHeight,B.object.matrix)}else B.object.isOrthographicCamera?(ne(t*(B.object.right-B.object.left)/B.object.zoom/n.clientWidth,B.object.matrix),oe(a*(B.object.top-B.object.bottom)/B.object.zoom/n.clientHeight,B.object.matrix)):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'),B.enablePan=!1)}}();B.domElement.addEventListener('contextmenu',N,!1),B.domElement.addEventListener('mousedown',j,!1),B.domElement.addEventListener('wheel',L,!1),B.domElement.addEventListener('touchstart',P,!1),B.domElement.addEventListener('touchend',O,!1),B.domElement.addEventListener('touchmove',R,!1),window.addEventListener('keydown',M,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn('THREE.OrbitControls: .center has been renamed to .target'),this.target}},noZoom:{get:function(){return console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),!this.enableZoom},set:function(e){console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),this.enableZoom=!e}},noRotate:{get:function(){return console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),!this.enableRotate},set:function(e){console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),this.enableRotate=!e}},noPan:{get:function(){return console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),!this.enablePan},set:function(e){console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),this.enablePan=!e}},noKeys:{get:function(){return console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),!this.enableKeys},set:function(e){console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),!this.enableDamping},set:function(e){console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor},set:function(e){console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor=e}}})},function(e,t,i){var a=i(66);e.exports.parse=function(e){var t=new a;return new Promise((i)=>{t.addEventListener('message',(e)=>{i(e.data)},!1),t.postMessage(e)})}},function(e){e.exports=function(e,t){var i=0,a=[],n;return n=new Audio(e),n.volume=t,a.push(n),{play:function(){0===a[i].currentTime&&a[i].ended||(n=new Audio(e),n.volume=t,a.push(n),i++),(0===a[i].currentTime||a[i].ended)&&a[i].play(),i=(i+1)%a.length}}}},function(e,t,i){'use strict';function a(e){e.playMode=e.activeMenuSection===m.MENU_SECTIONS.MAIN,e.buildMode=e.activeMenuSection===m.MENU_SECTIONS.BUILD,e.craftMode=e.activeMenuSection===m.MENU_SECTIONS.CRAFT,e.scriptMode=e.activeMenuSection===m.MENU_SECTIONS.SCRIPT}function n(e,t){var i=t.scriptMenu.activeScriptState;return'default'!==i&&(e.states[i]=e.states[i]||{position:AFRAME.utils.clone(e.attributes.position),rotation:AFRAME.utils.clone(e.attributes.rotation),scale:AFRAME.utils.clone(e.attributes.scale)}),'default'===i?e.attributes:e.states[i]}function o(e){for(var t=`thing${e.entityId++}`;document.getElementById(t);)t=`thing${e.entityId++}`;return t}function r(e){for(var t=`shape${e.shapeId++}`;document.getElementById(t);)t=`shape${e.shapeId++}`;return t}function s(e){var t,i;for(i=p(e.siteNames.length/w),e.loadMenu.hasPrev=0<e.loadMenu.page,e.loadMenu.hasNext=e.loadMenu.page<i-1,e.loadMenuSiteNames.length=0,t=e.loadMenu.page*w;t<e.loadMenu.page*w+w&&!!e.siteNames[t];t++)e.loadMenuSiteNames.push(e.siteNames[t])}function l(e){var t;t=p(e.inventoryItems.length/k),e.inventory.hasPrev=0<e.inventory.page,e.inventory.hasNext=e.inventory.page<t-1}function d(e){e.tutorial.hasPrev=0<e.tutorial.page,e.tutorial.hasNext=e.tutorial.page<A.a.length-1,e.tutorial.pageText=`${e.tutorial.page+1} / ${A.a.length}`,Object.assign(e.tutorial,A.a[e.tutorial.page])}function c(e){var t;for(e.gallery.hasPrev=0<e.gallery.page,e.gallery.hasNext=e.gallery.page<g(I.length/j),e.galleryItems.length=0,t=e.gallery.page*j;t<e.gallery.page*j+j&&!!I[t];t++)e.galleryItems.push(I[t])}function u(e,t){return p(e.length/t)}var p=Math.ceil,g=Math.floor;Object.defineProperty(t,'__esModule',{value:!0});var m=i(1),h=i.n(m),b=i(155),y=i.n(b),f=i(9),v=i.n(f),E=i(33),x=i(34),S=i(35),C=i(65),A=i.n(C),T=i(12).composeFunctions,D=i(12).composeHandlers,I;I=i(64);var j=6,w=4,k=15,L=!1,M=0;AFRAME.registerState({nonBindedStateKeys:['clearEntities','entities','entityIndex'],initialState:{activeMenu:m.MENUS.MAIN.BUILD_OPTIONS,activeMenuSection:m.MENU_SECTIONS.MAIN,buildMode:!1,cameraScaleFactor:1,clearEntities:!1,controller:'',craftMode:!1,dirtyEntityIds:[],entityId:0,entities:{},entityIndex:{},environment:{color:'#00b295',presetColor:'teal'},focusedEntityId:'',focusedEntityText:'',gallery:{active:!1,hasPrev:!1,hasNext:!1,page:0,title:'Sites',color:'#FFF'},galleryItems:[],grabbedEntityId:'',grabPosition:{x:0,y:0,z:-0.15},grabRotation:{x:0,y:0,z:0},handPrimary:'left'===localStorage.getItem('handPrimary')?'left':'right',handSecondary:'left'===localStorage.getItem('handPrimary')?'right':'left',hasEntities:!1,inventory:{hasPrev:!1,hasNext:!1,open:!1,page:0},inventoryItems:[],isBoundingBoxEnabled:!0,isFocusedEntityTouched:!1,isGrabbingToInventory:!1,isSiteLoading:!1,isSitePublished:!1,isSitePublishing:!1,isVRMode:'true'===AFRAME.utils.getUrlParameter('debug'),loadMenu:{hasPrev:!1,hasNext:!1,page:0},loadMenuSiteNames:[],menuBoundingBoxTouched:!1,menuFocused:!1,menuTooltip:'',menuTooltipDisplay:'',menuTooltipHover:'',playMode:!0,selectedColor:'#F75A34',scriptMode:!1,scriptMenu:{activeScript:'1',activeScriptLine:{lineNumber:void 0,type:void 0},activeScriptState:'default',panels:{addThenVisible:!1,addWhenVisible:!1,goToStateVisible:!1},needsUpdate:0},siteName:'',siteNameText:'',siteNames:[],shapeId:0,stagedEntityId:'',tools:{airScalerActive:!1,airScalerEnabled:!1,cameraScalerEnabled:!1,colorerEnabled:!1,clonerActive:!1,clonerEnabled:!1,deleterActive:!1,deleterEnabled:!1,grabberEnabled:!1,gridTransformActive:!1,gridTransformTogglerEnabled:!1,inventoryDropperEnabled:!0,menuRaycasterEnabled:!1,referenceImageActive:!1,referenceImageEnabled:!1,scalerEnabled:!1,selectorEnabled:!0,primaryCraftActionsEnabled:!1,teleporterActive:!1,teleporterEnabled:!0,tips:{normalTipVisible:!0,scaleTipVisible:!1},undoEnabled:!1,uniformScaleActive:!1,uniformScaleEnabled:!1},tutorial:{data:A.a,hasPrev:!1,hasNext:!0,image:A.a[0].image,page:0,pageText:`1 / ${A.a.length}`,text:A.a[0].text,title:A.a[0].title,active:!1}},handlers:D({addshape:function(e,t){var i,a;i=r(e),a={attributes:{id:i,position:{x:t.position.x,y:t.position.y,z:t.position.z},rotation:t.rotation?{x:t.rotation.x,y:t.rotation.y,z:t.rotation.z}:{x:0,y:0,z:0},scale:{x:e.cameraScaleFactor,y:e.cameraScaleFactor,z:e.cameraScaleFactor}},parentId:e.stagedEntityId},a.attributes['super-geometry']={type:t.shapeType},a.attributes['super-material']={color:e.selectedColor},e.entityIndex[i]=a,e.entities[e.stagedEntityId].shapes[i]=a,e.dirtyEntityIds=[i],e.focusedEntityId=`${i}`,e.grabbedEntityId=`${i}`,v.a.pushCreateAction(i),L=!0},airscaleend:function(e,t){var i,a;i=e.entityIndex[t.id],v.a.pushTransformAction(i),a=n(i,e),AFRAME.utils.extend(a.position,t.position),AFRAME.utils.extend(a.scale,t.scale)},camerascale:function(e,t){e.cameraScaleFactor=t.cameraScaleFactor},clonestart:function(e){var t=e.focusedEntityId,i,a,n,s;if(''!==t){if(a=e.craftMode?r(e):o(e),n=e.entityIndex[t],i=AFRAME.utils.clone(n),i.attributes['data-cloned-from']=t,i.attributes.id=a,e.craftMode?e.entities[e.stagedEntityId].shapes[a]=i:e.entities[a]=i,e.entityIndex[a]=i,i.shapes)for(s in i.shapes){let t=i.shapes[s];t.attributes['data-cloned-from']=s,t.attributes.id=r(e),t.parentId=i.attributes.id,i.shapes[t.attributes.id]=t,delete i.shapes[s],e.entityIndex[t.attributes.id]=t}e.focusedEntityId=a,e.dirtyEntityIds=[a],e.grabbedEntityId=a,v.a.pushCreateAction(a),L=!0}},cloneend:function(e){e.grabbedEntityId=''},colorentity:function(e,t){var i;i=e.entityIndex[t.id],v.a.pushSetAction(i,'super-material','color',i.attributes['super-material'].color),i.attributes['super-material'].color=t.baseColor},controllerconnected:function(e,t){e.controller='vive-controls'===t.name?'vive-controls':'oculus-touch-controls'},deleteend:function(e,t){var i,a,n;i=t.id,a=e.entityIndex[t.id],n=e.entityIndex[a.parentId],v.a.pushDeleteAction(a),e.craftMode?(e.dirtyEntityIds=[i],delete n.shapes[i],delete e.entityIndex[i]):(e.dirtyEntityIds=[i],delete e.entities[i],delete e.entityIndex[i]),e.focusedEntityId=''},"enter-vr":function(e){AFRAME.utils.checkHeadsetConnected()&&(e.isVRMode=!0)},"exit-vr":function(e){e.isVRMode=!1},focusentity:function(e,t){var i;if(e.buildMode||e.playMode||e.scriptMode)e.focusedEntityId=t.id;else if(e.craftMode){if(i=e.entityIndex[e.stagedEntityId],!(t.id in i.shapes))return;e.focusedEntityId=t.id}},getinventoryuuids:function(e,t){var a;for(e.inventoryItems.length=0,a=0;a<t.length;a++)e.inventoryItems.push(t[a]);l(e)},galleryclose:function(e){e.gallery.active=!1},galleryprevpage:function(e){0<e.gallery.page&&(e.gallery.page--,c(e))},gallerynextpage:function(e){e.gallery.page<p(I.length/j)&&(e.gallery.page++,c(e))},gallerynewsite:function(e){e.gallery.active=!1},galleryopen:function(e){e.gallery.color=b.PALETTE.orange,e.gallery.title='Site Templates',e.gallery.active=!0,e.gallery.page=0,c(e)},getsitenames:function(e,t){var a;for(e.loadMenuSiteNames.length=0,e.siteNames.length=0,a=0;a<t.length;a++)e.siteNames.push(t[a]),a<w&&e.loadMenuSiteNames.push(t[a]);e.loadMenu.page=0,s(e)},grab:function(e,t){e.focusedEntityId=t.id},grabposeset:function(e,t){e.grabPosition=t.addPosition,e.grabRotation=t.addRotation},inventoryadd:function(e,t){e.inventoryItems.push(t),l(e)},inventoryclose:function(e){e.inventory.open=!1},inventorygrab:function(e,t){var i,a,n,o,r,s,l;for(s in e.inventory.open=!1,l=t.entity,o=t.position,r=t.rotation,n=`thing${e.entityId++}`,l.attributes.id=n,l.attributes.position=AFRAME.utils.clone(o),l.attributes.rotation={x:0,y:0,z:0},e.entities[n]=l,e.entityIndex[n]=l,i={},l.shapes)a=`shape${e.shapeId++}`,i[a]=l.shapes[s],i[a].attributes.id=a,i[a].parentId=n;l.shapes=i,e.dirtyEntityIds=[n],e.grabbedEntityId=n},inventoryopen:function(e){e.inventory.open=!0},inventoryprevpage:function(e){0===e.inventory.page||(e.inventory.page--,l(e))},inventorynextpage:function(e){e.inventory.page>g(e.inventoryItems.length/k)||(e.inventory.page++,l(e))},loadmenuprev:function(e){0===e.loadMenu.page||(e.loadMenu.page--,s(e))},loadmenunext:function(e){e.loadMenu.page>g(e.siteNames.length/w)||(e.loadMenu.page++,s(e))},loadsite:function(e,t){var i,a,n,o;if(e.isSiteLoading=!1,t.data&&t.data.entities&&t.data.entities.constructor===Object){for(n in e.clearEntities=!0,e.environment=t.data.environment||{preset:'teal'},a=Object.keys(e.entityIndex),e.entities={},e.entityIndex={},i=t.data,e.entityId=i.entityId,e.isSitePublished=i.isSitePublished,e.shapeId=i.shapeId,e.entities=AFRAME.utils.clone(i.entities),e.entities){for(o in e.entityIndex[n]=e.entities[n],e.entities[n].shapes)e.entityIndex[o]=e.entities[n].shapes[o];a.push(n)}for(n in e.entities)for(o in e.entities[n].shapes)a.push(o);i.name&&(e.siteName=i.name),e.dirtyEntityIds=a}},menubuttonclick:function(e,t){var i,a,n;switch(t.menu&&(e.activeMenu=t.menu,e.activeMenuSection=m.MENU_TO_SECTION[t.menu]),t.menu){case m.MENUS.MAIN.TUTORIAL:{gtag('event','tutorialopen'),e.tutorial.active=!0,e.gallery.active=!1;break}case m.MENUS.MAIN.BUILD_OPTIONS:{e.tutorial.active=!1,e.gallery.active=!1;break}case m.MENUS.BUILD.PUBLISH:{e.isBoundingBoxEnabled=!0;break}case m.MENUS.CRAFT.SHAPE:{e.isBoundingBoxEnabled=!0;break}case m.MENUS.CRAFT.MATERIAL:{e.isBoundingBoxEnabled=!1;break}}switch(t.id){case'buildMenuBack':{e.cameraScaleFactor=1,e.grabbedEntityId='',e.focusedEntityId='',e.isBoundingBoxEnabled=!0,e.isSitePublishing=!1;break}case'buildMenuCraft':{i=o(e),e.focusedEntityId='',e.entities[i]=e.entityIndex[i]={attributes:{id:i,position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}},shapes:{},states:{1:{position:{x:0.3,y:1.6,z:-0.1},rotation:{x:0,y:0,z:0}}}},e.stagedEntityId=i,e.oldDirtyEntityIds=e.dirtyEntityIds,e.dirtyEntityIds=[i],v.a.clear();break}case'buildMenuUpdate':{for(i in e.stagedEntityId=e.focusedEntityId,n=e.entityIndex[e.focusedEntityId].shapes,n){e.focusedEntityId=i;break}v.a.clear();break}case'craftMenuBack':{if(a=e.entities[e.stagedEntityId],!a)break;for(var r in a.shapes);r||(delete e.entities[e.stagedEntityId],delete e.entityIndex[e.stagedEntityId],e.dirtyEntityIds=[e.stagedEntityId],e.entityId--,e.focusedEntityId=void 0,e.stagedEntityId=void 0),delete a.attributes['data-staged'],e.focusedEntityId=e.stagedEntityId,e.stagedEntityId=void 0,e.isBoundingBoxEnabled=!0,v.a.clear();break}}},menublur:function(e){e.menuFocused=!1},menuboundingboxhitstart:function(e){e.menuBoundingBoxTouched=!0},menuboundingboxhitend:function(e){e.menuBoundingBoxTouched=!1},menufocus:function(e){e.tools.menuRaycasterEnabled&&(e.menuFocused=!0)},menutooltiphover:function(e,t){e.menuTooltipHover=t.tooltip},newblanksite:function(e,t){e.activeMenu=m.MENUS.BUILD.PUBLISH,e.activeMenuSection=m.MENU_SECTIONS.BUILD,e.dirtyEntityIds=Object.keys(e.entityIndex),e.clearEntities=!0,e.entities={},e.entityId=0,e.entityIndex={},e.environment.presetColor='teal',e.focusedEntityId='',e.gallery.active=!1,e.isSitePublished=!1,e.shapeId=0,e.siteName=t,e.siteNames.push(t)},newsitename:function(e,t){e.activeMenu=m.MENUS.BUILD.PUBLISH,e.activeMenuSection=m.MENU_SECTIONS.BUILD,e.gallery.active=!1,e.isSitePublished=!1,e.isLoadingSite=!1,e.siteName=t,e.siteNames.push(t)},recenter:function(e,t){var a,n;for(n=0;n<t.ids.length;n++)a=e.entityIndex[t.ids[n]],a.attributes.position.x=t.positions[n].x,a.attributes.position.y=t.positions[n].y,a.attributes.position.z=t.positions[n].z,a.attributes.rotation.x=t.rotations[n].x,a.attributes.rotation.y=t.rotations[n].y,a.attributes.rotation.z=t.rotations[n].z,a.attributes.scale.x=t.scales[n].x,a.attributes.scale.y=t.scales[n].y,a.attributes.scale.z=t.scales[n].z},remixsite:function(e){e.isLoadingSite||(e.isSitePublished=!1,e.isLoadingSite=!1,e.siteName='')},scaleend:function(e,t){var i,a;i=e.entityIndex[t.id],v.a.pushTransformAction(i),a=n(i,e),AFRAME.utils.extend(a.position,t.position),AFRAME.utils.extend(a.scale,t.scale)},selectcolor:function(e,t){e.selectedColor=t.color},selectenvironmentcolor:function(e,t){e.environment.color=t.color,e.environment.presetColor=t.colorName},siteloaderror:function(e){e.isSiteLoading=!1},siteloadstart:function(e){e.isSiteLoading=!0},toinventorygrabend:function(e){e.isGrabbingToInventory=!1,e.inventory.open=!1,e.inventory.page=M},toinventorygrabstart:function(e){e.isGrabbingToInventory=!0,M=e.inventory.page,e.inventory.page=u(e.inventoryItems,k)-1,e.inventory.open=!0},touchentityend:function(e){e.isFocusedEntityTouched=!1},touchentitystart:function(e,t){e.isFocusedEntityTouched=t.id===e.focusedEntityId},tutorialmenuprev:function(e){0===e.tutorial.page||(e.tutorial.page--,d(e))},tutorialmenunext:function(e){e.tutorial.page>=A.a.length-1||(e.tutorial.page++,d(e))},undo:function(e){v.a.undo(e)},unfocusentity:function(e){e.focusedEntityId=''},ungrab:function(e,t){var i,a;i=e.entityIndex[t.id],L?L=!1:v.a.pushTransformAction(i),a=i.attributes,a.position.x=t.position.x,a.position.y=t.position.y,a.position.z=t.position.z,a.rotation.x=t.rotation.x,a.rotation.y=t.rotation.y,a.rotation.z=t.rotation.z,e.grabbedEntityId='',e.isBoundingBoxEnabled=!0}},S.toolsHandlers,x.scriptHandlers,E.publishHandlers),computeState:T(function(e){for(var t in e.hasEntities=!1,e.entities){e.hasEntities=!0;break}e.menuTooltipDisplay=e.menuTooltipHover||e.menuTooltip,e.focusedEntityText=e.focusedEntityId?`Edit ${e.focusedEntityId.replace('t','T').replace('g','g ')}`:'',a(e)},E.publishComputeState,S.toolsComputeState)}),0},function(e,t,i){t=e.exports=i(163)(!1),t.push([e.i,'html {\n  background: #111;\n  font-family: "Oxygen Mono", "PT Mono", Monospace;\n}\n#ui {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n  bottom: -5px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  position: fixed;\n  width: 100%;\n  z-index: 999999;\n}\n.logo {\n  margin: 0 15px 21px 15px;\n  width: 100px;\n}\n@media (min-width: 768px) {\n  .logo {\n    margin: 20px;\n    width: 150px;\n  }\n}\n#actions {\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  bottom: 23px;\n  display: none;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  position: relative;\n}\n#actions.actionsActive {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n#actions.gifStudioActive .urlGroup {\n  display: none;\n}\n.urlGroup {\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n#url {\n  background: #333;\n  border: 2px solid transparent;\n  -o-border-image: linear-gradient(to right, #f75834, #dccc4e, #33adec) 5;\n     border-image: -webkit-gradient(linear, left top, right top, from(#f75834), color-stop(#dccc4e), to(#33adec)) 5;\n     border-image: linear-gradient(to right, #f75834, #dccc4e, #33adec) 5;\n  color: #aaa;\n  cursor: default;\n  display: none;\n  font-size: 16px;\n  margin: 0;\n  padding: 10px 25px;\n  text-align: center;\n  width: -webkit-fit-content;\n  width: -moz-fit-content;\n  width: fit-content;\n}\n#url.urlPublished {\n  color: #fafafa;\n}\n#actionsToggle {\n  background: rgba(0,0,0,0.3);\n  color: #fafafa;\n  cursor: pointer;\n  display: none;\n  margin: 5px;\n  padding: 9px 11px;\n  border-radius: 2px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n#actionsToggle:hover {\n  color: #ffa500;\n}\n#actionsToggle svg {\n  width: 20px;\n  height: 20px;\n}\n#actionsToggle svg path {\n  fill: #ddd;\n}\n#actionsToggle:hover path {\n  fill: #fff;\n}\n.actionMenu {\n  background: #333;\n  border: 2px solid transparent;\n  -o-border-image: linear-gradient(to right, #f75834, #dccc4e, #33adec) 5;\n     border-image: -webkit-gradient(linear, left top, right top, from(#f75834), color-stop(#dccc4e), to(#33adec)) 5;\n     border-image: linear-gradient(to right, #f75834, #dccc4e, #33adec) 5;\n  color: #fafafa;\n  font-size: 15px;\n  display: none;\n  padding: 0;\n  width: 13em;\n  text-transform: uppercase;\n  position: absolute;\n  z-index: 999999;\n}\n.actionMenu.actionMenuActive {\n  display: block;\n}\n#actionsMenu {\n  bottom: -12px;\n  list-style: none;\n  right: 5px;\n}\n#actionsMenu li {\n  border-bottom: 2px solid #222;\n}\n#actionsMenu li:last-child {\n  border: none;\n}\n#actionsMenu li:hover {\n  background: #258;\n}\n#actionsMenu a {\n  color: #fafafa;\n  display: inline-block;\n  padding: 12px 20px;\n  text-decoration: none;\n}\n#gifStudio {\n  text-transform: none;\n  background: rgba(50,50,50,0.9);\n  bottom: 3px;\n  cursor: default;\n  min-width: 400px;\n  padding: 20px 25px 20px 25px;\n  font-size: 13px;\n  z-index: 9999999;\n}\n#gifStudio label,\n#gifStudio p {\n  color: #84e2ff;\n}\n#gifStudio .gifStudioTitle {\n  font-size: 16px;\n  font-weight: bold;\n  margin: 0;\n  margin-bottom: 10px;\n  color: #fcf76b;\n}\n#gifStudio .gifStudioRow {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  margin-bottom: 10px;\n}\n#gifStudio .gifStudioRow p {\n  margin-bottom: 5px;\n}\n#gifStudio .gifStudioInputGroup {\n  margin-right: 15px;\n  width: 223px;\n}\n#gifStudio .gifTimelapseGroup {\n  margin: 20px 0 30px 0;\n}\n#gifStudio #gifRecordingMessage {\n  display: none;\n}\n#gifStudio #gifEncodingMessage {\n  display: none;\n  margin-bottom: 10px;\n}\n#gifStudio #gifProgress {\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  background: #111;\n  border: 0;\n  width: 100%;\n  height: 4px;\n  border-radius: 3px;\n  display: none;\n  margin: 15px 0;\n}\n#gifStudio #gifProgress::-moz-progress-bar {\n  border-radius: 3px;\n  background-color: #98c08d;\n}\n#gifStudio #gifPreviewButton {\n  background: #54bddd;\n}\n#gifStudio #gifRecordButton {\n  background: #dcab4e;\n}\n#gifStudio #gifClose {\n  background: #f0733b;\n  float: right;\n  margin: 0;\n}\n#gifStudio input {\n  border: 0;\n  border-radius: 5px;\n  background: rgba(0,0,0,0.4);\n  padding: 5px 8px;\n  width: 40px;\n  font-size: 14px;\n  color: #bbb;\n  -webkit-box-shadow: inset 1px 1px 1px rgba(0,0,0,0.9);\n          box-shadow: inset 1px 1px 1px rgba(0,0,0,0.9);\n}\n#gifStudio input:focus {\n  color: #fff;\n  background: #066988;\n}\n#gifStudio input[type="checkbox"] {\n  display: inline;\n}\n#gifStudio button {\n  font-family: \'Oxygen Mono\', Monospace;\n  text-transform: uppercase;\n  border: 2px solid rgba(0,0,0,0);\n  border-radius: 5px;\n  font-weight: bold;\n  cursor: pointer;\n  padding: 7px 12px;\n  margin-right: 10px;\n  color: #222;\n  -webkit-box-shadow: 0 0 2px rgba(0,0,0,0.5);\n          box-shadow: 0 0 2px rgba(0,0,0,0.5);\n}\n#gifStudio button:hover {\n  color: #fff;\n  border: 2px solid #fff;\n  text-shadow: 0 0 15px #222;\n}\n#vrButton {\n  background-image: url("assets/img/entervr.svg");\n  background-repeat: no-repeat;\n  background-size: 70% 65%;\n  border: 0;\n  cursor: pointer;\n  left: 15px;\n  padding-right: 70px;\n  padding-top: 52px;\n  position: relative;\n  -webkit-transition: background-color 0.05s ease;\n  transition: background-color 0.05s ease;\n  z-index: 9999;\n  height: 20px;\n  width: 35px;\n}\n#vrButton.a-hidden {\n  display: block !important;\n  visibility: hidden;\n}\n#vrButton:active {\n  border: 0;\n}\nbody {\n  cursor: -webkit-grab;\n  cursor: grab;\n}\nbody:active {\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n#subscribeForm {\n  background: rgba(0,0,0,0.75);\n  -webkit-box-shadow: 0px 0 1px #888;\n          box-shadow: 0px 0 1px #888;\n  color: #fafafa;\n  font-family: monospace;\n  height: 100px;\n  left: 0;\n  margin: 0;\n  min-width: 400px;\n  padding: 0 10px 0 10px;\n  position: fixed;\n  text-align: center;\n  top: 0;\n  z-index: 9999999;\n}\n#subscribeForm button {\n  border: 0;\n  background: #ff74b8;\n  border-radius: 20px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #fafafa;\n  text-transform: uppercase;\n  -webkit-transition: 0.1s all;\n  transition: 0.1s all;\n  padding: 11px 20px;\n  vertical-align: middle;\n}\n#subscribeForm button:hover {\n  background: #ff94c8;\n}\n#subscribeForm h2 {\n  font-size: 16px;\n  font-weight: 300;\n}\ninput[type="email"] {\n  background: #fafafa;\n  border: 0;\n  border-radius: 5px;\n  color: $gray;\n  height: 40px;\n  padding-left: 20px;\n  margin-right: 10px;\n  max-width: 480px;\n  text-transform: uppercase;\n  vertical-align: middle;\n  width: 50%;\n}\n',''])},function(e){function t(e,t){var a=e[1]||'',n=e[3];if(!n)return a;if(t&&'function'==typeof btoa){var o=i(n),r=n.sources.map(function(e){return'/*# sourceURL='+n.sourceRoot+e+' */'});return[a].concat(r).concat([o]).join('\n')}return[a].join('\n')}function i(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e))));return'/*# '+('sourceMappingURL=data:application/json;charset=utf-8;base64,'+t)+' */'}e.exports=function(e){var a=[];return a.toString=function(){return this.map(function(i){var a=t(i,e);return i[2]?'@media '+i[2]+'{'+a+'}':a}).join('')},a.i=function(e,t){'string'==typeof e&&(e=[[null,e,'']]);for(var n={},o=0,i;o<this.length;o++)i=this[o][0],'number'==typeof i&&(n[i]=!0);for(o=0;o<e.length;o++){var r=e[o];'number'==typeof r[0]&&n[r[0]]||(t&&!r[2]?r[2]=t:t&&(r[2]='('+r[2]+') and ('+t+')'),a.push(r))}},a}},function(e){'use strict';e.exports=function(){var e=Array.from,t,i;return!('function'!=typeof e)&&(t=['raz','dwa'],i=e(t),!!(i&&i!==t&&'dwa'===i[1]))}},function(e,t,i){'use strict';var a=i(184).iterator,n=i(166),o=i(167),r=i(172),s=i(39),l=i(6),d=i(4),c=i(183),u=Array.isArray,p=Function.prototype.call,g={configurable:!0,enumerable:!0,writable:!0,value:null},m=Object.defineProperty;e.exports=function(e){var t=arguments[1],h=arguments[2],b,y,i,f,v,E,x,S,C,A;if(e=Object(l(e)),d(t)&&s(t),!this||this===Array||!o(this)){if(!t){if(n(e))return(v=e.length,1!==v)?Array.apply(null,e):(f=[,],f[0]=e[0],f);if(u(e)){for(f=Array(v=e.length),y=0;y<v;++y)f[y]=e[y];return f}}f=[]}else b=this;if(!u(e))if(void 0!==(C=e[a])){for(x=s(C).call(e),b&&(f=new b),S=x.next(),y=0;!S.done;)A=t?p.call(t,h,S.value,y):S.value,b?(g.value=A,m(f,y,g)):f[y]=A,S=x.next(),++y;v=y}else if(c(e)){for(v=e.length,b&&(f=new b),(y=0,i=0);y<v;++y)A=e[y],y+1<v&&(E=A.charCodeAt(0),55296<=E&&56319>=E&&(A+=e[++y])),A=t?p.call(t,h,A,i):A,b?(g.value=A,m(f,i,g)):f[i]=A,++i;v=i}if(void 0===v)for(v=r(e.length),b&&(f=new b(v)),y=0;y<v;++y)A=t?p.call(t,h,e[y],y):e[y],b?(g.value=A,m(f,y,g)):f[y]=A;return b&&(g.value=null,f.length=v),f}},function(e){'use strict';var t=Object.prototype.toString,i=t.call(function(){return arguments}());e.exports=function(e){return t.call(e)===i}},function(e,t,i){'use strict';var a=Object.prototype.toString,n=a.call(i(37));e.exports=function(e){return'function'==typeof e&&a.call(e)===n}},function(e,t,i){'use strict';e.exports=i(169)()?Math.sign:i(170)},function(e){'use strict';e.exports=function(){var e=Math.sign;return!('function'!=typeof e)&&1===e(10)&&-1===e(-20)}},function(e){'use strict';e.exports=function(e){return e=+e,isNaN(e)||0===e?e:0<e?1:-1}},function(e,t,i){'use strict';var a=i(168),n=Math.abs,o=Math.floor;e.exports=function(e){return isNaN(e)?0:(e=+e,0!==e&&isFinite(e)?a(e)*o(n(e)):e)}},function(e,t,i){'use strict';var a=i(171),n=Math.max;e.exports=function(e){return n(0,a(e))}},function(e,t,i){'use strict';e.exports=i(174)()?Object.assign:i(175)},function(e){'use strict';e.exports=function(){var e=Object.assign,t;return!('function'!=typeof e)&&(t={foo:'raz'},e(t,{bar:'dwa'},{trzy:'trzy'}),'razdwatrzy'===t.foo+t.bar+t.trzy)}},function(e,t,i){'use strict';var a=i(177),n=i(6),o=Math.max;e.exports=function(e,t){var r=o(arguments.length,2),s,l,i;for(e=Object(n(e)),i=function(i){try{e[i]=t[i]}catch(t){s||(s=t)}},l=1;l<r;++l)t=arguments[l],a(t).forEach(i);if(s!==void 0)throw s;return e}},function(e){'use strict';e.exports=function(e){return'function'==typeof e}},function(e,t,i){'use strict';e.exports=i(178)()?Object.keys:i(179)},function(e){'use strict';e.exports=function(){try{return Object.keys('primitive'),!0}catch(t){return!1}}},function(e,t,i){'use strict';var a=i(4),n=Object.keys;e.exports=function(e){return n(a(e)?Object(e):e)}},function(e,t,i){'use strict';e.exports=i(181)()?String.prototype.contains:i(182)},function(e){'use strict';var t='razdwatrzy';e.exports=function(){return!('function'!=typeof t.contains)&&!0===t.contains('dwa')&&!1===t.contains('foo')}},function(e){'use strict';var t=String.prototype.indexOf;e.exports=function(e){return-1<t.call(this,e,arguments[1])}},function(e){'use strict';var t=Object.prototype.toString,i=t.call('');e.exports=function(e){return'string'==typeof e||e&&'object'==typeof e&&(e instanceof String||t.call(e)===i)||!1}},function(e,t,i){'use strict';e.exports=i(185)()?Symbol:i(187)},function(e){'use strict';var t={object:!0,symbol:!0};e.exports=function(){var e;if('function'!=typeof Symbol)return!1;e=Symbol('test symbol');try{}catch(t){return!1}return!!t[typeof Symbol.iterator]&&!!t[typeof Symbol.toPrimitive]&&!!t[typeof Symbol.toStringTag]}},function(e){'use strict';e.exports=function(e){return!!e&&(!('symbol'!=typeof e)||!!e.constructor&&!('Symbol'!==e.constructor.name)&&'Symbol'===e[e.constructor.toStringTag])}},function(e,t,i){'use strict';var a=i(36),n=i(188),o=Object.create,r=Object.defineProperties,s=Object.defineProperty,l=Object.prototype,d=o(null),c,u,p,g;if('function'==typeof Symbol){c=Symbol;try{c()+'',g=!0}catch(e){}}var m=function(){var e=o(null);return function(t){for(var i=0,n,o;e[t+(i||'')];)++i;return t+=i||'',e[t]=!0,n='@@'+t,s(l,n,a.gs(null,function(e){o||(o=!0,s(this,n,a(e)),o=!1)})),n}}();p=function(e){if(this instanceof p)throw new TypeError('Symbol is not a constructor');return u(e)},e.exports=u=function e(t){var i;if(this instanceof e)throw new TypeError('Symbol is not a constructor');return g?c(t):(i=o(p.prototype),t=void 0===t?'':t+'',r(i,{__description__:a('',t),__name__:a('',m(t))}))},r(u,{for:a(function(e){return d[e]?d[e]:d[e]=u(e+'')}),keyFor:a(function(e){for(var t in n(e),d)if(d[t]===e)return t}),hasInstance:a('',c&&c.hasInstance||u('hasInstance')),isConcatSpreadable:a('',c&&c.isConcatSpreadable||u('isConcatSpreadable')),iterator:a('',c&&c.iterator||u('iterator')),match:a('',c&&c.match||u('match')),replace:a('',c&&c.replace||u('replace')),search:a('',c&&c.search||u('search')),species:a('',c&&c.species||u('species')),split:a('',c&&c.split||u('split')),toPrimitive:a('',c&&c.toPrimitive||u('toPrimitive')),toStringTag:a('',c&&c.toStringTag||u('toStringTag')),unscopables:a('',c&&c.unscopables||u('unscopables'))}),r(p.prototype,{constructor:a(u),toString:a('',function(){return this.__name__})}),r(u.prototype,{toString:a(function(){return'Symbol ('+n(this).__description__+')'}),valueOf:a(function(){return n(this)})}),s(u.prototype,u.toPrimitive,a('',function(){var e=n(this);return'symbol'==typeof e?e:e.toString()})),s(u.prototype,u.toStringTag,a('c','Symbol')),s(p.prototype,u.toStringTag,a('c',u.prototype[u.toStringTag])),s(p.prototype,u.toPrimitive,a('c',u.prototype[u.toPrimitive]))},function(e,t,i){'use strict';var a=i(186);e.exports=function(e){if(!a(e))throw new TypeError(e+' is not a symbol');return e}},function(e,t,a){'use strict';var n=a(194),o,i,r,s,l,d,c,u,p,g;l=function(e){return'\\'===e?d:'$'===e?c:(i+=e,l)},d=function(e){return'\\'!==e&&'$'!==e&&(i+='\\'),i+=e,l},c=function(e){return'{'===e?(r.push(i),i='',u):'$'===e?(i+='$',c):(i+='$'+e,l)},u=function(){var e=g.slice(o),t;return(n(e,'}',function(e){return 0<=n.nest?n.next():void(t=e)}),null!=t)?(s.push(g.slice(o,o+t)),o+=t,i='',l):(t=e.length,o+=t,i+=e,u)},p=function(e){return'\\'!==e&&'}'!==e&&(i+='\\'),i+=e,u},e.exports=function(e){var t,a,n;for(i='',r=[],s=[],g=e+'',t=g.length,a=l,o=0;o<t;++o)a=a(g[o]);return a===l?r.push(i):a===d?r.push(i+'\\'):a===c?r.push(i+'$'):a===u?r[r.length-1]+='${'+i:a===p&&(r[r.length-1]+='${'+i+'\\'),n={literals:r,substitutions:s},r=s=null,n}},function(e,t,i){'use strict';var a=i(189),n=i(192);e.exports=function(e,t){return n(a(e),t,arguments[2])}},function(e){'use strict';var t=Array.prototype.reduce;e.exports=function(e){var n=arguments;return t.call(e,function(e,t,a){return e+(n[a]===void 0?'':n[a]+'')+t})}},function(e,t,i){'use strict';var a=i(193),n=i(191);e.exports=function(e,t){return n.apply(null,a(e,t,arguments[2]))}},function(e,t,i){'use strict';var a=i(6),n=i(38),o=i(195),r=Array.prototype.map,s=Object.keys,l=JSON.stringify;e.exports=function(e,t){var i=Object(arguments[2]),d,c,u;return a(e)&&a(e.literals)&&a(e.substitutions),t=n(t),d=s(t).filter(o),c=d.join(', '),u=d.map(function(e){return t[e]}),[e.literals].concat(r.call(e.substitutions,function(t){var e;if(t){try{e=new Function(c,'return ('+t+')')}catch(i){throw new TypeError('Unable to compile expression:\n\targs: '+l(c)+'\n\tbody: '+l(t)+'\n\terror: '+i.stack)}try{return e.apply(null,u)}catch(a){if(i.partial)return'${'+t+'}';throw new TypeError('Unable to resolve expression:\n\targs: '+l(c)+'\n\tbody: '+l(t)+'\n\terror: '+a.stack)}}}))}},function(e,t,a){'use strict';var n=a(10),o=a(5),r=a(6),s=a(39),l=a(36),d=a(40),c=a(197),u=Object.prototype.hasOwnProperty,p=o.apply(null,n(';{=([,<>+-*/%&|^!~?:}')),g=o.apply(null,n(';{=([,<>+-*/%&|^!~?:})].')),m,h,b,y,f,v,E,x,S,C,A,i,T,D,I,j,w,k,L,M,P,R,O,N,B,F,z;m=function(e){if(i&&!(A>=e))for(;A!==e;){if(!i)return;u.call(c,i)?u.call(d,i)&&(D=A,++T):j=i,i=M[++A]}},h=function(e){null!=B&&k.push([F,B,e]),F={point:A+1,line:T,column:A+1-D},B=A},b=function(){var e;return F.raw=M.slice(B,A),L.push(F),k.length?(e=k.pop(),F=e[0],B=e[1],void(z=e[2])):void(F=null,B=null,z=null)},y=function(){var e=z;return z=w,++w,m(A+1),h(e),f},v=function(){if('\''===i||'"'===i)return N=i,i=M[++A],E;if('('===i||'{'===i||'['===i)++w;else if(')'===i||'}'===i||']'===i)z===--w&&b();else if('/'===i&&u.call(p,j))return i=M[++A],C;return i===P&&(R||!j||I||u.call(g,j))?O(A,j,w):(j=i,i=M[++A],f)},x=function(){for(;;){if(!i)return;if(u.call(d,i))return D=A+1,void++T;i=M[++A]}},S=function(){for(;;){if(!i)return;if('*'===i){if(i=M[++A],'/'===i)return;continue}u.call(d,i)&&(D=A+1,++T),i=M[++A]}},f=function(){var e;for(I=!1;;){if(!i)return;if(u.call(c,i))I=!0,u.call(d,i)&&(D=A+1,++T);else if('/'!==i)break;else if(e=M[A+1],'/'===e)i=M[A+=2],I=!0,x();else if('*'===e)i=M[A+=2],I=!0,S();else break;i=M[++A]}return v},E=function(){for(;;){if(!i)return;if(i===N)return i=M[++A],j=N,f;'\\'===i&&u.call(d,M[++A])&&(D=A+1,++T),i=M[++A]}},C=function(){for(;;){if(!i)return;if('/'===i)return j='/',i=M[++A],f;'\\'===i&&++A,i=M[++A]}},e.exports=t=function(e,a,n){var o;if(M=r(e)+'',P=r(a)+'',1!==P.length)throw new TypeError(P+' should be one character long string');for(O=s(n),R=u.call(g,P),A=0,i=M[A],T=1,D=0,I=!1,j=null,w=0,k=[],L=[],t.forceStop=!1,o=f;o;)o=o();return L},Object.defineProperties(t,{$ws:l(f),$common:l(v),collectNest:l(y),move:l(m),index:l.gs(function(){return A}),line:l.gs(function(){return T}),nest:l.gs(function(){return w}),columnIndex:l.gs(function(){return D}),next:l(function(e){if(i)return m(A+(e||1)),f()}),resume:l(function(){return v})})},function(e){'use strict';e.exports=RegExp.prototype.test.bind(/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|null|this|true|void|with|await|break|catch|class|const|false|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF])*$/)},function(e,t,i){'use strict';var a=i(10),n=i(5);e.exports=n.apply(null,a(' \f\t\x0B\u200B\xA0\u1680\u200B\u180E\u2000\u200B\u2001\u2002\u200B\u2003\u2004\u200B\u2005\u2006\u200B\u2007\u2008\u200B\u2009\u200A\u200B\u200B\u200B\u202F\u205F\u200B\u3000'))},function(e,t,i){'use strict';var a=i(5),n=i(40),o=i(196);e.exports=a.apply(null,Object.keys(n).concat(Object.keys(o)))},function(e,t,i){function a(e,t){for(var a=0;a<e.length;a++){var i=e[a],n=m[i.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](i.parts[o]);for(;o<i.parts.length;o++)n.parts.push(c(i.parts[o],t))}else{for(var r=[],o=0;o<i.parts.length;o++)r.push(c(i.parts[o],t));m[i.id]={id:i.id,refs:1,parts:r}}}}function n(e,t){for(var a=[],n={},o=0;o<e.length;o++){var i=e[o],r=t.base?i[0]+t.base:i[0],s=i[1],l=i[2],d=i[3],c={css:s,media:l,sourceMap:d};n[r]?n[r].parts.push(c):a.push(n[r]={id:r,parts:[c]})}return a}function o(e,t){var i=b(e.insertInto);if(!i)throw new Error('Couldn\'t find a style target. This probably means that the value for the \'insertInto\' parameter is invalid.');var a=v[v.length-1];if('top'===e.insertAt)a?a.nextSibling?i.insertBefore(t,a.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),v.push(t);else if('bottom'===e.insertAt)i.appendChild(t);else if('object'==typeof e.insertAt&&e.insertAt.before){var n=b(e.insertInto+' '+e.insertAt.before);i.insertBefore(t,n)}else throw new Error('[Style Loader]\n\n Invalid value for parameter \'insertAt\' (\'options.insertAt\') found.\n Must be \'top\', \'bottom\', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n')}function r(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=v.indexOf(e);0<=t&&v.splice(t,1)}function s(e){var t=document.createElement('style');return e.attrs.type='text/css',d(t,e.attrs),o(e,t),t}function l(e){var t=document.createElement('link');return e.attrs.type='text/css',e.attrs.rel='stylesheet',d(t,e.attrs),o(e,t),t}function d(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}function c(e,t){var i,a,n,o;if(t.transform&&e.css)if(o=t.transform(e.css),o)e.css=o;else return function(){};if(t.singleton){var d=f++;i=y||(y=s(t)),a=u.bind(null,i,d,!1),n=u.bind(null,i,d,!0)}else e.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(i=l(t),a=g.bind(null,i,t),n=function(){r(i),i.href&&URL.revokeObjectURL(i.href)}):(i=s(t),a=p.bind(null,i),n=function(){r(i)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}function u(e,t,i,a){var n=i?'':a.css;if(e.styleSheet)e.styleSheet.cssText=x(t,n);else{var o=document.createTextNode(n),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(o,r[t]):e.appendChild(o)}}function p(e,t){var i=t.css,a=t.media;if(a&&e.setAttribute('media',a),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function g(e,t,i){var a=i.css,n=i.sourceMap,o=t.convertToAbsoluteUrls===void 0&&n;(t.convertToAbsoluteUrls||o)&&(a=E(a)),n&&(a+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+' */');var r=new Blob([a],{type:'text/css'}),s=e.href;e.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}var m={},h=function(e){var t;return function(){return'undefined'==typeof t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),b=function(e){var t={};return function(i){if('undefined'==typeof t[i]){var a=e.call(this,i);if(a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(t){a=null}t[i]=a}return t[i]}}(function(e){return document.querySelector(e)}),y=null,f=0,v=[],E=i(199);e.exports=function(e,t){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');t=t||{},t.attrs='object'==typeof t.attrs?t.attrs:{},t.singleton||'boolean'==typeof t.singleton||(t.singleton=h()),t.insertInto||(t.insertInto='head'),t.insertAt||(t.insertAt='bottom');var o=n(e,t);return a(o,t),function(e){for(var r=[],s=0;s<o.length;s++){var i=o[s],l=m[i.id];l.refs--,r.push(l)}if(e){var d=n(e,t);a(d,t)}for(var s=0,l;s<r.length;s++)if(l=r[s],0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete m[l.id]}}};var x=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join('\n')}}()},function(e){e.exports=function(e){var t='undefined'!=typeof window&&window.location;if(!t)throw new Error('fixUrls requires window.location');if(!e||'string'!=typeof e)return e;var i=t.protocol+'//'+t.host,a=i+t.pathname.replace(/\/[^\/]*$/,'/'),n=e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(n))return e;var o;return o=0===n.indexOf('//')?n:0===n.indexOf('/')?i+n:a+n.replace(/^\.\//,''),'url('+JSON.stringify(o)+')'});return n}},function(e){e.exports='uniform float length;\nuniform vec3 color;\nvarying float vDistanceFromTip;\n\nvoid main() {\n  vec3 colorGradient = mix(color, vec3(1.0, 0.5, 0.6), vDistanceFromTip / length);\n  gl_FragColor = vec4(colorGradient, 1.0);\n}\n'},function(e){e.exports='uniform float length;\nvarying float vDistanceFromTip;\n\nvoid main() {\n  vDistanceFromTip = length - position.y;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n'},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(i){'object'==typeof window&&(t=window)}e.exports=t},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,'loaded',{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,'id',{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e){'use strict';var t=window.URL||window.webkitURL;e.exports=function(e,i){try{try{var a;try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;a=new n,a.append(e),a=a.getBlob()}catch(t){a=new Blob([e])}return new Worker(t.createObjectURL(a))}catch(t){return new Worker('data:application/javascript,'+encodeURIComponent(e))}}catch(t){if(!i)throw Error('Inline worker is not supported');return new Worker(i)}}}]);